<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Chapter 17. MySQL Cluster</title><link rel="stylesheet" href="mysql-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MySQL 5.0 Reference Manual"><link rel="up" href="index.html" title="MySQL 5.0 Reference Manual"><link rel="prev" href="replication.html" title="Chapter 16. Replication"><link rel="next" href="stored-programs-views.html" title="Chapter 18. Stored Programs and Views"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 17. MySQL Cluster</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="replication.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="stored-programs-views.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="mysql-cluster"></a>Chapter 17. MySQL Cluster</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-overview">17.1. MySQL Cluster Overview</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-basics">17.1.1. MySQL Cluster Core Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-nodes-groups">17.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-computer">17.2. MySQL Cluster Multi-Computer How-To</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network">17.2.1. MySQL Cluster Hardware, Software, and Networking Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-install">17.2.2. MySQL Cluster Multi-Computer Installation</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-config">17.2.3. MySQL Cluster Multi-Computer Configuration</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-initial">17.2.4. Initial Startup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries">17.2.5. Loading Sample Data into MySQL Cluster and Performing Queries</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-shutdown-restart">17.2.6. Safe Shutdown and Restart of MySQL Cluster</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-configuration">17.3. MySQL Cluster Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-building">17.3.1. Building MySQL Cluster from Source Code</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-installing">17.3.2. Installing MySQL Cluster Software</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-quick">17.3.3. Quick Test Setup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-file">17.3.4. MySQL Cluster Configuration Files</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-overview">17.3.5. Overview of MySQL Cluster Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-lcp-params">17.3.6. Configuring MySQL Cluster Parameters for Local Checkpoints</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-options-variables">17.4. MySQL Cluster Options and Variables</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-option-tables">17.4.1. MySQL Cluster Server Option and Variable Reference</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-mysqld">17.4.2. <span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-system-variables">17.4.3. MySQL Cluster System Variables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-status-variables">17.4.4. MySQL Cluster Status Variables</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade">17.5. Upgrading and Downgrading MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-rolling-restart">17.5.1. Performing a Rolling Restart of a MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility">17.5.2. MySQL Cluster 5.0 Upgrade and Downgrade Compatibility</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs">17.6. MySQL Cluster Programs</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-mysqld">17.6.1. MySQL Server Usage for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndbd">17.6.2. <span><strong class="command">ndbd</strong></span> — The MySQL Cluster Data Node Daemon</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgmd">17.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgm">17.6.4. <span><strong class="command">ndb_mgm</strong></span> — The MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-config">17.6.5. <span><strong class="command">ndb_config</strong></span> — Extract MySQL Cluster Configuration Information</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-cpcd">17.6.6. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-delete-all">17.6.7. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-desc">17.6.8. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-drop-index">17.6.9. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-drop-table">17.6.10. <span><strong class="command">ndb_drop_table</strong></span> — Drop an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-error-reporter">17.6.11. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-backup-file">17.6.12. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-schema-file">17.6.13. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-sys-file">17.6.14. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-restore">17.6.15. <span><strong class="command">ndb_restore</strong></span> — Restore a MySQL Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-select-all">17.6.16. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-select-count">17.6.17. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-show-tables">17.6.18. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-size-pl">17.6.19. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-waiter">17.6.20. <span><strong class="command">ndb_waiter</strong></span> — Wait for MySQL Cluster to Reach a Given Status</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-common">17.6.21. Options Common to MySQL Cluster Programs</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-tables">17.6.22. Summary Tables of NDB Program Options</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-management">17.7. Management of MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-start-phases">17.7.1. Summary of MySQL Cluster Start Phases</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-client-commands">17.7.2. Commands in the MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup">17.7.3. Online Backup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-event-reports">17.7.4. Event Reports Generated in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-ndb-messages">17.7.5. MySQL Cluster Log Messages</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-single-user-mode">17.7.6. MySQL Cluster Single User Mode</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sql-statements">17.7.7. Quick Reference: MySQL Cluster SQL Statements</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security">17.8. MySQL Cluster Security Issues</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-networking-issues">17.8.1. MySQL Cluster Security and Networking Issues</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges">17.8.2. MySQL Cluster and MySQL Privileges</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-security-procedures">17.8.3. MySQL Cluster and MySQL Security Procedures</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects">17.9. Using High-Speed Interconnects with MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-sockets">17.9.1. Configuring MySQL Cluster to use SCI Sockets</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects-performance">17.9.2. MySQL Cluster Interconnects and Performance</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations">17.10. Known Limitations of MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-syntax">17.10.1. Noncompliance with SQL Syntax in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-limits">17.10.2. Limits and Differences of MySQL Cluster from Standard MySQL Limits</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-transactions">17.10.3. Limits Relating to Transaction Handling in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-error-handling">17.10.4. MySQL Cluster Error Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-database-objects">17.10.5. Limits Associated with Database Objects in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-unsupported">17.10.6. Unsupported or Missing Features in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-performance">17.10.7. Limitations Relating to Performance in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-exclusive-to-cluster">17.10.8. Issues Exclusive to MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes">17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-resolved">17.10.10. Previous MySQL Cluster Issues Resolved in MySQL 5.0</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-roadmap">17.11. MySQL Cluster Development Roadmap</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-5-0-changes">17.11.1. MySQL Cluster Changes in MySQL 5.0</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-5-1-roadmap">17.11.2. MySQL 5.1 Development Roadmap for MySQL Cluster</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-glossary">17.12. MySQL Cluster Glossary</a></span></dt></dl></div><a class="indexterm" name="id2251553"></a><a class="indexterm" name="id2251562"></a><a class="indexterm" name="id2251574"></a><p>
    <em class="firstterm">MySQL Cluster</em> is a high-availability,
    high-redundancy version of MySQL adapted for the distributed
    computing environment. It uses the
    <code class="literal">NDBCLUSTER</code> storage engine to enable
    running several computers with MySQL servers and other software in a
    cluster. This storage engine is available in MySQL 5.0
    binary releases and in RPMs compatible with most modern Linux
    distributions.
  </p><a class="indexterm" name="id2251613"></a><p>
    MySQL Cluster is currently available and supported on a number of
    platforms, including Linux, Solaris, Mac OS X, and other Unix-style
    operating systems on a variety of hardware. For exact levels of
    support available for on specific combinations of operating system
    versions, operating system distributions, and hardware platforms,
    please refer to
    <em class="citetitle"><a href="http://www.mysql.com/support/supportedplatforms/cluster.html" target="_top">MySQL
    Cluster Supported Platforms</a></em>, maintained by the
    MySQL Support Team on the MySQL web site.
  </p><p>
    Beginning with MySQL Cluster NDB 7.0, MySQL Cluster is available for
    testing on Microsoft Windows (but not yet for production use). We
    are working to make Cluster available on all operating systems
    supported by MySQL; we will update the information provided here as
    this work continues. However, we do not plan to make MySQL Cluster
    available on Microsoft Windows in MySQL 5.0 or any
    other release series prior to MySQL Cluster NDB 7.0, which is based
    on MySQL 5.1. For more information, see
    <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster.html" target="_top">MySQL Cluster NDB 6.X/7.X</a>.
  </p><p>
    This chapter represents a work in progress, and its contents are
    subject to revision as MySQL Cluster continues to evolve. Additional
    information regarding MySQL Cluster can be found on the MySQL Web
    site at <a href="http://www.mysql.com/products/cluster/" target="_top">http://www.mysql.com/products/cluster/</a>.
  </p><a class="indexterm" name="id2251665"></a><p><b>Additional resources. </b>
      More information may be found in the following places:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Answers to some commonly asked questions about Cluster may
            be found in the <a href="faqs.html#faqs-mysql-cluster" title="A.10. MySQL 5.0 FAQ — MySQL Cluster">Section A.10, “MySQL 5.0 FAQ — MySQL Cluster”</a>.
          </p></li><li><p>
            The MySQL Cluster mailing list:
            <a href="http://lists.mysql.com/cluster" target="_top">http://lists.mysql.com/cluster</a>.
          </p></li><li><p>
            The MySQL Cluster Forum:
            <a href="http://forums.mysql.com/list.php?25" target="_top">http://forums.mysql.com/list.php?25</a>.
          </p></li><li><p>
            Many MySQL Cluster users and some of the MySQL Cluster
            developers blog about their experiences with Cluster, and
            make feeds of these available through
            <a href="http://www.planetmysql.org/" target="_top">PlanetMySQL</a>.
          </p></li><li><p>
            If you are new to MySQL Cluster, you may find our Developer
            Zone article
            <a href="http://dev.mysql.com/tech-resources/articles/mysql-cluster-for-two-servers.html" target="_top">
            How to set up a MySQL Cluster for two servers</a> to be
            helpful.
          </p></li></ul></div><p>
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-overview"></a>17.1. MySQL Cluster Overview</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-basics">17.1.1. MySQL Cluster Core Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-nodes-groups">17.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</a></span></dt></dl></div><a class="indexterm" name="id2251763"></a><p>
    <em class="firstterm">MySQL Cluster</em> is a technology that enables
    clustering of in-memory databases in a shared-nothing system. The
    shared-nothing architecture allows the system to work with very
    inexpensive hardware, and with a minimum of specific requirements
    for hardware or software.
  </p><p>
    MySQL Cluster is designed not to have any single point of failure.
    For this reason, each component is expected to have its own memory
    and disk, and the use of shared storage mechanisms such as network
    shares, network file systems, and SANs is not recommended or
    supported.
  </p><p>
    MySQL Cluster integrates the standard MySQL server with an in-memory
    clustered storage engine called <code class="literal">NDB</code>. In
    our documentation, the term <code class="literal">NDB</code> refers
    to the part of the setup that is specific to the storage engine,
    whereas “<span class="quote">MySQL Cluster</span>” refers to the combination of
    MySQL and the <code class="literal">NDB</code> storage engine.
  </p><p>
    A MySQL Cluster consists of a set of computers, each running one or
    more processes which may include a MySQL server, a data node, a
    management server, and (possibly) specialized data access programs.
    The relationship of these components in a cluster is shown here:
  </p><div class="mediaobject"><img src="images/cluster-components-1.png" width="583" height="372" alt="MySQL Cluster Components"></div><p>
    All these programs work together to form a MySQL Cluster. When data
    is stored in the <code class="literal">NDBCLUSTER</code> storage
    engine, the tables are stored in the data nodes. Such tables are
    directly accessible from all other MySQL servers in the cluster.
    Thus, in a payroll application storing data in a cluster, if one
    application updates the salary of an employee, all other MySQL
    servers that query this data can see this change immediately.
  </p><p>
    The data stored in the data nodes for MySQL Cluster can be mirrored;
    the cluster can handle failures of individual data nodes with no
    other impact than that a small number of transactions are aborted
    due to losing the transaction state. Because transactional
    applications are expected to handle transaction failure, this should
    not be a source of problems.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-basics"></a>17.1.1. MySQL Cluster Core Concepts</h3></div></div></div><a class="indexterm" name="id2251887"></a><a class="indexterm" name="id2251899"></a><a class="indexterm" name="id2251911"></a><a class="indexterm" name="id2251924"></a><a class="indexterm" name="id2251936"></a><a class="indexterm" name="id2251949"></a><a class="indexterm" name="id2251962"></a><a class="indexterm" name="id2251978"></a><a class="indexterm" name="id2251994"></a><a class="indexterm" name="id2252010"></a><a class="indexterm" name="id2252026"></a><a class="indexterm" name="id2252038"></a><a class="indexterm" name="id2252050"></a><a class="indexterm" name="id2252063"></a><a class="indexterm" name="id2252075"></a><p>
      <em class="firstterm"><code class="literal">NDBCLUSTER</code></em>
      (also known as <code class="literal">NDB</code>) is an in-memory
      storage engine offering high-availability and data-persistence
      features.
    </p><p>
      The <code class="literal">NDBCLUSTER</code> storage engine can be
      configured with a range of failover and load-balancing options,
      but it is easiest to start with the storage engine at the cluster
      level. MySQL Cluster's <code class="literal">NDB</code> storage
      engine contains a complete set of data, dependent only on other
      data within the cluster itself.
    </p><p>
      The “<span class="quote">Cluster</span>” portion of MySQL Cluster is configured
      independently of the MySQL servers. In a MySQL Cluster, each part
      of the cluster is considered to be a <em class="firstterm">node</em>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In many contexts, the term “<span class="quote">node</span>” is used to
        indicate a computer, but when discussing MySQL Cluster it means
        a <span class="emphasis"><em>process</em></span>. It is possible to run multiple
        nodes on a single computer; for a computer on which one or more
        cluster nodes are being run we use the term <em class="firstterm">cluster
        host</em>.
      </p><p>
        However, MySQL 5.0 does not support the use of
        multiple data nodes on a single computer in a production
        setting. See
        <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes">Section 17.10.9, “Limitations Relating to Multiple MySQL Cluster Nodes”</a>.
      </p></div><p>
      There are three types of cluster nodes, and in a minimal MySQL
      Cluster configuration, there will be at least three nodes, one of
      each of these types:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <em class="firstterm">Management node</em> (MGM node): The role of
          this type of node is to manage the other nodes within the
          MySQL Cluster, performing such functions as providing
          configuration data, starting and stopping nodes, running
          backup, and so forth. Because this node type manages the
          configuration of the other nodes, a node of this type should
          be started first, before any other node. An MGM node is
          started with the command <span><strong class="command">ndb_mgmd</strong></span>.
        </p></li><li><p>
          <em class="firstterm">Data node</em>: This type of node stores
          cluster data. There are as many data nodes as there are
          replicas, times the number of fragments. For example, with two
          replicas, each having two fragments, you need four data nodes.
          One replica is sufficient for data storage, but provides no
          redundancy; therefore, it is recommended to have 2 (or more)
          replicas to provide redundancy, and thus high availability. A
          data node is started with the command <span><strong class="command">ndbd</strong></span>.
        </p></li><li><p>
          <em class="firstterm">SQL node</em>: This is a node that accesses
          the cluster data. In the case of MySQL Cluster, an SQL node is
          a traditional MySQL server that uses the
          <code class="literal">NDBCLUSTER</code> storage engine. An SQL
          node is a <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process started with the
          <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> and
          <code class="option">--ndb-connectstring</code> options, which are
          explained elsewhere in this chapter, possibly with additional
          MySQL server options as well.
        </p><p>
          An SQL node is actually just a specialized type of
          <em class="firstterm">API node</em>, which designates any
          application which accesses Cluster data. Another example of an
          API node is the <span><strong class="command">ndb_restore</strong></span> utility that is
          used to restore a cluster backup. It is possible to write such
          applications using the NDB API. For basic information about
          the NDB API, see <a href="http://dev.mysql.com/doc/ndbapi/en/getting-started.html" target="_top">Getting Started with the NDB API</a>.
        </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        It is not realistic to expect to employ a three-node setup in a
        production environment. Such a configuration provides no
        redundancy; in order to benefit from MySQL Cluster's
        high-availability features, you must use multiple data and SQL
        nodes. The use of multiple management nodes is also highly
        recommended.
      </p></div><p>
      For a brief introduction to the relationships between nodes, node
      groups, replicas, and partitions in MySQL Cluster, see
      <a href="mysql-cluster.html#mysql-cluster-nodes-groups" title="17.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions">Section 17.1.2, “MySQL Cluster Nodes, Node Groups, Replicas, and Partitions”</a>.
    </p><p>
      Configuration of a cluster involves configuring each individual
      node in the cluster and setting up individual communication links
      between nodes. MySQL Cluster is currently designed with the
      intention that data nodes are homogeneous in terms of processor
      power, memory space, and bandwidth. In addition, to provide a
      single point of configuration, all configuration data for the
      cluster as a whole is located in one configuration file.
    </p><p>
      The management server (MGM node) manages the cluster configuration
      file and the cluster log. Each node in the cluster retrieves the
      configuration data from the management server, and so requires a
      way to determine where the management server resides. When
      interesting events occur in the data nodes, the nodes transfer
      information about these events to the management server, which
      then writes the information to the cluster log.
    </p><p>
      In addition, there can be any number of cluster client processes
      or applications. These are of two types:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Standard MySQL clients. </b>
            MySQL Cluster can be used with existing MySQL applications
            written in PHP, Perl, C, C++, Java, Python, Ruby, and so on.
            Such client applications send SQL statements to and receive
            responses from MySQL servers acting as MySQL Cluster SQL
            nodes in much the same way that they interact with
            standalone MySQL servers. However, MySQL clients using a
            MySQL Cluster as a data source can be modified to take
            advantage of the ability to connect with multiple MySQL
            servers to achieve load balancing and failover. For example,
            Java clients using Connector/J 5.0.6 and later can use
            <code class="literal">jdbc:mysql:loadbalance://</code> URLs (improved
            in Connector/J 5.1.7) to achieve load balancing
            transparently


            .
          </p></li><li><p><b>Management clients. </b>
            These clients connect to the management server and provide
            commands for starting and stopping nodes gracefully,
            starting and stopping message tracing (debug versions only),
            showing node versions and status, starting and stopping
            backups, and so on. Such clients — such as the
            <span><strong class="command">ndb_mgm</strong></span> management client supplied with
            MySQL Cluster — are written using the MGM API, a
            C-language API that communicates directly with one or more
            MySQL Cluster management servers. For more information, see
            <a href="http://dev.mysql.com/doc/ndbapi/en/mgm-api.html" target="_top">The MGM API</a>.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-nodes-groups"></a>17.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</h3></div></div></div><a class="indexterm" name="id2252390"></a><a class="indexterm" name="id2252402"></a><a class="indexterm" name="id2252414"></a><a class="indexterm" name="id2252427"></a><a class="indexterm" name="id2252436"></a><a class="indexterm" name="id2252445"></a><p>
      This section discusses the manner in which MySQL Cluster divides
      and duplicates data for storage.
    </p><p>
      Central to an understanding of this topic are the following
      concepts, listed here with brief definitions:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>(Data) Node. </b>
            An <span><strong class="command">ndbd</strong></span> process, which stores a
            <em class="firstterm">replica</em> —that is, a copy of the
            <em class="firstterm">partition</em> (see below) assigned to the
            node group of which the node is a member.
          </p><p>
          Each data node should be located on a separate computer. While
          it is also possible to host multiple <span><strong class="command">ndbd</strong></span>
          processes on a single computer, such a configuration is not
          supported.
        </p><p>
          It is common for the terms “<span class="quote">node</span>” and “<span class="quote">data
          node</span>” to be used interchangeably when referring to an
          <span><strong class="command">ndbd</strong></span> process; where mentioned, management
          (MGM) nodes (<span><strong class="command">ndb_mgmd</strong></span> processes) and SQL
          nodes (<a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> processes) are specified as
          such in this discussion.
        </p></li><li><p><b>Node Group. </b>
            A node group consists of one or more nodes, and stores
            partitions, or sets of <em class="firstterm">replicas</em> (see
            next item).
          </p><p>
          The number of node groups in a MySQL Cluster is not directly
          configurable; it is function of the number of data nodes and
          of the number of replicas (<code class="literal">NumberOfReplicas</code>
          configuration parameter), as shown here:
        </p><pre class="programlisting">[<em class="replaceable"><code>number_of_node_groups</code></em>] = <em class="replaceable"><code>number_of_data_nodes</code></em> / <code class="literal">NumberOfReplicas</code>
</pre><p>
          Thus, a MySQL Cluster with 4 data nodes has 4 node groups if
          <code class="literal">NumberOfReplicas</code> is set to 1 in the
          <code class="filename">config.ini</code> file, 2 node groups if
          <code class="literal">NumberOfReplicas</code> is set to 2, and 1 node
          group if <code class="literal">NumberOfReplicas</code> is set to 4.
          Replicas are discussed later in this section; for more
          information about <code class="literal">NumberOfReplicas</code>, see
          <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="17.3.4.5. Defining MySQL Cluster Data Nodes">Section 17.3.4.5, “Defining MySQL Cluster Data Nodes”</a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            All node groups in a MySQL Cluster must have the same number
            of data nodes.
          </p></div></li><li><p><b>Partition. </b>
            This is a portion of the data stored by the cluster. There
            are as many cluster partitions as nodes participating in the
            cluster. Each node is responsible for keeping at least one
            copy of any partitions assigned to it (that is, at least one
            replica) available to the cluster.
          </p><p>
          A replica belongs entirely to a single node; a node can (and
          usually does) store several replicas.
        </p></li><li><p><b>Replica. </b>
            This is a copy of a cluster partition. Each node in a node
            group stores a replica. Also sometimes known as a
            <em class="firstterm">partition replica</em>. The number of
            replicas is equal to the number of nodes per node group.
          </p></li></ul></div><p>
      The following diagram illustrates a MySQL Cluster with four data
      nodes, arranged in two node groups of two nodes each; nodes 1 and
      2 belong to node group 0, and nodes 3 and 4 belong to node group
      1. Note that only data (<span><strong class="command">ndbd</strong></span>) nodes are shown
      here; although a working cluster requires an
      <span><strong class="command">ndb_mgm</strong></span> process for cluster management and at
      least one SQL node to access the data stored by the cluster, these
      have been omitted in the figure for clarity.
    </p><div class="mediaobject"><img src="images/replicas-groups-1-1.png" width="500" height="505" alt="A MySQL Cluster, with 2 node groups having 2
        nodes each"></div><p>
      The data stored by the cluster is divided into four partitions,
      numbered 0, 1, 2, and 3. Each partition is stored — in
      multiple copies — on the same node group. Partitions are
      stored on alternate node groups:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Partition 0 is stored on node group 0; a <em class="firstterm">primary
          replica</em> (primary copy) is stored on node 1, and a
          <em class="firstterm">backup replica</em> (backup copy of the
          partition) is stored on node 2.
        </p></li><li><p>
          Partition 1 is stored on the other node group (node group 1);
          this partition's primary replica is on node 3, and its backup
          replica is on node 4.
        </p></li><li><p>
          Partition 2 is stored on node group 0. However, the placing of
          its two replicas is reversed from that of Partition 0; for
          Partition 2, the primary replica is stored on node 2, and the
          backup on node 1.
        </p></li><li><p>
          Partition 3 is stored on node group 1, and the placement of
          its two replicas are reversed from those of partition 1. That
          is, its primary replica is located on node 4, with the backup
          on node 3.
        </p></li></ul></div><p>
      What this means regarding the continued operation of a MySQL
      Cluster is this: so long as each node group participating in the
      cluster has at least one node operating, the cluster has a
      complete copy of all data and remains viable. This is illustrated
      in the next diagram.
    </p><div class="mediaobject"><img src="images/replicas-groups-1-2.png" width="500" height="395" alt="Nodes required to keep a 2x2 cluster
        viable"></div><p>
      In this example, where the cluster consists of two node groups of
      two nodes each, any combination of at least one node in node group
      0 and at least one node in node group 1 is sufficient to keep the
      cluster “<span class="quote">alive</span>” (indicated by arrows in the diagram).
      However, if <span class="emphasis"><em>both</em></span> nodes from
      <span class="emphasis"><em>either</em></span> node group fail, the remaining two
      nodes are not sufficient (shown by the arrows marked out with an
      <span class="bold"><strong>X</strong></span>); in either case, the cluster
      has lost an entire partition and so can no longer provide access
      to a complete set of all cluster data.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-multi-computer"></a>17.2. MySQL Cluster Multi-Computer How-To</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network">17.2.1. MySQL Cluster Hardware, Software, and Networking Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-install">17.2.2. MySQL Cluster Multi-Computer Installation</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-config">17.2.3. MySQL Cluster Multi-Computer Configuration</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-initial">17.2.4. Initial Startup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries">17.2.5. Loading Sample Data into MySQL Cluster and Performing Queries</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-shutdown-restart">17.2.6. Safe Shutdown and Restart of MySQL Cluster</a></span></dt></dl></div><a class="indexterm" name="id2252854"></a><a class="indexterm" name="id2252863"></a><a class="indexterm" name="id2252872"></a><a class="indexterm" name="id2252885"></a><a class="indexterm" name="id2252894"></a><p>
    This section is a “<span class="quote">How-To</span>” that describes the basics
    for how to plan, install, configure, and run a MySQL Cluster.
    Whereas the examples in
    <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a> provide more in-depth
    information on a variety of clustering options and configuration,
    the result of following the guidelines and procedures outlined here
    should be a usable MySQL Cluster which meets the
    <span class="emphasis"><em>minimum</em></span> requirements for availability and
    safeguarding of data.
  </p><p>
    This section covers hardware and software requirements; networking
    issues; installation of MySQL Cluster; configuration issues;
    starting, stopping, and restarting the cluster; loading of a sample
    database; and performing queries.
  </p><p><b>Basic assumptions. </b>
      This <em class="citetitle">How-To</em> makes the following
      assumptions:
    </p><div class="orderedlist"><ol type="1"><li><p>
        The cluster is to be set up with four nodes, each on a separate
        host, and each with a fixed network address on a typical
        Ethernet network as shown here:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Node</strong></span></td><td><span class="bold"><strong>IP Address</strong></span></td></tr><tr><td>Management (MGMD) node</td><td>192.168.0.10</td></tr><tr><td>MySQL server (SQL) node</td><td>192.168.0.20</td></tr><tr><td>Data (NDBD) node "A"</td><td>192.168.0.30</td></tr><tr><td>Data (NDBD) node "B"</td><td>192.168.0.40</td></tr></tbody></table></div><p>
        This may be made clearer in the following diagram:
      </p><div class="mediaobject"><img src="images/multi-comp-1.png" width="500" height="393" alt="MySQL Cluster Multi-Computer Setup"></div><a class="indexterm" name="id2253073"></a><a class="indexterm" name="id2253085"></a><p>
        In the interest of simplicity (and reliability), this
        <em class="citetitle">How-To</em> uses only numeric IP addresses.
        However, if DNS resolution is available on your network, it is
        possible to use host names in lieu of IP addresses in
        configuring Cluster. Alternatively, you can use the
        <code class="filename">/etc/hosts</code> file or your operating
        system's equivalent for providing a means to do host lookup
        if such is available.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          A common problem when trying to use host names for Cluster
          nodes arises because of the way in which some operating
          systems (including some Linux distributions) set up the
          system's own host name in the <code class="filename">/etc/hosts</code>
          during installation. Consider two machines with the host names
          <code class="literal">ndb1</code> and <code class="literal">ndb2</code>, both in
          the <code class="literal">cluster</code> network domain. Red Hat Linux
          (including some derivatives such as CentOS and Fedora) places
          the following entries in these machines'
          <code class="filename">/etc/hosts</code> files:

</p><pre class="programlisting">#  ndb1 <code class="filename">/etc/hosts</code>:
127.0.0.1   ndb1.cluster ndb1 localhost.localdomain localhost
</pre><p>

</p><pre class="programlisting">#  ndb2 <code class="filename">/etc/hosts</code>:
127.0.0.1   ndb2.cluster ndb2 localhost.localdomain localhost
</pre><p>

          SUSE Linux (including OpenSUSE) places these entries in the
          machines' <code class="filename">/etc/hosts</code> files:

</p><pre class="programlisting">#  ndb1 <code class="filename">/etc/hosts</code>:
127.0.0.1       localhost
127.0.0.2       ndb1.cluster ndb1
</pre><p>

</p><pre class="programlisting">#  ndb2 <code class="filename">/etc/hosts</code>:
127.0.0.1       localhost
127.0.0.2       ndb2.cluster ndb2
</pre><p>

          In both instances, <code class="literal">ndb1</code> routes
          <code class="literal">ndb1.cluster</code> to a loopback IP address, but
          gets a public IP address from DNS for
          <code class="literal">ndb2.cluster</code>, while <code class="literal">ndb2</code>
          routes <code class="literal">ndb2.cluster</code> to a loopback address
          and obtains a public address for
          <code class="literal">ndb1.cluster</code>. The result is that each data
          node connects to the management server, but cannot tell when
          any other data nodes have connected, and so the data nodes
          appear to hang while starting.
        </p><p>
          You should also be aware that you cannot mix
          <code class="literal">localhost</code> and other host names or IP
          addresses in <code class="filename">config.ini</code>. For these
          reasons, the solution in such cases (other than to use IP
          addresses for <span class="emphasis"><em>all</em></span>
          <code class="filename">config.ini</code> <code class="literal">HostName</code>
          entries) is to remove the fully qualified host names from
          <code class="filename">/etc/hosts</code> and use these in
          <code class="filename">config.ini</code> for all cluster hosts.
        </p></div></li><li><p>
        Each host in our scenario is an Intel-based desktop PC running a
        common, generic Linux distribution installed to disk in a
        standard configuration, and running no unnecessary services. The
        core OS with standard TCP/IP networking capabilities should be
        sufficient. Also for the sake of simplicity, we also assume that
        the file systems on all hosts are set up identically. In the
        event that they are not, you will need to adapt these
        instructions accordingly.
      </p></li><li><p>
        Standard 100 Mbps or 1 gigabit Ethernet cards are installed on
        each machine, along with the proper drivers for the cards, and
        that all four hosts are connected via a standard-issue Ethernet
        networking appliance such as a switch. (All machines should use
        network cards with the same throughout. That is, all four
        machines in the cluster should have 100 Mbps cards
        <span class="emphasis"><em>or</em></span> all four machines should have 1 Gbps
        cards.) MySQL Cluster will work in a 100 Mbps network; however,
        gigabit Ethernet will provide better performance.
      </p><p>
        Note that MySQL Cluster is <span class="emphasis"><em>not</em></span> intended for
        use in a network for which throughput is less than 100 Mbps. For
        this reason (among others), attempting to run a MySQL Cluster
        over a public network such as the Internet is not likely to be
        successful, and is not recommended.
      </p></li><li><p>
        For our sample data, we will use the <code class="literal">world</code>
        database which is available for download from the MySQL Web
        site. As this database takes up a relatively small amount of
        space, we assume that each machine has 256MB RAM, which should
        be sufficient for running the operating system, host NDB
        process, and (for the data nodes) for storing the database.
      </p></li></ol></div><p>
    Although we refer to a Linux operating system in this How-To, the
    instructions and procedures that we provide here should be easily
    adaptable to other supported operating systems. We also assume that
    you already know how to perform a minimal installation and
    configuration of the operating system with networking capability, or
    that you are able to obtain assistance in this elsewhere if needed.
  </p><p>
    We discuss MySQL Cluster hardware, software, and networking
    requirements in somewhat greater detail in the next section. (See
    <a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network" title="17.2.1. MySQL Cluster Hardware, Software, and Networking Requirements">Section 17.2.1, “MySQL Cluster Hardware, Software, and Networking Requirements”</a>.)
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-hardware-software-network"></a>17.2.1. MySQL Cluster Hardware, Software, and Networking Requirements</h3></div></div></div><a class="indexterm" name="id2253371"></a><a class="indexterm" name="id2253384"></a><p>
      One of the strengths of MySQL Cluster is that it can be run on
      commodity hardware and has no unusual requirements in this regard,
      other than for large amounts of RAM, due to the fact that all live
      data storage is done in memory. (It is possible to reduce this
      requirement using Disk Data tables, which were implemented in
      MySQL 5.1; however, we do not intend to backport this feature to
      MySQL 5.0.) Naturally, multiple and faster CPUs will
      enhance performance. Memory requirements for other Cluster
      processes are relatively small.
    </p><p>
      The software requirements for Cluster are also modest. Host
      operating systems do not require any unusual modules, services,
      applications, or configuration to support MySQL Cluster. For
      supported operating systems, a standard installation should be
      sufficient. The MySQL software requirements are simple: all that
      is needed is a production release of MySQL 5.0 to
      have Cluster support. It is not necessary to compile MySQL
      yourself merely to be able to use Cluster. In this
      <em class="citetitle">How-To</em>, we assume that you are using the
      server binary appropriate to your platform, available via the
      MySQL software downloads page at
      <a href="http://dev.mysql.com/downloads/" target="_top">http://dev.mysql.com/downloads/</a>.
    </p><p>
      For communication between nodes, Cluster supports TCP/IP
      networking in any standard topology, and the minimum expected for
      each host is a standard 100 Mbps Ethernet card, plus a switch,
      hub, or router to provide network connectivity for the cluster as
      a whole. We strongly recommend that a MySQL Cluster be run on its
      own subnet which is not shared with non-Cluster machines for the
      following reasons:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Security. </b>
            Communications between Cluster nodes are not encrypted or
            shielded in any way. The only means of protecting
            transmissions within a MySQL Cluster is to run your Cluster
            on a protected network. If you intend to use MySQL Cluster
            for Web applications, the cluster should definitely reside
            behind your firewall and not in your network's
            De-Militarized Zone
            (<a href="http://compnetworking.about.com/cs/networksecurity/g/bldef_dmz.htm" target="_top">DMZ</a>)
            or elsewhere.
          </p><p>
          See
          <a href="mysql-cluster.html#mysql-cluster-security-networking-issues" title="17.8.1. MySQL Cluster Security and Networking Issues">Section 17.8.1, “MySQL Cluster Security and Networking Issues”</a>,
          for more information.
        </p></li><li><p><b>Efficiency. </b>
            Setting up a MySQL Cluster on a private or protected network
            allows the cluster to make exclusive use of bandwidth
            between cluster hosts. Using a separate switch for your
            MySQL Cluster not only helps protect against unauthorized
            access to Cluster data, it also ensures that Cluster nodes
            are shielded from interference caused by transmissions
            between other computers on the network. For enhanced
            reliability, you can use dual switches and dual cards to
            remove the network as a single point of failure; many device
            drivers support failover for such communication links.
          </p></li></ul></div><p>
      It is also possible to use the high-speed Scalable Coherent
      Interface (SCI) with MySQL Cluster, but this is not a requirement.
      See <a href="mysql-cluster.html#mysql-cluster-interconnects" title="17.9. Using High-Speed Interconnects with MySQL Cluster">Section 17.9, “Using High-Speed Interconnects with MySQL Cluster”</a>, for more about
      this protocol and its use with MySQL Cluster.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-install"></a>17.2.2. MySQL Cluster Multi-Computer Installation</h3></div></div></div><a class="indexterm" name="id2253514"></a><a class="indexterm" name="id2253523"></a><a class="indexterm" name="id2253536"></a><a class="indexterm" name="id2253545"></a><p>
      Each MySQL Cluster host computer running an SQL node must have
      installed on it a MySQL binary. For management nodes and data
      nodes, it is not necessary to install the MySQL server binary, but
      management nodes require the management server daemon
      (<span><strong class="command">ndb_mgmd</strong></span>) and data nodes require the data node
      daemon (<span><strong class="command">ndbd</strong></span>). It is also a good idea to
      install the management client (<span><strong class="command">ndb_mgm</strong></span>) on the
      management server host. This section covers the steps necessary to
      install the correct binaries for each type of Cluster node.
    </p><p>
      Sun Microsystems, Inc. provides precompiled binaries that support
      Cluster, and there is generally no need to compile these yourself.
      However, we also include information relating to installing a
      MySQL Cluster after building MySQL from source. For setting up a
      cluster using MySQL's binaries, the first step in the
      installation process for each cluster host is to download the file
      <code class="filename">mysql-5.0.86-pc-linux-gnu-i686.tar.gz</code>
      from the <a href="http://dev.mysql.com/downloads/" target="_top">MySQL downloads
      area</a>. We assume that you have placed it in each machine's
      <code class="filename">/var/tmp</code> directory. (If you do require a
      custom binary, see <a href="installing.html#installing-source-tree" title="2.16.3. Installing from the Development Source Tree">Section 2.16.3, “Installing from the Development Source Tree”</a>.)
    </p><p>
      RPMs are also available for both 32-bit and 64-bit Linux
      platforms. For a MySQL Cluster, three RPMs are required:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The <span class="bold"><strong>Server</strong></span> RPM (for example,
          <code class="filename">MySQL-Server-5.0.86-0.glibc23.i386.rpm</code>),
          which supplies the core files needed to run a MySQL Server.
        </p></li><li><p>
          The <span class="bold"><strong>NDB Cluster - Storage
          engine</strong></span> RPM (for example,
          <code class="filename">MySQL-ndb-storage-5.0.86-0.glibc23.i386.rpm</code>),
          which supplies the MySQL Cluster data node binary
          (<span><strong class="command">ndbd</strong></span>).
        </p></li><li><p>
          The <span class="bold"><strong>NDB Cluster - Storage engine
          management RPM</strong></span> (for example,
          <code class="filename">MySQL-ndb-management-5.0.86-0.glibc23.i386.rpm</code>),
          which provides the MySQL Cluster management server binary
          (<span><strong class="command">ndb_mgmd</strong></span>).
        </p></li></ul></div><p>
      In addition, you should also obtain the <span class="bold"><strong>NDB
      Cluster - Storage engine basic tools</strong></span> RPM (for example,
      <code class="filename">MySQL-ndb-tools-5.0.86-0.glibc23.i386.rpm</code>),
      which supplies several useful applications for working with a
      MySQL Cluster. The most important of these is the MySQL Cluster
      management client (<span><strong class="command">ndb_mgm</strong></span>). The
      <span class="bold"><strong>NDB Cluster - Storage engine extra
      tools</strong></span> RPM (for example,
      <code class="filename">MySQL-ndb-extra-5.0.86-0.glibc23.i386.rpm</code>)
      contains some additional testing and monitoring programs, but is
      not required to install a MySQL Cluster. (For more information
      about these additional programs, see
      <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>.)
    </p><p>
      The MySQL version number in the RPM file names (shown here as
      <code class="literal">5.0.86</code>) can vary according to the
      version which you are actually using. <span class="emphasis"><em>It is very
      important that all of the Cluster RPMs to be installed have the
      same MySQL version number</em></span>. The <code class="literal">glibc</code>
      version number (if present — shown here as
      <code class="literal">glibc23</code>), and architecture designation (shown
      here as <code class="literal">i386</code>) should be appropriate to the
      machine on which the RPM is to be installed.
    </p><p>
      See <a href="installing.html#linux-rpm" title="2.10. Installing MySQL from RPM Packages on Linux">Section 2.10, “Installing MySQL from RPM Packages on Linux”</a>, for general information about
      installing MySQL using RPMs supplied by Sun Microsystems, Inc.
    </p><p>
      After installing from RPM, you still need to configure the cluster
      as discussed in <a href="mysql-cluster.html#mysql-cluster-multi-config" title="17.2.3. MySQL Cluster Multi-Computer Configuration">Section 17.2.3, “MySQL Cluster Multi-Computer Configuration”</a>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        After completing the installation, do not yet start any of the
        binaries. We show you how to do so following the configuration
        of all nodes.
      </p></div><p><b>Data and SQL Node Installation — <code class="filename">.tar.gz</code>
        Binary. </b>
        On each of the machines designated to host data or SQL nodes,
        perform the following steps as the system
        <code class="literal">root</code> user:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Check your <code class="filename">/etc/passwd</code> and
              <code class="filename">/etc/group</code> files (or use whatever
              tools are provided by your operating system for managing
              users and groups) to see whether there is already a
              <code class="literal">mysql</code> group and
              <code class="literal">mysql</code> user on the system. Some OS
              distributions create these as part of the operating system
              installation process. If they are not already present,
              create a new <code class="literal">mysql</code> user group, and then
              add a <code class="literal">mysql</code> user to this group:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>groupadd mysql</code></strong>
shell&gt; <strong class="userinput"><code>useradd -g mysql mysql</code></strong>
</pre><p>
              The syntax for <span><strong class="command">useradd</strong></span> and
              <span><strong class="command">groupadd</strong></span> may differ slightly on
              different versions of Unix, or they may have different
              names such as <span><strong class="command">adduser</strong></span> and
              <span><strong class="command">addgroup</strong></span>.
            </p></li><li><p>
              Change location to the directory containing the downloaded
              file, unpack the archive, and create a symlink to the
              <code class="filename">mysql</code> directory named
              <code class="filename">mysql</code>. Note that the actual file and
              directory names will vary according to the MySQL version
              number.
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/tmp</code></strong>
shell&gt; <strong class="userinput"><code>tar -C /usr/local -xzvf mysql-5.0.86-pc-linux-gnu-i686.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>ln -s /usr/local/mysql-5.0.86-pc-linux-gnu-i686 /usr/local/mysql</code></strong>
</pre></li><li><p>
              Change location to the <code class="filename">mysql</code>
              directory and run the supplied script for creating the
              system databases:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd mysql</code></strong>
shell&gt; <strong class="userinput"><code>scripts/mysql_install_db --user=mysql</code></strong>
</pre></li><li><p>
              Set the necessary permissions for the MySQL server and
              data directories:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>chown -R root .</code></strong>
shell&gt; <strong class="userinput"><code>chown -R mysql data</code></strong>
shell&gt; <strong class="userinput"><code>chgrp -R mysql .</code></strong>
</pre><p>
              Note that the data directory on each machine hosting a
              data node is <code class="filename">/usr/local/mysql/data</code>.
              This piece of information is essential when configuring
              the management node. (See
              <a href="mysql-cluster.html#mysql-cluster-multi-config" title="17.2.3. MySQL Cluster Multi-Computer Configuration">Section 17.2.3, “MySQL Cluster Multi-Computer Configuration”</a>.)
            </p></li><li><p>
              Copy the MySQL startup script to the appropriate
              directory, make it executable, and set it to start when
              the operating system is booted up:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cp support-files/mysql.server /etc/rc.d/init.d/</code></strong>
shell&gt; <strong class="userinput"><code>chmod +x /etc/rc.d/init.d/mysql.server</code></strong>
shell&gt; <strong class="userinput"><code>chkconfig --add mysql.server</code></strong>
</pre><p>
              (The startup scripts directory may vary depending on your
              operating system and version — for example, in some
              Linux distributions, it is
              <code class="filename">/etc/init.d</code>.)
            </p><p>
              Here we use Red Hat's <span><strong class="command">chkconfig</strong></span> for
              creating links to the startup scripts; use whatever means
              is appropriate for this purpose on your operating system
              and distribution, such as <span><strong class="command">update-rc.d</strong></span>
              on Debian.
            </p></li></ol></div><p>

        Remember that the preceding steps must be performed separately
        on each machine where an SQL node is to reside.
      </p><p><b>SQL node installation — RPM files. </b>
        On each machine to be used for hosting a cluster SQL node,
        install the <span class="bold"><strong>MySQL Server</strong></span> RPM by
        executing the following command as the system root user,
        replacing the name shown for the RPM as necessary to match the
        name of the RPM downloaded from the MySQL web site:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>rpm -Uhv MySQL-server-5.0.86-0.glibc23.i386.rpm</code></strong>
</pre><p>

        This installs the MySQL server binary
        (<a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>) in the
        <code class="filename">/usr/sbin</code> directory, as well as all needed
        MySQL Server support files. It also installs the
        <a href="programs.html#mysql-server" title="4.3.3. mysql.server — MySQL Server Startup Script"><span><strong class="command">mysql.server</strong></span></a> and
        <a href="programs.html#mysqld-safe" title="4.3.2. mysqld_safe — MySQL Server Startup Script"><span><strong class="command">mysqld_safe</strong></span></a> startup scripts in
        <code class="filename">/usr/share/mysql</code> and
        <code class="filename">/usr/bin</code>, respectively. The RPM installer
        should take care of general configuration issues (such as
        creating the <code class="literal">mysql</code> user and group, if needed)
        automatically.
      </p><p><b>SQL node installation — building from source. </b>
        If you compile MySQL with clustering support (for example, by
        using the
        <span><strong class="command">BUILD/compile-<em class="replaceable"><code>platform_name</code></em>-max</strong></span>
        script appropriate to your platform), and perform the default
        installation (using <span><strong class="command">make install</strong></span> as the root
        user), <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> is placed in
        <code class="filename">/usr/local/mysql/bin</code>. Follow the steps
        given in <a href="installing.html#installing-source" title="2.16. MySQL Installation Using a Source Distribution">Section 2.16, “MySQL Installation Using a Source Distribution”</a> to make
        <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> ready for use. If you want to run
        multiple SQL nodes, you can use a copy of the same
        <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> executable and its associated support
        files on several machines. The easiest way to do this is to copy
        the entire <code class="filename">/usr/local/mysql</code> directory and
        all directories and files contained within it to the other SQL
        node host or hosts, then repeat the steps from
        <a href="installing.html#installing-source" title="2.16. MySQL Installation Using a Source Distribution">Section 2.16, “MySQL Installation Using a Source Distribution”</a> on each machine. If you
        configure the build with a nondefault
        <a href="installing.html#option_configure_prefix"><code class="option">--prefix</code></a>, you need to adjust
        the directory accordingly.
      </p><p><b>Data node installation — RPM Files. </b>
        On a computer that is to host a cluster data node it is
        necessary to install only the <span class="bold"><strong>NDB Cluster
        - Storage engine</strong></span> RPM. To do so, copy this RPM to the
        data node host, and run the following command as the system root
        user, replacing the name shown for the RPM as necessary to match
        that of the RPM downloaded from the MySQL web site:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>rpm -Uhv MySQL-ndb-storage-5.0.86-0.glibc23.i386.rpm</code></strong>
</pre><p>

        The previous command installs the MySQL Cluster data node binary
        (<span><strong class="command">ndbd</strong></span>) in the <code class="filename">/usr/sbin</code>
        directory.
      </p><p><b>Data node installation — building from source. </b>
        The only executable required on a data node host is
        <span><strong class="command">ndbd</strong></span> (<a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>, for example,
        does not have to be present on the host machine). By default
        when doing a source build, this file is placed in the directory
        <code class="filename">/usr/local/mysql/libexec</code>. For installing on
        multiple data node hosts, only <span><strong class="command">ndbd</strong></span> need be
        copied to the other host machine or machines. (This assumes that
        all data node hosts use the same architecture and operating
        system; otherwise you may need to compile separately for each
        different platform.) <span><strong class="command">ndbd</strong></span> need not be in any
        particular location on the host's file system, as long as the
        location is known.
      </p><p><b>Management node installation — <code class="filename">.tar.gz</code> binary. </b>
        Installation of the management node does not require the
        <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> binary. Only the binary for the
        management server is required, which can be found in the
        downloaded archive. You most likely want to install the
        management client as well; this can also be found in the
        <code class="filename">.tar.gz</code> archive. Again, we assume that you
        have placed this archive in <code class="filename">/var/tmp</code>.
      </p><p>
      As system <code class="literal">root</code> (that is, after using
      <span><strong class="command">sudo</strong></span>, <span><strong class="command">su root</strong></span>, or your
      system's equivalent for temporarily assuming the system
      administrator account's privileges), perform the following steps
      to install <span><strong class="command">ndb_mgmd</strong></span> and
      <span><strong class="command">ndb_mgm</strong></span> on the Cluster management node host:

      </p><div class="orderedlist"><ol type="1"><li><p>
            Change location to the <code class="filename">/var/tmp</code>
            directory, and extract the <span><strong class="command">ndb_mgm</strong></span> and
            <span><strong class="command">ndb_mgmd</strong></span> from the archive into a suitable
            directory such as <code class="filename">/usr/local/bin</code>:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/tmp</code></strong>
shell&gt; <strong class="userinput"><code>tar -zxvf mysql-5.0.86-pc-linux-gnu-i686.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>cd mysql-5.0.86-pc-linux-gnu-i686</code></strong>
shell&gt; <strong class="userinput"><code>cp bin/ndb_mgm* /usr/local/bin</code></strong>
</pre><p>
            (You can safely delete the directory created by unpacking
            the downloaded archive, and the files it contains, from
            <code class="filename">/var/tmp</code> once
            <span><strong class="command">ndb_mgm</strong></span> and <span><strong class="command">ndb_mgmd</strong></span>
            have been copied to the executables directory.)
          </p></li><li><p>
            Change location to the directory into which you copied the
            files, and then make both of them executable:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /usr/local/bin</code></strong>
shell&gt; <strong class="userinput"><code>chmod +x ndb_mgm*</code></strong>
</pre></li></ol></div><p>
    </p><p><b>Management node installation — RPM file. </b>
        To install the MySQL Cluster management server, it is necessary
        only to use the <span class="bold"><strong>NDB Cluster - Storage
        engine management</strong></span> RPM. Copy this RPM to the computer
        intended to host the management node, and then install it by
        running the following command as the system root user (replace
        the name shown for the RPM as necessary to match that of the
        <span class="bold"><strong>Storage engine management</strong></span> RPM
        downloaded from the MySQL web site):

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>rpm -Uhv MySQL-ndb-management-5.0.86-0.glibc23.i386.rpm</code></strong>
</pre><p>

        This installs the management server binary
        (<span><strong class="command">ndb_mgmd</strong></span>) to the
        <code class="filename">/usr/sbin</code> directory.
      </p><p>
      You should also install the <code class="literal">NDB</code>
      management client, which is supplied by the
      <span class="bold"><strong>Storage engine basic tools</strong></span> RPM.
      Copy this RPM to the same computer as the management node, and
      then install it by running the following command as the system
      root user (again, replace the name shown for the RPM as necessary
      to match that of the <span class="bold"><strong>Storage engine basic
      tools</strong></span> RPM downloaded from the MySQL web site):

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>rpm -Uhv MySQL-Cluster-gpl-tools-6.3.27-0.sles10.i586.rpm</code></strong>
</pre><p>

      The <span class="bold"><strong>Storage engine basic tools</strong></span>
      RPM installs the MySQL Cluster management client
      (<span><strong class="command">ndb_mgm</strong></span>) to the <code class="filename">/usr/bin</code>
      directory.
    </p><p><b>Management node installation — building from source. </b>
        When building from source and running the default <span><strong class="command">make
        install</strong></span>, the management server binary
        (<span><strong class="command">ndb_mgmd</strong></span>) is placed in
        <code class="filename">/usr/local/mysql/libexec</code>, while the
        management client binary (<span><strong class="command">ndb_mgm</strong></span>) can be
        found in <code class="filename">/usr/local/mysql/bin</code>. Only
        <span><strong class="command">ndb_mgmd</strong></span> is required to be present on a
        management node host; however, it is also a good idea to have
        <span><strong class="command">ndb_mgm</strong></span> present on the same host machine.
        Neither of these executables requires a specific location on the
        host machine's file system.
      </p><p>
      In <a href="mysql-cluster.html#mysql-cluster-multi-config" title="17.2.3. MySQL Cluster Multi-Computer Configuration">Section 17.2.3, “MySQL Cluster Multi-Computer Configuration”</a>, we create
      configuration files for all of the nodes in our example Cluster.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-config"></a>17.2.3. MySQL Cluster Multi-Computer Configuration</h3></div></div></div><a class="indexterm" name="id2254727"></a><a class="indexterm" name="id2254740"></a><a class="indexterm" name="id2254752"></a><p>
      For our four-node, four-host MySQL Cluster, it is necessary to
      write four configuration files, one per node host.
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Each data node or SQL node requires a
          <code class="filename">my.cnf</code> file that provides two pieces of
          information: a <em class="firstterm">connectstring</em> that tells
          the node where to find the management node, and a line telling
          the MySQL server on this host (the machine hosting the data
          node) to enable the <code class="literal">NDBCLUSTER</code>
          storage engine.
        </p><p>
          For more information on connectstrings, see
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>.
        </p></li><li><p>
          The management node needs a <code class="filename">config.ini</code>
          file telling it how many replicas to maintain, how much memory
          to allocate for data and indexes on each data node, where to
          find the data nodes, where to save data to disk on each data
          node, and where to find any SQL nodes.
        </p></li></ul></div><p>
      <span class="bold"><strong>Configuring the Storage and SQL
      Nodes</strong></span>
    </p><p>
      The <code class="filename">my.cnf</code> file needed for the data nodes is
      fairly simple. The configuration file should be located in the
      <code class="filename">/etc</code> directory and can be edited using any
      text editor. (Create the file if it does not exist.) For example:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>vi /etc/my.cnf</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        We show <span><strong class="command">vi</strong></span> being used here to create the
        file, but any text editor should work just as well.
      </p></div><p>
      For each data node and SQL node in our example setup,
      <code class="filename">my.cnf</code> should look like this:
    </p><pre class="programlisting"># Options for mysqld process:
[mysqld]
ndbcluster                      # run NDB storage engine
ndb-connectstring=192.168.0.10  # location of management server

# Options for ndbd process:
[mysql_cluster]
ndb-connectstring=192.168.0.10  # location of management server
</pre><p>
      After entering the preceding information, save this file and exit
      the text editor. Do this for the machines hosting data node
      “<span class="quote">A</span>”, data node “<span class="quote">B</span>”, and the SQL node.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Once you have started a <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process with
        the <code class="literal">NDBCLUSTER</code> and
        <code class="literal">ndb-connectstring</code> parameters in the
        <code class="literal">[mysqld]</code> in the <code class="filename">my.cnf</code>
        file as shown previously, you cannot execute any
        <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
        <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements without
        having actually started the cluster. Otherwise, these statements
        will fail with an error. <span class="emphasis"><em>This is by design</em></span>.
      </p></div><p><b>Configuring the management node. </b>
        The first step in configuring the management node is to create
        the directory in which the configuration file can be found and
        then to create the file itself. For example (running as
        <code class="literal">root</code>):
      </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mkdir /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>cd /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>vi config.ini</code></strong>
</pre><p>
      For our representative setup, the <code class="filename">config.ini</code>
      file should read as follows:
    </p><pre class="programlisting"># Options affecting ndbd processes on all data nodes:
[ndbd default]
NoOfReplicas=2    # Number of replicas
DataMemory=80M    # How much memory to allocate for data storage
IndexMemory=18M   # How much memory to allocate for index storage
                  # For DataMemory and IndexMemory, we have used the
                  # default values. Since the "world" database takes up
                  # only about 500KB, this should be more than enough for
                  # this example Cluster setup.

# TCP/IP options:
[tcp default]
portnumber=2202   # This the default; however, you can use any
                  # port that is free for all the hosts in the cluster
                  # Note: It is recommended beginning with MySQL 5.0 that
                  # you do not specify the portnumber at all and simply allow
                  # the default value to be used instead

# Management process options:
[ndb_mgmd]
hostname=192.168.0.10           # Hostname or IP address of MGM node
datadir=/var/lib/mysql-cluster  # Directory for MGM node log files

# Options for data node "A":
[ndbd]
                                # (one [ndbd] section per data node)
hostname=192.168.0.30           # Hostname or IP address
datadir=/usr/local/mysql/data   # Directory for this data node's data files

# Options for data node "B":
[ndbd]
hostname=192.168.0.40           # Hostname or IP address
datadir=/usr/local/mysql/data   # Directory for this data node's data files

# SQL node options:
[mysqld]
hostname=192.168.0.20           # Hostname or IP address
                                # (additional mysqld connections can be
                                # specified for this node for various
                                # purposes such as running ndb_restore)
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The <code class="literal">world</code> database can be downloaded from
        <a href="http://dev.mysql.com/doc/" target="_top">http://dev.mysql.com/doc/</a>, where it can be found listed
        under “<span class="quote">Examples</span>”.
      </p></div><p>
      After all the configuration files have been created and these
      minimal options have been specified, you are ready to proceed with
      starting the cluster and verifying that all processes are running.
      We discuss how this is done in
      <a href="mysql-cluster.html#mysql-cluster-multi-initial" title="17.2.4. Initial Startup of MySQL Cluster">Section 17.2.4, “Initial Startup of MySQL Cluster”</a>.
    </p><p>
      For more detailed information about the available MySQL Cluster
      configuration parameters and their uses, see
      <a href="mysql-cluster.html#mysql-cluster-config-file" title="17.3.4. MySQL Cluster Configuration Files">Section 17.3.4, “MySQL Cluster Configuration Files”</a>, and
      <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a>. For configuration
      of MySQL Cluster as relates to making backups, see
      <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="17.7.3.3. Configuration for MySQL Cluster Backups">Section 17.7.3.3, “Configuration for MySQL Cluster Backups”</a>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The default port for Cluster management nodes is 1186; the
        default port for data nodes is 2202. Beginning with MySQL 5.0.3,
        this restriction is lifted, and the cluster automatically
        allocates ports for data nodes from those that are already free.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-initial"></a>17.2.4. Initial Startup of MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2255115"></a><p>
      Starting the cluster is not very difficult after it has been
      configured. Each cluster node process must be started separately,
      and on the host where it resides. The management node should be
      started first, followed by the data nodes, and then finally by any
      SQL nodes:
    </p><div class="orderedlist"><ol type="1"><li><p>
          On the management host, issue the following command from the
          system shell to start the management node process:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgmd -f /var/lib/mysql-cluster/config.ini</code></strong>
</pre><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            <span><strong class="command">ndb_mgmd</strong></span> must be told where to find its
            configuration file, using the <code class="option">-f</code> or
            <code class="option">--config-file</code> option. (See
            <a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgmd" title="17.6.3. ndb_mgmd — The MySQL Cluster Management Server Daemon">Section 17.6.3, “<span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon”</a>, for
            details.)
          </p><p>
            For additional options which can be used with
            <span><strong class="command">ndb_mgmd</strong></span>, see
            <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
          </p></div></li><li><p>
          On each of the data node hosts, run this command to start the
          <span><strong class="command">ndbd</strong></span> process:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre></li><li><p>
          If you used RPM files to install MySQL on the cluster host
          where the SQL node is to reside, you can (and should) use the
          supplied startup script to start the MySQL server process on
          the SQL node.
        </p></li></ol></div><a class="indexterm" name="id2255233"></a><a class="indexterm" name="id2255246"></a><p>
      If all has gone well, and the cluster has been set up correctly,
      the cluster should now be operational. You can test this by
      invoking the <span><strong class="command">ndb_mgm</strong></span> management node client.
      The output should look like that shown here, although you might
      see some slight differences in the output depending upon the exact
      version of MySQL that you are using:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm</code></strong>
-- NDB Cluster -- Management Client --
ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
Connected to Management Server at: localhost:1186
Cluster Configuration
---------------------
[ndbd(NDB)]     2 node(s)
id=2    @192.168.0.30  (Version: 5.0.86, Nodegroup: 0, Master)
id=3    @192.168.0.40  (Version: 5.0.86, Nodegroup: 0)

[ndb_mgmd(MGM)] 1 node(s)
id=1    @192.168.0.10  (Version: 5.0.86)

[mysqld(API)]   1 node(s)
id=4    @192.168.0.20  (Version: 5.0.86)
</pre><p>
      The SQL node is referenced here as
      <code class="literal">[mysqld(API)]</code>, which reflects the fact that the
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process is acting as a MySQL Cluster API
      node.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The IP address shown for a given MySQL Cluster SQL or other API
        node in the output of <code class="literal">SHOW</code>
        is the address used by the SQL or API node to connect to the
        cluster data nodes, and not to any management node.
      </p></div><p>
      You should now be ready to work with databases, tables, and data
      in MySQL Cluster. See
      <a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries" title="17.2.5. Loading Sample Data into MySQL Cluster and Performing Queries">Section 17.2.5, “Loading Sample Data into MySQL Cluster and Performing Queries”</a>, for a
      brief discussion.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-load-data-queries"></a>17.2.5. Loading Sample Data into MySQL Cluster and Performing Queries</h3></div></div></div><a class="indexterm" name="id2255341"></a><a class="indexterm" name="id2255354"></a><p>
      Working with data in MySQL Cluster is not much different from
      doing so in MySQL without Cluster. There are two points to keep in
      mind:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          For a table to be replicated in the cluster, it must use the
          <code class="literal">NDBCLUSTER</code> storage engine. To
          specify this, use the <code class="literal">ENGINE=NDBCLUSTER</code> or
          <code class="literal">ENGINE=NDB</code> option when creating the table:
        </p><pre class="programlisting">CREATE TABLE <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definitions</code></em>) ENGINE=NDBCLUSTER;
</pre><p>
          Alternatively, for an existing table that uses a different
          storage engine, use <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          to change the table to use
          <code class="literal">NDBCLUSTER</code>:
        </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ENGINE=NDBCLUSTER;
</pre></li><li><p>
          Each <code class="literal">NDBCLUSTER</code> table
          <span class="emphasis"><em>must</em></span> have a primary key. If no primary
          key is defined by the user when a table is created, the
          <code class="literal">NDBCLUSTER</code> storage engine
          automatically generates a hidden one.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            This hidden key takes up space just as does any other table
            index. It is not uncommon to encounter problems due to
            insufficient memory for accommodating these automatically
            created indexes.)
          </p></div></li></ul></div><p>
      If you are importing tables from an existing database using the
      output of <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>, you can open the SQL
      script in a text editor and add the <code class="literal">ENGINE</code>
      option to any table creation statements, or replace any existing
      <code class="literal">ENGINE</code> (or <code class="literal">TYPE</code>) options.
      Suppose that you have the <code class="literal">world</code> sample database
      on another MySQL server that does not support MySQL Cluster, and
      you want to export the <code class="literal">City</code> table:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqldump --add-drop-table world City &gt; city_table.sql</code></strong>
</pre><p>
      The resulting <code class="filename">city_table.sql</code> file will
      contain this table creation statement (and the
      <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statements necessary to
      import the table data):
    </p><pre class="programlisting">DROP TABLE IF EXISTS `City`;
CREATE TABLE `City` (
  `ID` int(11) NOT NULL auto_increment,
  `Name` char(35) NOT NULL default '',
  `CountryCode` char(3) NOT NULL default '',
  `District` char(20) NOT NULL default '',
  `Population` int(11) NOT NULL default '0',
  PRIMARY KEY  (`ID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `City` VALUES (1,'Kabul','AFG','Kabol',1780000);
INSERT INTO `City` VALUES (2,'Qandahar','AFG','Qandahar',237500);
INSERT INTO `City` VALUES (3,'Herat','AFG','Herat',186800);
<em class="replaceable"><code>(remaining INSERT statements omitted)</code></em>
</pre><p>
      You need to make sure that MySQL uses the
      <code class="literal">NDBCLUSTER</code> storage engine for this
      table. There are two ways that this can be accomplished. One of
      these is to modify the table definition
      <span class="emphasis"><em>before</em></span> importing it into the Cluster
      database. Using the <code class="literal">City</code> table as an example,
      modify the <code class="literal">ENGINE</code> option of the definition as
      follows:
    </p><pre class="programlisting">DROP TABLE IF EXISTS `City`;
CREATE TABLE `City` (
  `ID` int(11) NOT NULL auto_increment,
  `Name` char(35) NOT NULL default '',
  `CountryCode` char(3) NOT NULL default '',
  `District` char(20) NOT NULL default '',
  `Population` int(11) NOT NULL default '0',
  PRIMARY KEY  (`ID`)
) <span class="bold"><strong>ENGINE=NDBCLUSTER</strong></span> DEFAULT CHARSET=latin1;

INSERT INTO `City` VALUES (1,'Kabul','AFG','Kabol',1780000);
INSERT INTO `City` VALUES (2,'Qandahar','AFG','Qandahar',237500);
INSERT INTO `City` VALUES (3,'Herat','AFG','Herat',186800);
<em class="replaceable"><code>(remaining INSERT statements omitted)</code></em>
</pre><p>
      This must be done for the definition of each table that is to be
      part of the clustered database. The easiest way to accomplish this
      is to do a search-and-replace on the file that contains the
      definitions and replace all instances of
      <code class="literal">TYPE=<em class="replaceable"><code>engine_name</code></em></code> or
      <code class="literal">ENGINE=<em class="replaceable"><code>engine_name</code></em></code>
      with <code class="literal">ENGINE=NDBCLUSTER</code>. If you do not want to
      modify the file, you can use the unmodified file to create the
      tables, and then use <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to
      change their storage engine. The particulars are given later in
      this section.
    </p><p>
      Assuming that you have already created a database named
      <code class="literal">world</code> on the SQL node of the cluster, you can
      then use the <a href="programs.html#mysql" title="4.5.1. mysql — The MySQL Command-Line Tool"><span><strong class="command">mysql</strong></span></a> command-line client to read
      <code class="filename">city_table.sql</code>, and create and populate the
      corresponding table in the usual manner:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql world &lt; city_table.sql</code></strong>
</pre><p>
      It is very important to keep in mind that the preceding command
      must be executed on the host where the SQL node is running (in
      this case, on the machine with the IP address
      <code class="literal">192.168.0.20</code>).
    </p><p>
      To create a copy of the entire <code class="literal">world</code> database
      on the SQL node, use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> on the
      noncluster server to export the database to a file named
      <code class="filename">world.sql</code>; for example, in the
      <code class="filename">/tmp</code> directory. Then modify the table
      definitions as just described and import the file into the SQL
      node of the cluster like this:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql world &lt; /tmp/world.sql</code></strong>
</pre><p>
      If you save the file to a different location, adjust the preceding
      instructions accordingly.
    </p><p>
      It is important to note that
      <code class="literal">NDBCLUSTER</code> in MySQL 5.0
      does not support autodiscovery of databases. (See
      <a href="mysql-cluster.html#mysql-cluster-limitations" title="17.10. Known Limitations of MySQL Cluster">Section 17.10, “Known Limitations of MySQL Cluster”</a>.) This means that,
      once the <code class="literal">world</code> database and its tables have
      been created on one data node, you need to issue the
      <code class="literal">CREATE DATABASE world</code> statement (beginning with
      MySQL 5.0.2, you may use <code class="literal">CREATE SCHEMA world</code>
      instead), followed by <a href="sql-syntax.html#flush" title="12.5.6.2. FLUSH Syntax"><code class="literal">FLUSH
      TABLES</code></a> on each SQL node in the cluster. This causes the
      node to recognize the database and read its table definitions.
    </p><p>
      Running <a href="sql-syntax.html#select" title="12.2.8. SELECT Syntax"><code class="literal">SELECT</code></a> queries on the SQL
      node is no different from running them on any other instance of a
      MySQL server. To run queries from the command line, you first need
      to log in to the MySQL Monitor in the usual way (specify the
      <code class="literal">root</code> password at the <code class="literal">Enter
      password:</code> prompt):
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql -u root -p</code></strong>
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1 to server version: 5.0.86

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt;
</pre><p>
      We simply use the MySQL server's <code class="literal">root</code>
      account and assume that you have followed the standard security
      precautions for installing a MySQL server, including setting a
      strong <code class="literal">root</code> password. For more information, see
      <a href="installing.html#default-privileges" title="2.17.3. Securing the Initial MySQL Accounts">Section 2.17.3, “Securing the Initial MySQL Accounts”</a>.
    </p><p>
      It is worth taking into account that Cluster nodes do
      <span class="emphasis"><em>not</em></span> make use of the MySQL privilege system
      when accessing one another. Setting or changing MySQL user
      accounts (including the <code class="literal">root</code> account) effects
      only applications that access the SQL node, not interaction
      between nodes. See
      <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="17.8.2. MySQL Cluster and MySQL Privileges">Section 17.8.2, “MySQL Cluster and MySQL Privileges”</a>, for
      more information.
    </p><p>
      If you did not modify the <code class="literal">ENGINE</code> clauses in the
      table definitions prior to importing the SQL script, you should
      run the following statements at this point:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE world;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE City ENGINE=NDBCLUSTER;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE Country ENGINE=NDBCLUSTER;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE CountryLanguage ENGINE=NDBCLUSTER;</code></strong>
</pre><p>
      Selecting a database and running a <span><strong class="command">SELECT</strong></span> query
      against a table in that database is also accomplished in the usual
      manner, as is exiting the MySQL Monitor:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE world;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT Name, Population FROM City ORDER BY Population DESC LIMIT 5;</code></strong>
+-----------+------------+
| Name      | Population |
+-----------+------------+
| Bombay    |   10500000 |
| Seoul     |    9981619 |
| São Paulo |    9968485 |
| Shanghai  |    9696300 |
| Jakarta   |    9604900 |
+-----------+------------+
5 rows in set (0.34 sec)

mysql&gt; <strong class="userinput"><code>\q</code></strong>
Bye

shell&gt;
</pre><p>
      Applications that use MySQL can employ standard APIs to access
      <code class="literal">NDB</code> tables. It is important to
      remember that your application must access the SQL node, and not
      the management or data nodes. This brief example shows how we
      might execute the <a href="sql-syntax.html#select" title="12.2.8. SELECT Syntax"><code class="literal">SELECT</code></a> statement
      just shown by using the PHP 5.X <code class="literal">mysqli</code>
      extension running on a Web server elsewhere on the network:
    </p><pre class="programlisting">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta http-equiv="Content-Type"
        content="text/html; charset=iso-8859-1"&gt;
  &lt;title&gt;SIMPLE mysqli SELECT&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;?php
  # connect to SQL node:
  $link = new mysqli('192.168.0.20', 'root', '<em class="replaceable"><code>root_password</code></em>', 'world');
  # parameters for mysqli constructor are:
  #   host, user, password, database

  if( mysqli_connect_errno() )
    die("Connect failed: " . mysqli_connect_error());

  $query = "SELECT Name, Population
            FROM City
            ORDER BY Population DESC
            LIMIT 5";

  # if no errors...
  if( $result = $link-&gt;query($query) )
  {
?&gt;
&lt;table border="1" width="40%" cellpadding="4" cellspacing ="1"&gt;
  &lt;tbody&gt;
  &lt;tr&gt;
    &lt;th width="10%"&gt;City&lt;/th&gt;
    &lt;th&gt;Population&lt;/th&gt;
  &lt;/tr&gt;
&lt;?
    # then display the results...
    while($row = $result-&gt;fetch_object())
      printf("&lt;tr&gt;\n  &lt;td align=\"center\"&gt;%s&lt;/td&gt;&lt;td&gt;%d&lt;/td&gt;\n&lt;/tr&gt;\n",
              $row-&gt;Name, $row-&gt;Population);
?&gt;
  &lt;/tbody
&lt;/table&gt;
&lt;?
  # ...and verify the number of rows that were retrieved
    printf("&lt;p&gt;Affected rows: %d&lt;/p&gt;\n", $link-&gt;affected_rows);
  }
  else
    # otherwise, tell us what went wrong
    echo mysqli_error();

  # free the result set and the mysqli connection object
  $result-&gt;close();
  $link-&gt;close();
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre><p>
      We assume that the process running on the Web server can reach the
      IP address of the SQL node.
    </p><p>
      In a similar fashion, you can use the MySQL C API, Perl-DBI,
      Python-mysql, or MySQL Connectors to perform the tasks of data
      definition and manipulation just as you would normally with MySQL.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-shutdown-restart"></a>17.2.6. Safe Shutdown and Restart of MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2256024"></a><a class="indexterm" name="id2256036"></a><p>
      To shut down the cluster, enter the following command in a shell
      on the machine hosting the management node:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e shutdown</code></strong>
</pre><p>
      The <code class="option">-e</code> option here is used to pass a command to
      the <span><strong class="command">ndb_mgm</strong></span> client from the shell. (See
      <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>, for more
      information about this option.) The command causes the
      <span><strong class="command">ndb_mgm</strong></span>, <span><strong class="command">ndb_mgmd</strong></span>, and any
      <span><strong class="command">ndbd</strong></span> processes to terminate gracefully. Any SQL
      nodes can be terminated using <a href="programs.html#mysqladmin" title="4.5.2. mysqladmin — Client for Administering a MySQL Server"><span><strong class="command">mysqladmin
      shutdown</strong></span></a> and other means.
    </p><p>
      To restart the cluster, run these commands:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          On the management host (<code class="literal">192.168.0.10</code> in our
          example setup):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgmd -f /var/lib/mysql-cluster/config.ini</code></strong>
</pre></li><li><p>
          On each of the data node hosts
          (<code class="literal">192.168.0.30</code> and
          <code class="literal">192.168.0.40</code>):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre></li><li><p>
          On the SQL host (<code class="literal">192.168.0.20</code>):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld_safe &amp;</code></strong>
</pre></li></ul></div><p>
      In a production setting, it is usually not desirable to shut down
      the cluster completely. In many cases, even when making
      configuration changes, or performing upgrades to the cluster
      hardware or software (or both), which require shutting down
      individual host machines, it is possible to do so without shutting
      down the cluster as a whole by performing a <em class="firstterm">rolling
      restart</em> of the cluster. For more information about
      doing this, see <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="17.5.1. Performing a Rolling Restart of a MySQL Cluster">Section 17.5.1, “Performing a Rolling Restart of a MySQL Cluster”</a>.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-configuration"></a>17.3. MySQL Cluster Configuration</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-building">17.3.1. Building MySQL Cluster from Source Code</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-installing">17.3.2. Installing MySQL Cluster Software</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-quick">17.3.3. Quick Test Setup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-file">17.3.4. MySQL Cluster Configuration Files</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-overview">17.3.5. Overview of MySQL Cluster Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-lcp-params">17.3.6. Configuring MySQL Cluster Parameters for Local Checkpoints</a></span></dt></dl></div><a class="indexterm" name="id2256221"></a><a class="indexterm" name="id2256230"></a><p>
    A MySQL server that is part of a MySQL Cluster differs in one chief
    respect from a normal (nonclustered) MySQL server, in that it
    employs the <code class="literal">NDBCLUSTER</code> storage engine.
    This engine is also referred to simply as
    <code class="literal">NDB</code>, and the two forms of the name are
    synonymous.
  </p><p>
    To avoid unnecessary allocation of resources, the server is
    configured by default with the <code class="literal">NDB</code>
    storage engine disabled. To enable <code class="literal">NDB</code>,
    you must modify the server's <code class="filename">my.cnf</code>
    configuration file, or start the server with the
    <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option.
  </p><p>
    For more information about
    <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> and other MySQL server
    options specific to MySQL Cluster, see
    <a href="mysql-cluster.html#mysql-cluster-program-options-mysqld" title="17.4.2. mysqld Command Options for MySQL Cluster">Section 17.4.2, “<span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster”</a>.
  </p><p>
    The MySQL server is a part of the cluster, so it also must know how
    to access an MGM node to obtain the cluster configuration data. The
    default behavior is to look for the MGM node on
    <code class="literal">localhost</code>. However, should you need to specify
    that its location is elsewhere, this can be done in
    <code class="filename">my.cnf</code> or on the MySQL server command line.
    Before the <code class="literal">NDB</code> storage engine can be
    used, at least one MGM node must be operational, as well as any
    desired data nodes.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-building"></a>17.3.1. Building MySQL Cluster from Source Code</h3></div></div></div><a class="indexterm" name="id2256369"></a><p>
      <code class="literal">NDB</code>, the Cluster storage engine, is
      available in binary distributions for Linux, Mac OS X, and
      Solaris. We are working to make Cluster run on all operating
      systems supported by MySQL, including Windows.
    </p><p>
      If you choose to build from a source tarball or one of the MySQL
      Cluster public development trees, be sure to use the
      <code class="option">--with-ndbcluster</code> option when running
      <span><strong class="command">configure</strong></span>. You can also use the
      <span><strong class="command">BUILD/compile-*-max</strong></span> build scripts (such as
      <span><strong class="command">compile-pentium-max</strong></span>) provided for most Unix
      platforms.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The <span><strong class="command">compile-*-max</strong></span> scripts include OpenSSL, so
        you must either have or obtain OpenSSL to build successfully, or
        else modify the script that you use to exclude this requirement.
        Of course, you can also just follow the standard instructions
        for compiling your own binaries, and then perform the usual
        tests and installation procedure. See
        <a href="installing.html#installing-source-tree" title="2.16.3. Installing from the Development Source Tree">Section 2.16.3, “Installing from the Development Source Tree”</a>.
      </p><p>
        These scripts by default install MySQL to the directory
        <code class="filename">/usr/local/mysql</code>, placing all MySQL Cluster
        executables, scripts, databases, and support files in
        subdirectories under this directory. If this is not what you
        desire, be sure to modify the script accordingly or run it with
        the
        <code class="option">--prefix=<em class="replaceable"><code>path/to/installation/dir</code></em></code>
        option.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-installing"></a>17.3.2. Installing MySQL Cluster Software</h3></div></div></div><a class="indexterm" name="id2256468"></a><a class="indexterm" name="id2256477"></a><p>
      In the next few sections, we assume that you are already familiar
      with installing MySQL, and here we cover only the differences
      between configuring MySQL Cluster and configuring MySQL without
      clustering. (See <a href="installing.html" title="Chapter 2. Installing and Upgrading MySQL">Chapter 2, <i>Installing and Upgrading MySQL</i></a>, if you require more
      information about the latter.)
    </p><p>
      You will find Cluster configuration easiest if you have already
      have all management and data nodes running first; this is likely
      to be the most time-consuming part of the configuration. Editing
      the <code class="filename">my.cnf</code> file is fairly straightforward,
      and this section will cover only any differences from configuring
      MySQL without clustering.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-quick"></a>17.3.3. Quick Test Setup of MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2256522"></a><a class="indexterm" name="id2256534"></a><a class="indexterm" name="id2256546"></a><p>
      To familiarize you with the basics, we will describe the simplest
      possible configuration for a functional MySQL Cluster. After this,
      you should be able to design your desired setup from the
      information provided in the other relevant sections of this
      chapter.
    </p><p>
      First, you need to create a configuration directory such as
      <code class="filename">/var/lib/mysql-cluster</code>, by executing the
      following command as the system <code class="literal">root</code> user:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mkdir /var/lib/mysql-cluster</code></strong>
</pre><p>
      In this directory, create a file named
      <code class="filename">config.ini</code> that contains the following
      information. Substitute appropriate values for
      <code class="literal">HostName</code> and <code class="literal">DataDir</code> as
      necessary for your system.
    </p><pre class="programlisting"># file "config.ini" - showing minimal setup consisting of 1 data node,
# 1 management server, and 3 MySQL servers.
# The empty default sections are not required, and are shown only for
# the sake of completeness.
# Data nodes must provide a hostname but MySQL Servers are not required
# to do so.
# If you don't know the hostname for your machine, use localhost.
# The DataDir parameter also has a default value, but it is recommended to
# set it explicitly.
# Note: [db], [api], and [mgm] are aliases for [ndbd], [mysqld], and [ndb_mgmd],
# respectively. [db] is deprecated and should not be used in new installations.

[ndbd default]
NoOfReplicas= 1

[mysqld  default]
[ndb_mgmd default]
[tcp default]

[ndb_mgmd]
HostName= myhost.example.com

[ndbd]
HostName= myhost.example.com
DataDir= /var/lib/mysql-cluster

[mysqld]
[mysqld]
[mysqld]
</pre><p>
      You can now start the <span><strong class="command">ndb_mgmd</strong></span> management
      server. By default, it attempts to read the
      <code class="filename">config.ini</code> file in its current working
      directory, so change location into the directory where the file is
      located and then invoke <span><strong class="command">ndb_mgmd</strong></span>:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>ndb_mgmd</code></strong>
</pre><p>
      Then start a single data node by running <span><strong class="command">ndbd</strong></span>:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre><p>
      For command-line options which can be used when starting
      <span><strong class="command">ndbd</strong></span>, see
      <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
    </p><p>
      By default, <span><strong class="command">ndbd</strong></span> looks for the management
      server at <code class="literal">localhost</code> on port 1186.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        If you have installed MySQL from a binary tarball, you will need
        to specify the path of the <span><strong class="command">ndb_mgmd</strong></span> and
        <span><strong class="command">ndbd</strong></span> servers explicitly. (Normally, these
        will be found in <code class="filename">/usr/local/mysql/bin</code>.)
      </p></div><p>
      Finally, change location to the MySQL data directory (usually
      <code class="filename">/var/lib/mysql</code> or
      <code class="filename">/usr/local/mysql/data</code>), and make sure that
      the <code class="filename">my.cnf</code> file contains the option necessary
      to enable the NDB storage engine:
    </p><pre class="programlisting">[mysqld]
ndbcluster
</pre><p>
      You can now start the MySQL server as usual:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld_safe --user=mysql &amp;</code></strong>
</pre><p>
      Wait a moment to make sure the MySQL server is running properly.
      If you see the notice <code class="literal">mysql ended</code>, check the
      server's <code class="filename">.err</code> file to find out what went
      wrong.
    </p><p>
      If all has gone well so far, you now can start using the cluster.
      Connect to the server and verify that the
      <code class="literal">NDBCLUSTER</code> storage engine is enabled:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql</code></strong>
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1 to server version: 5.0.86

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
*************************** 12. row ***************************
Engine: NDBCLUSTER
Support: YES
Comment: Clustered, fault-tolerant, memory-based tables
*************************** 13. row ***************************
Engine: NDB
Support: YES
Comment: Alias for NDBCLUSTER
...
</pre><p>
      The row numbers shown in the preceding example output may be
      different from those shown on your system, depending upon how your
      server is configured.
    </p><p>
      Try to create an <code class="literal">NDBCLUSTER</code> table:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql</code></strong>
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
Database changed

mysql&gt; <strong class="userinput"><code>CREATE TABLE ctest (i INT) ENGINE=NDBCLUSTER;</code></strong>
Query OK, 0 rows affected (0.09 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE ctest \G</code></strong>
*************************** 1. row ***************************
       Table: ctest
Create Table: CREATE TABLE `ctest` (
  `i` int(11) default NULL
) ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.00 sec)
</pre><p>
      To check that your nodes were set up properly, start the
      management client:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm</code></strong>
</pre><a class="indexterm" name="id2256906"></a><p>
      Use the <span><strong class="command">SHOW</strong></span> command from within the management
      client to obtain a report on the cluster's status:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
Cluster Configuration
---------------------
[ndbd(NDB)]     1 node(s)
id=2    @127.0.0.1  (Version: 3.5.3, Nodegroup: 0, Master)

[ndb_mgmd(MGM)] 1 node(s)
id=1    @127.0.0.1  (Version: 3.5.3)

[mysqld(API)]   3 node(s)
id=3    @127.0.0.1  (Version: 3.5.3)
id=4 (not connected, accepting connect from any host)
id=5 (not connected, accepting connect from any host)
</pre><p>
      At this point, you have successfully set up a working MySQL
      Cluster. You can now store data in the cluster by using any table
      created with <code class="literal">ENGINE=NDBCLUSTER</code> or its alias
      <code class="literal">ENGINE=NDB</code>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-config-file"></a>17.3.4. MySQL Cluster Configuration Files</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-example">17.3.4.1. MySQL Cluster Configuration — Basic Example</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-connectstring">17.3.4.2. The MySQL Cluster Connectstring</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-computer-definition">17.3.4.3. Defining Computers in a MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-definition">17.3.4.4. Defining a MySQL Cluster Management Server</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndbd-definition">17.3.4.5. Defining MySQL Cluster Data Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-api-definition">17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-tcp-definition">17.3.4.7. MySQL Cluster TCP/IP Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct">17.3.4.8. MySQL Cluster TCP/IP Connections Using Direct Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-shm-definition">17.3.4.9. MySQL Cluster Shared-Memory Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-definition">17.3.4.10. SCI Transport Connections in MySQL Cluster</a></span></dt></dl></div><a class="indexterm" name="id2256970"></a><a class="indexterm" name="id2256982"></a><a class="indexterm" name="id2256994"></a><p>
      Configuring MySQL Cluster requires working with two files:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="filename">my.cnf</code>: Specifies options for all MySQL
          Cluster executables. This file, with which you should be
          familiar with from previous work with MySQL, must be
          accessible by each executable running in the cluster.
        </p></li><li><p>
          <code class="filename">config.ini</code>: This file, sometimes known as
          the <em class="firstterm">global configuration file</em>, is read
          only by the MySQL Cluster management server, which then
          distributes the information contained therein to all processes
          participating in the cluster. <code class="filename">config.ini</code>
          contains a description of each node involved in the cluster.
          This includes configuration parameters for data nodes and
          configuration parameters for connections between all nodes in
          the cluster. For a quick reference to the sections that can
          appear in this file, and what sorts of configuration
          parameters may be placed in each section, see
          <a href="mysql-cluster.html#mysql-cluster-config-ini-sections">Sections of
          the <code class="filename">config.ini</code> File</a>.
        </p></li></ul></div><p>
      We are continuously making improvements in Cluster configuration
      and attempting to simplify this process. Although we strive to
      maintain backward compatibility, there may be times when introduce
      an incompatible change. In such cases we will try to let Cluster
      users know in advance if a change is not backward compatible. If
      you find such a change and we have not documented it, please
      report it in the MySQL bugs database using the instructions given
      in <a href="introduction.html#bug-reports" title="1.6. How to Report Bugs or Problems">Section 1.6, “How to Report Bugs or Problems”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-config-example"></a>17.3.4.1. MySQL Cluster Configuration — Basic Example</h4></div></div></div><a class="indexterm" name="id2257085"></a><a class="indexterm" name="id2257098"></a><a class="indexterm" name="id2257110"></a><p>
        To support MySQL Cluster, you will need to update
        <code class="filename">my.cnf</code> as shown in the following example.
        You may also specify these parameters on the command line when
        invoking the executables.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The options shown here should not be confused with those that
          are used in <code class="filename">config.ini</code> global
          configuration files. Global configuration options are
          discussed later in this section.
        </p></div><pre class="programlisting"># my.cnf
# example additions to my.cnf for MySQL Cluster
# (valid in MySQL 5.0)

# enable ndbcluster storage engine, and provide connectstring for
# management server host (default port is 1186)
[mysqld]
ndbcluster
ndb-connectstring=ndb_mgmd.mysql.com


# provide connectstring for management server host (default port: 1186)
[ndbd]
connect-string=ndb_mgmd.mysql.com

# provide connectstring for management server host (default port: 1186)
[ndb_mgm]
connect-string=ndb_mgmd.mysql.com

# provide location of cluster configuration file
[ndb_mgmd]
config-file=/etc/config.ini
</pre><p>
        (For more information on connectstrings, see
        <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>.)
      </p><pre class="programlisting"># my.cnf
# example additions to my.cnf for MySQL Cluster
# (will work on all versions)

# enable ndbcluster storage engine, and provide connectstring for management
# server host to the default port 1186
[mysqld]
ndbcluster
ndb-connectstring=ndb_mgmd.mysql.com:1186
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Once you have started a <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process with
          the <code class="literal">NDBCLUSTER</code> and
          <code class="literal">ndb-connectstring</code> parameters in the
          <code class="literal">[mysqld]</code> in the <code class="filename">my.cnf</code>
          file as shown previously, you cannot execute any
          <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
          <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements without
          having actually started the cluster. Otherwise, these
          statements will fail with an error. <span class="emphasis"><em>This is by
          design</em></span>.
        </p></div><p>
        You may also use a separate <code class="literal">[mysql_cluster]</code>
        section in the cluster <code class="filename">my.cnf</code> file for
        settings to be read and used by all executables:
      </p><pre class="programlisting"># cluster-specific settings
[mysql_cluster]
ndb-connectstring=ndb_mgmd.mysql.com:1186
</pre><p>
        For additional <code class="literal">NDB</code> variables that
        can be set in the <code class="filename">my.cnf</code> file, see
        <a href="mysql-cluster.html#mysql-cluster-system-variables" title="17.4.3. MySQL Cluster System Variables">Section 17.4.3, “MySQL Cluster System Variables”</a>.
      </p><p>
        The MySQL Cluster global configuration file is named
        <code class="filename">config.ini</code> by default. It is read by
        <span><strong class="command">ndb_mgmd</strong></span> at startup and can be placed
        anywhere. Its location and name are specified by using
        <code class="option">--config-file=<em class="replaceable"><code>path_name</code></em></code>
        on the <span><strong class="command">ndb_mgmd</strong></span> command line. If the
        configuration file is not specified, <span><strong class="command">ndb_mgmd</strong></span>
        by default tries to read a file named
        <code class="filename">config.ini</code> located in the current working
        directory.
      </p><p>
        The global configuration file for MySQL Cluster uses INI format,
        which consists of sections preceded by section headings
        (surrounded by square brackets), followed by the appropriate
        parameter names and values. One deviation from the standard INI
        format is that the parameter name and value can be separated by
        a colon (“<span class="quote"><code class="literal">:</code></span>”) as well as the
        equals sign (“<span class="quote"><code class="literal">=</code></span>”); however, the
        equals sign is preferred. Another deviation is that sections are
        not uniquely identified by section name. Instead, unique
        sections (such as two different nodes of the same type) are
        identified by a unique ID specified as a parameter within the
        section.
      </p><p>
        Default values are defined for most parameters, and can also be
        specified in <code class="filename">config.ini</code>.
        (<span class="emphasis"><em>Exception</em></span>: The
        <code class="literal">NoOfReplicas</code> configuration parameter has no
        default value, and must always be specified explicitly in the
        <code class="literal">[ndbd default]</code> section.) To create a default
        value section, simply add the word <code class="literal">default</code> to
        the section name. For example, an <code class="literal">[ndbd]</code>
        section contains parameters that apply to a particular data
        node, whereas an <code class="literal">[ndbd default]</code> section
        contains parameters that apply to all data nodes. Suppose that
        all data nodes should use the same data memory size. To
        configure them all, create an <code class="literal">[ndbd default]</code>
        section that contains a <code class="literal">DataMemory</code> line to
        specify the data memory size.
      </p><p>
        The global configuration file must define the computers and
        nodes involved in the cluster and on which computers these nodes
        are located. An example of a simple configuration file for a
        cluster consisting of one management server, two data nodes and
        two MySQL servers is shown here:
      </p><pre class="programlisting"># file "config.ini" - 2 data nodes and 2 SQL nodes
# This file is placed in the startup directory of ndb_mgmd (the
# management server)
# The first MySQL Server can be started from any host. The second
# can be started only on the host mysqld_5.mysql.com

[ndbd default]
NoOfReplicas= 2
DataDir= /var/lib/mysql-cluster

[ndb_mgmd]
Hostname= ndb_mgmd.mysql.com
DataDir= /var/lib/mysql-cluster

[ndbd]
HostName= ndbd_2.mysql.com

[ndbd]
HostName= ndbd_3.mysql.com

[mysqld]
[mysqld]
HostName= mysqld_5.mysql.com
</pre><p>
        Each node has its own section in the
        <code class="filename">config.ini</code> file. For example, this cluster
        has two data nodes, so the preceding configuration file contains
        two <code class="literal">[ndbd]</code> sections defining these nodes.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Do not place comments on the same line as a section heading in
          the <code class="filename">config.ini</code> file; this causes the
          management server not to start because it cannot parse the
          configuration file in such cases.
        </p></div><p><a name="mysql-cluster-config-ini-sections"></a>
        <span class="bold"><strong>Sections of the
        <code class="filename">config.ini</code> File</strong></span>
      </p><p>
        There are six different sections that you can use in the
        <code class="filename">config.ini</code> configuration file, as described
        in the following list:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">[computer]</code>: Defines cluster hosts. This
            is not required to configure a viable MySQL Cluster, but be
            may used as a convenience when setting up a large cluster.
            See <a href="mysql-cluster.html#mysql-cluster-computer-definition" title="17.3.4.3. Defining Computers in a MySQL Cluster">Section 17.3.4.3, “Defining Computers in a MySQL Cluster”</a>, for
            more information.
          </p></li><li><p>
            <code class="literal">[ndbd]</code>: Defines a cluster data node
            (<span><strong class="command">ndbd</strong></span> process). See
            <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="17.3.4.5. Defining MySQL Cluster Data Nodes">Section 17.3.4.5, “Defining MySQL Cluster Data Nodes”</a>, for
            details.
          </p></li><li><p>
            <code class="literal">[mysqld]</code>: Defines the cluster's MySQL
            server nodes (also called SQL or API nodes). For a
            discussion of SQL node configuration, see
            <a href="mysql-cluster.html#mysql-cluster-api-definition" title="17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster">Section 17.3.4.6, “Defining SQL and Other API Nodes in a MySQL Cluster”</a>.
          </p></li><li><p>
            <code class="literal">[mgm]</code> or <code class="literal">[ndb_mgmd]</code>:
            Defines a cluster management server (MGM) node. For
            information concerning the configuration of MGM nodes, see
            <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="17.3.4.4. Defining a MySQL Cluster Management Server">Section 17.3.4.4, “Defining a MySQL Cluster Management Server”</a>.
          </p></li><li><p>
            <code class="literal">[tcp]</code>: Defines a TCP/IP connection
            between cluster nodes, with TCP/IP being the default
            connection protocol. Normally, <code class="literal">[tcp]</code> or
            <code class="literal">[tcp default]</code> sections are not required
            to set up a MySQL Cluster, as the cluster handles this
            automatically; however, it may be necessary in some
            situations to override the defaults provided by the cluster.
            See <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="17.3.4.7. MySQL Cluster TCP/IP Connections">Section 17.3.4.7, “MySQL Cluster TCP/IP Connections”</a>, for
            information about available TCP/IP configuration parameters
            and how to use them. (You may also find
            <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="17.3.4.8. MySQL Cluster TCP/IP Connections Using Direct Connections">Section 17.3.4.8, “MySQL Cluster TCP/IP Connections Using Direct Connections”</a> to be
            of interest in some cases.)
          </p></li><li><p>
            <code class="literal">[shm]</code>: Defines shared-memory connections
            between nodes. In MySQL 5.0, it is enabled by
            default, but should still be considered experimental. For a
            discussion of SHM interconnects, see
            <a href="mysql-cluster.html#mysql-cluster-shm-definition" title="17.3.4.9. MySQL Cluster Shared-Memory Connections">Section 17.3.4.9, “MySQL Cluster Shared-Memory Connections”</a>.
          </p></li><li><p>
            <code class="literal">[sci]</code>:Defines <em class="firstterm">Scalable
            Coherent Interface</em> connections between cluster
            data nodes. Such connections require software which, while
            freely available, is not part of the MySQL Cluster
            distribution, as well as specialised hardware. See
            <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="17.3.4.10. SCI Transport Connections in MySQL Cluster">Section 17.3.4.10, “SCI Transport Connections in MySQL Cluster”</a> for detailed
            information about SCI interconnects.
          </p></li></ul></div><p>
        You can define <code class="literal">default</code> values for each
        section. All Cluster parameter names are case-insensitive, which
        differs from parameters specified in <code class="filename">my.cnf</code>
        or <code class="filename">my.ini</code> files.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-connectstring"></a>17.3.4.2. The MySQL Cluster Connectstring</h4></div></div></div><a class="indexterm" name="id2257676"></a><a class="indexterm" name="id2257689"></a><p>
        With the exception of the MySQL Cluster management server
        (<span><strong class="command">ndb_mgmd</strong></span>), each node that is part of a MySQL
        Cluster requires a <em class="firstterm">connectstring</em> that
        points to the management server's location. This connectstring
        is used in establishing a connection to the management server as
        well as in performing other tasks depending on the node's role
        in the cluster. The syntax for a connectstring is as follows:
      </p><pre class="programlisting">[nodeid=<em class="replaceable"><code>node_id</code></em>, ]<em class="replaceable"><code>host-definition</code></em>[, <em class="replaceable"><code>host-definition</code></em>[, ...]]

<em class="replaceable"><code>host-definition</code></em>:
    <em class="replaceable"><code>host_name</code></em>[:<em class="replaceable"><code>port_number</code></em>]
</pre><p>
        <code class="literal">node_id</code> is an integer larger than 1 which
        identifies a node in <code class="filename">config.ini</code>.
        <em class="replaceable"><code>host_name</code></em> is a string representing a
        valid Internet host name or IP address.
        <em class="replaceable"><code>port_number</code></em> is an integer referring
        to a TCP/IP port number.
      </p><pre class="programlisting">example 1 (long):    "nodeid=2,myhost1:1100,myhost2:1100,192.168.0.3:1200"
example 2 (short):   "myhost1"
</pre><p>
        <code class="literal">localhost:1186</code> is used as the default
        connectstring value if none is provided. If
        <em class="replaceable"><code>port_num</code></em> is omitted from the
        connectstring, the default port is 1186. This port should always
        be available on the network because it has been assigned by IANA
        for this purpose (see
        <a href="http://www.iana.org/assignments/port-numbers" target="_top">http://www.iana.org/assignments/port-numbers</a> for
        details).
      </p><p>
        By listing multiple host definitions, it is possible to
        designate several redundant management servers. A MySQL Cluster
        data or API node attempts to contact successive management
        servers on each host in the order specified, until a successful
        connection has been established.
      </p><p>
        There are a number of different ways to specify the
        connectstring:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Each executable has its own command-line option which
            enables specifying the management server at startup. (See
            the documentation for the respective executable.)
          </p></li><li><p>
            It is also possible to set the connectstring for all nodes
            in the cluster at once by placing it in a
            <code class="literal">[mysql_cluster]</code> section in the management
            server's <code class="filename">my.cnf</code> file.
          </p></li><li><p>
            For backward compatibility, two other options are available,
            using the same syntax:
          </p><div class="orderedlist"><ol type="1"><li><p>
                Set the <code class="envar">NDB_CONNECTSTRING</code> environment
                variable to contain the connectstring.
              </p></li><li><p>
                Write the connectstring for each executable into a text
                file named <code class="filename">Ndb.cfg</code> and place this
                file in the executable's startup directory.
              </p></li></ol></div><p>
            However, these are now deprecated and should not be used for
            new installations.
          </p></li></ul></div><p>
        The recommended method for specifying the connectstring is to
        set it on the command line or in the <code class="filename">my.cnf</code>
        file for each executable.
      </p><p>
        The maximum length of a connectstring is 1024 characters.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-computer-definition"></a>17.3.4.3. Defining Computers in a MySQL Cluster</h4></div></div></div><a class="indexterm" name="id2257905"></a><a class="indexterm" name="id2257918"></a><p>
        The <code class="literal">[computer]</code> section has no real
        significance other than serving as a way to avoid the need of
        defining host names for each node in the system. All parameters
        mentioned here are required.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="ndbparam-computer-id"></a>
            <code class="literal">Id</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This is a unique identifier, used to refer to the host
            computer elsewhere in the configuration file.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              The computer ID is <span class="emphasis"><em>not</em></span> the same as
              the node ID used for a management, API, or data node.
              Unlike the case with node IDs, you cannot use
              <code class="literal">NodeId</code> in place of
              <code class="literal">Id</code> in the <code class="literal">[computer]</code>
              section of the <code class="filename">config.ini</code> file.
            </p></div></li><li><p><a name="ndbparam-computer-hostname"></a>
            <code class="literal">HostName</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This is the computer's hostname or IP address.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-mgm-definition"></a>17.3.4.4. Defining a MySQL Cluster Management Server</h4></div></div></div><a class="indexterm" name="id2258176"></a><a class="indexterm" name="id2258189"></a><p>
        The <code class="literal">[ndb_mgmd]</code> section is used to configure
        the behavior of the management server. <code class="literal">[mgm]</code>
        can be used as an alias; the two section names are equivalent.
        All parameters in the following list are optional and assume
        their default values if omitted.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If neither the <code class="literal">ExecuteOnComputer</code> nor the
          <code class="literal">HostName</code> parameter is present, the default
          value <code class="literal">localhost</code> will be assumed for both.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2258248"></a><p><a name="ndbparam-mgmd-id"></a>
            <code class="literal">Id</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-63</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Each node in the cluster has a unique identity, which is
            represented by an integer value in the range 1 to 63
            inclusive. This ID is used by all internal cluster messages
            for addressing the node.
          </p><p>
            This parameter can also be written as
            <code class="literal">NodeId</code>, although the short form is
            sufficient (and preferred for this reason).
          </p></li><li><a class="indexterm" name="id2258362"></a><p><a name="ndbparam-mgmd-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers defined in a <code class="literal">[computer]</code> section
            of the <code class="filename">config.ini</code> file.
          </p></li><li><a class="indexterm" name="id2258482"></a><p><a name="ndbparam-mgmd-portnumber"></a>
            <code class="literal">PortNumber</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1186</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-64K</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This is the port number on which the management server
            listens for configuration requests and management commands.
          </p></li><li><a class="indexterm" name="id2258587"></a><p><a name="ndbparam-mgmd-hostname"></a>
            <code class="literal">HostName</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Specifying this parameter defines the hostname of the
            computer on which the management node is to reside. To
            specify a hostname other than <code class="literal">localhost</code>,
            either this parameter or
            <code class="literal">ExecuteOnComputer</code> is required.
          </p></li><li><a class="indexterm" name="id2258702"></a><p><a name="ndbparam-mgmd-logdestination"></a>
            <code class="literal">LogDestination</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FILE:filename=ndb_nodeid_cluster.log,maxsize=1000000,maxfiles=6</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies where to send cluster logging
            information. There are three options in this regard —
            <code class="literal">CONSOLE</code>, <code class="literal">SYSLOG</code>, and
            <code class="literal">FILE</code> — with <code class="literal">FILE</code>
            being the default:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">CONSOLE</code> outputs the log to
                <code class="literal">stdout</code>:
              </p><pre class="programlisting">CONSOLE
</pre></li><li><p>
                <code class="literal">SYSLOG</code> sends the log to a
                <code class="literal">syslog</code> facility, possible values
                being one of <code class="literal">auth</code>,
                <code class="literal">authpriv</code>, <code class="literal">cron</code>,
                <code class="literal">daemon</code>, <code class="literal">ftp</code>,
                <code class="literal">kern</code>, <code class="literal">lpr</code>,
                <code class="literal">mail</code>, <code class="literal">news</code>,
                <code class="literal">syslog</code>, <code class="literal">user</code>,
                <code class="literal">uucp</code>, <code class="literal">local0</code>,
                <code class="literal">local1</code>, <code class="literal">local2</code>,
                <code class="literal">local3</code>, <code class="literal">local4</code>,
                <code class="literal">local5</code>, <code class="literal">local6</code>, or
                <code class="literal">local7</code>.
              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  Not every facility is necessarily supported by every
                  operating system.
                </p></div><pre class="programlisting">SYSLOG:facility=syslog
</pre></li><li><p>
                <code class="literal">FILE</code> pipes the cluster log output to
                a regular file on the same machine. The following values
                can be specified:
              </p><div class="itemizedlist"><ul type="square"><li><p>
                    <code class="literal">filename</code>: The name of the log
                    file.
                  </p></li><li><p>
                    <code class="literal">maxsize</code>: The maximum size (in
                    bytes) to which the file can grow before logging
                    rolls over to a new file. When this occurs, the old
                    log file is renamed by appending
                    <em class="replaceable"><code>.N</code></em> to the file name,
                    where <em class="replaceable"><code>N</code></em> is the next
                    number not yet used with this name.
                  </p></li><li><p>
                    <code class="literal">maxfiles</code>: The maximum number of
                    log files.
                  </p></li></ul></div><pre class="programlisting">FILE:filename=cluster.log,maxsize=1000000,maxfiles=6
</pre><p>
                The default value for the <code class="literal">FILE</code>
                parameter is
                <code class="literal">FILE:filename=ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log,maxsize=1000000,maxfiles=6</code>,
                where <em class="replaceable"><code>node_id</code></em> is the ID of
                the node.
              </p></li></ul></div><p>
            It is possible to specify multiple log destinations
            separated by semicolons as shown here:
          </p><pre class="programlisting">CONSOLE;SYSLOG:facility=local0;FILE:filename=/var/log/mgmd
</pre></li><li><a class="indexterm" name="id2259114"></a><p><a name="ndbparam-mgmd-arbitrationrank"></a>
            <code class="literal">ArbitrationRank</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-2</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is used to define which nodes can act as
            arbitrators. Only management nodes and SQL nodes can be
            arbitrators. <code class="literal">ArbitrationRank</code> can take one
            of the following values:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">0</code>: The node will never be used as an
                arbitrator.
              </p></li><li><p>
                <code class="literal">1</code>: The node has high priority; that
                is, it will be preferred as an arbitrator over
                low-priority nodes.
              </p></li><li><p>
                <code class="literal">2</code>: Indicates a low-priority node
                which be used as an arbitrator only if a node with a
                higher priority is not available for that purpose.
              </p></li></ul></div><p>
            Normally, the management server should be configured as an
            arbitrator by setting its <code class="literal">ArbitrationRank</code>
            to 1 (the default value) and that of all SQL nodes to 0.
          </p></li><li><a class="indexterm" name="id2259278"></a><p><a name="ndbparam-mgmd-arbitrationdelay"></a>
            <code class="literal">ArbitrationDelay</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            An integer value which causes the management server's
            responses to arbitration requests to be delayed by that
            number of milliseconds. By default, this value is 0; it is
            normally not necessary to change it.
          </p></li><li><a class="indexterm" name="id2259384"></a><p><a name="ndbparam-mgmd-datadir"></a>
            <code class="literal">DataDir</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">.</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This specifies the directory where output files from the
            management server will be placed. These files include
            cluster log files, process output files, and the daemon's
            process ID (PID) file. (For log files, this location can be
            overridden by setting the <code class="literal">FILE</code> parameter
            for <code class="literal">LogDestination</code> as discussed
            previously in this section.)
          </p><p>
            The default value for this parameter is the directory in
            which <span><strong class="command">ndb_mgmd</strong></span> is located.
          </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          After making changes in a management node's
          configuration, it is necessary to perform a rolling restart of
          the cluster in order for the new configuration to take effect.
        </p><p>
          To add new management servers to a running MySQL Cluster, it
          is also necessary to perform a rolling restart of all cluster
          nodes after modifying any existing
          <code class="filename">config.ini</code> files. For more information
          about issues arising when using multiple management nodes, see
          <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes">Section 17.10.9, “Limitations Relating to Multiple MySQL Cluster Nodes”</a>.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndbd-definition"></a>17.3.4.5. Defining MySQL Cluster Data Nodes</h4></div></div></div><a class="indexterm" name="id2259545"></a><a class="indexterm" name="id2259557"></a><p>
        The <code class="literal">[ndbd]</code> and <code class="literal">[ndbd
        default]</code> sections are used to configure the behavior
        of the cluster's data nodes.
      </p><p>
        There are many parameters which control buffer sizes, pool
        sizes, timeouts, and so forth. The only mandatory parameters
        are:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Either <code class="literal">ExecuteOnComputer</code> or
            <code class="literal">HostName</code>, which must be defined in the
            local <code class="literal">[ndbd]</code> section.
          </p></li><li><p>
            The parameter <code class="literal">NoOfReplicas</code>, which must be
            defined in the<code class="literal">[ndbd default]</code>section, as
            it is common to all Cluster data nodes.
          </p></li></ul></div><p>
        Most data node parameters are set in the <code class="literal">[ndbd
        default]</code> section. Only those parameters explicitly
        stated as being able to set local values are allowed to be
        changed in the <code class="literal">[ndbd]</code> section. Where present,
        <code class="literal">HostName</code>, <code class="literal">Id</code> and
        <code class="literal">ExecuteOnComputer</code> <span class="emphasis"><em>must</em></span>
        be defined in the local <code class="literal">[ndbd]</code> section, and
        not in any other section of <code class="filename">config.ini</code>. In
        other words, settings for these parameters are specific to one
        data node.
      </p><p>
        For those parameters affecting memory usage or buffer sizes, it
        is possible to use <code class="literal">K</code>, <code class="literal">M</code>,
        or <code class="literal">G</code> as a suffix to indicate units of 1024,
        1024×1024, or 1024×1024×1024. (For example,
        <code class="literal">100K</code> means 100 × 1024 = 102400.)
        Parameter names and values are currently case-sensitive.
      </p><p><b>Identifying data nodes. </b>
          The <code class="literal">Id</code> value (that is, the data node
          identifier) can be allocated on the command line when the node
          is started or in the configuration file.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2259743"></a><p><a name="ndbparam-ndbd-id"></a>
            <code class="literal">Id</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-48</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This is the node ID used as the address of the node for all
            cluster internal messages. For data nodes, this is an
            integer in the range 1 to 48 inclusive. Each node in the
            cluster must have a unique identifier.
          </p><p>
            This parameter can also be written as
            <code class="literal">NodeId</code>, although the short form is
            sufficient (and preferred for this reason).
          </p></li><li><a class="indexterm" name="id2259857"></a><p><a name="ndbparam-ndbd-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers defined in a <code class="literal">[computer]</code>
            section.
          </p></li><li><a class="indexterm" name="id2259971"></a><p><a name="ndbparam-ndbd-hostname"></a>
            <code class="literal">HostName</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">localhost</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Specifying this parameter defines the hostname of the
            computer on which the data node is to reside. To specify a
            hostname other than <code class="literal">localhost</code>, either
            this parameter or <code class="literal">ExecuteOnComputer</code> is
            required.
          </p></li><li><a class="indexterm" name="id2260088"></a><p><a name="ndbparam-ndbd-serverport"></a>
            <code class="literal">ServerPort</code>
            (<span class="emphasis"><em>OBSOLETE</em></span>)
          </p><p>
            Each node in the cluster uses a port to connect to other
            nodes. This port is used also for non-TCP transporters in
            the connection setup phase. The default port is allocated
            dynamically in such a way as to ensure that no two nodes on
            the same computer receive the same port number, so it should
            not normally be necessary to specify a value for this
            parameter.
          </p></li><li><a class="indexterm" name="id2260122"></a><p><a name="ndbparam-ndbd-noofreplicas"></a>
            <code class="literal">NoOfReplicas</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">None</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This global parameter can be set only in the <code class="literal">[ndbd
            default]</code> section, and defines the number of
            replicas for each table stored in the cluster. This
            parameter also specifies the size of node groups. A node
            group is a set of nodes all storing the same information.
          </p><p>
            Node groups are formed implicitly. The first node group is
            formed by the set of data nodes with the lowest node IDs,
            the next node group by the set of the next lowest node
            identities, and so on. By way of example, assume that we
            have 4 data nodes and that <code class="literal">NoOfReplicas</code>
            is set to 2. The four data nodes have node IDs 2, 3, 4 and
            5. Then the first node group is formed from nodes 2 and 3,
            and the second node group by nodes 4 and 5. It is important
            to configure the cluster in such a manner that nodes in the
            same node groups are not placed on the same computer because
            a single hardware failure would cause the entire cluster to
            fail.
          </p><p>
            If no node IDs are provided, the order of the data nodes
            will be the determining factor for the node group. Whether
            or not explicit assignments are made, they can be viewed in
            the output of the management client's
            <code class="literal">SHOW</code> command.
          </p><p>
            There is no default value for
            <code class="literal">NoOfReplicas</code>; the recommended value is 2
            for most common usage scenarios.
          </p><p>
            The maximum possible value is 4; <span class="emphasis"><em>currently, only
            the values 1 and 2 are actually supported</em></span> (see
            <a href="http://bugs.mysql.com/18621" target="_top">Bug#18621</a>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              Setting <code class="literal">NoOfReplicas</code> to 1 means that
              there is only a single copy of all Cluster data; in this
              case, the loss of a single data node causes the cluster to
              fail because there are no additional copies of the data
              stored by that node.
            </p></div><p>
            The value for this parameter must divide evenly into the
            number of data nodes in the cluster. For example, if there
            are two data nodes, then <code class="literal">NoOfReplicas</code>
            must be equal to either 1 or 2, since 2/3 and 2/4 both yield
            fractional values; if there are four data nodes, then
            <code class="literal">NoOfReplicas</code> must be equal to 1, 2, or 4.
          </p></li><li><a class="indexterm" name="id2260321"></a><p><a name="ndbparam-ndbd-datadir"></a>
            <code class="literal">DataDir</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">.</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies the directory where trace files,
            log files, pid files and error logs are placed.
          </p><p>
            The default is the data node process working directory.
          </p></li><li><a class="indexterm" name="id2260429"></a><p><a name="ndbparam-ndbd-filesystempath"></a>
            <code class="literal">FileSystemPath</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">DataDir</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies the directory where all files
            created for metadata, REDO logs, UNDO logs, and data files
            are placed. The default is the directory specified by
            <code class="literal">DataDir</code>.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This directory must exist before the
              <span><strong class="command">ndbd</strong></span> process is initiated.
            </p></div><p>
            The recommended directory hierarchy for MySQL Cluster
            includes <code class="filename">/var/lib/mysql-cluster</code>, under
            which a directory for the node's file system is created. The
            name of this subdirectory contains the node ID. For example,
            if the node ID is 2, this subdirectory is named
            <code class="filename">ndb_2_fs</code>.
          </p></li><li><a class="indexterm" name="id2260571"></a><p><a name="ndbparam-ndbd-backupdatadir"></a>
            <code class="literal">BackupDataDir</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FileSystemPath/BACKUP</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies the directory in which backups are
            placed. If omitted, the default backup location is the
            directory named <code class="filename">BACKUP</code> under the
            location specified by the <code class="literal">FileSystemPath</code>
            parameter. (See above.)
          </p></li></ul></div><p><a name="mysql-cluster-data-memory-index-memory-string-memory"></a>
        <span class="bold"><strong>Data Memory, Index Memory, and String
        Memory</strong></span>
      </p><p>
        <code class="literal">DataMemory</code> and <code class="literal">IndexMemory</code>
        are <code class="literal">[ndbd]</code> parameters specifying the size of
        memory segments used to store the actual records and their
        indexes. In setting values for these, it is important to
        understand how <code class="literal">DataMemory</code> and
        <code class="literal">IndexMemory</code> are used, as they usually need to
        be updated to reflect actual usage by the cluster:
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2260738"></a><p><a name="ndbparam-ndbd-datamemory"></a>
            <code class="literal">DataMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">80M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1M-1024G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter defines the amount of space (in bytes)
            available for storing database records. The entire amount
            specified by this value is allocated in memory, so it is
            extremely important that the machine has sufficient physical
            memory to accommodate it.
          </p><p>
            The memory allocated by <code class="literal">DataMemory</code> is
            used to store both the actual records and indexes. Each
            record is currently of fixed size. (Even
            <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a> columns are stored as
            fixed-width columns.) There is a 16-byte overhead on each
            record; an additional amount for each record is incurred
            because it is stored in a 32KB page with 128 byte page
            overhead (see below). There is also a small amount wasted
            per page due to the fact that each record is stored in only
            one page.
          </p><p>
            The maximum record size is currently 8052 bytes.
          </p><p>
            The memory space defined by <code class="literal">DataMemory</code> is
            also used to store ordered indexes, which use about 10 bytes
            per record. Each table row is represented in the ordered
            index. A common error among users is to assume that all
            indexes are stored in the memory allocated by
            <code class="literal">IndexMemory</code>, but this is not the case:
            Only primary key and unique hash indexes use this memory;
            ordered indexes use the memory allocated by
            <code class="literal">DataMemory</code>. However, creating a primary
            key or unique hash index also creates an ordered index on
            the same keys, unless you specify <code class="literal">USING
            HASH</code> in the index creation statement. This can be
            verified by running <span><strong class="command">ndb_desc -d
            <em class="replaceable"><code>db_name</code></em>
            <em class="replaceable"><code>table_name</code></em></strong></span> in the
            management client.
          </p><p>
            The memory space allocated by <code class="literal">DataMemory</code>
            consists of 32KB pages, which are allocated to table
            fragments. Each table is normally partitioned into the same
            number of fragments as there are data nodes in the cluster.
            Thus, for each node, there are the same number of fragments
            as are set in <code class="literal">NoOfReplicas</code>.
          </p><p>
            In addition, due to the way in which new pages are allocated
            when the capacity of the current page is exhausted, there is
            an additional overhead of approximately 18.75%. When more
            <code class="literal">DataMemory</code> is required, more than one new
            page is allocated, according to the following formula:

</p><pre class="programlisting">number of new pages = FLOOR(number of current pages × 0.1875) + 1
</pre><p>

            For example, if 15 pages are currently allocated to a given
            table and an insert to this table requires additional
            storage space, the number of new pages allocated to the
            table is <code class="literal">FLOOR(15 × 0.1875) + 1 =
            FLOOR(2.8125) + 1 = 2 + 1 =
            3</code>. Now 15 + 3 = 18 memory pages are
            allocated to the table. When the last of these 18 pages
            becomes full, <code class="literal">FLOOR(18 × 0.1875) + 1
            = FLOOR(3.3750) + 1 = 3 + 1 =
            4</code> new pages are allocated, so the total number of
            pages allocated to the table is now 22.
          </p><p>
            Once a page has been allocated, it is currently not possible
            to return it to the pool of free pages, except by deleting
            the table. (This also means that
            <code class="literal">DataMemory</code> pages, once allocated to a
            given table, cannot be used by other tables.) Performing a
            node recovery also compresses the partition because all
            records are inserted into empty partitions from other live
            nodes.
          </p><p>
            The <code class="literal">DataMemory</code> memory space also contains
            UNDO information: For each update, a copy of the unaltered
            record is allocated in the <code class="literal">DataMemory</code>.
            There is also a reference to each copy in the ordered table
            indexes. Unique hash indexes are updated only when the
            unique index columns are updated, in which case a new entry
            in the index table is inserted and the old entry is deleted
            upon commit. For this reason, it is also necessary to
            allocate enough memory to handle the largest transactions
            performed by applications using the cluster. In any case,
            performing a few large transactions holds no advantage over
            using many smaller ones, for the following reasons:
          </p><a class="indexterm" name="id2261001"></a><div class="itemizedlist"><ul type="circle"><li><p>
                Large transactions are not any faster than smaller ones
              </p></li><li><p>
                Large transactions increase the number of operations
                that are lost and must be repeated in event of
                transaction failure
              </p></li><li><p>
                Large transactions use more memory
              </p></li></ul></div><p>
            The default value for <code class="literal">DataMemory</code> is 80MB;
            the minimum is 1MB. There is no maximum size, but in reality
            the maximum size has to be adapted so that the process does
            not start swapping when the limit is reached. This limit is
            determined by the amount of physical RAM available on the
            machine and by the amount of memory that the operating
            system may commit to any one process. 32-bit operating
            systems are generally limited to 2–4GB per process;
            64-bit operating systems can use more. For large databases,
            it may be preferable to use a 64-bit operating system for
            this reason.
          </p></li><li><a class="indexterm" name="id2261063"></a><p><a name="ndbparam-ndbd-indexmemory"></a>
            <code class="literal">IndexMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">18M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1M-1T</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter controls the amount of storage used for hash
            indexes in MySQL Cluster. Hash indexes are always used for
            primary key indexes, unique indexes, and unique constraints.
            Note that when defining a primary key and a unique index,
            two indexes will be created, one of which is a hash index
            used for all tuple accesses as well as lock handling. It is
            also used to enforce unique constraints.
          </p><p>
            The size of the hash index is 25 bytes per record, plus the
            size of the primary key. For primary keys larger than 32
            bytes another 8 bytes is added.
          </p><p>
            The default value for <code class="literal">IndexMemory</code> is
            18MB. The minimum is 1MB.
          </p></li><li><a class="indexterm" name="id2261185"></a><p><a name="ndbparam-ndbd-stringmemory"></a>
            <code class="literal">StringMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter determines how much memory is allocated for
            strings such as table names, and is specified in an
            <code class="literal">[ndbd]</code> or <code class="literal">[ndbd
            default]</code> section of the
            <code class="filename">config.ini</code> file. A value between
            <code class="literal">0</code> and <code class="literal">100</code> inclusive is
            interpreted as a percent of the maximum default value, which
            is calculated based on a number of factors including the
            number of tables, maximum table name size, maximum size of
            <code class="filename">.FRM</code> files,
            <code class="literal">MaxNoOfTriggers</code>, maximum column name
            size, and maximum default column value. In general it is
            safe to assume that the maximum default value is
            approximately 5 MB for a MySQL Cluster having 1000 tables.
          </p><p>
            A value greater than <code class="literal">100</code> is interpreted
            as a number of bytes.
          </p><p>
            In MySQL 5.0, the default value is
            <code class="literal">100</code> — that is, 100 percent of the
            default maximum, or roughly 5 MB. It is possible to reduce
            this value safely, but it should never be less than 5
            percent. If you encounter Error 773 <span class="errortext">Out of string
            memory, please modify StringMemory config parameter:
            Permanent error: Schema error</span>, this means that
            means that you have set the <code class="literal">StringMemory</code>
            value too low. <code class="literal">25</code> (25 percent) is not
            excessive, and should prevent this error from recurring in
            all but the most extreme conditions, as when there are
            hundreds or thousands of <code class="literal">NDB</code>
            tables with names whose lengths and columns whose number
            approach their permitted maximums.
          </p></li></ul></div><p>
        The following example illustrates how memory is used for a
        table. Consider this table definition:
      </p><pre class="programlisting">CREATE TABLE example (
  a INT NOT NULL,
  b INT NOT NULL,
  c INT NOT NULL,
  PRIMARY KEY(a),
  UNIQUE(b)
) ENGINE=NDBCLUSTER;
</pre><p>
        For each record, there are 12 bytes of data plus 12 bytes
        overhead. Having no nullable columns saves 4 bytes of overhead.
        In addition, we have two ordered indexes on columns
        <code class="literal">a</code> and <code class="literal">b</code> consuming roughly
        10 bytes each per record. There is a primary key hash index on
        the base table using roughly 29 bytes per record. The unique
        constraint is implemented by a separate table with
        <code class="literal">b</code> as primary key and <code class="literal">a</code> as
        a column. This other table consumes an additional 29 bytes of
        index memory per record in the <code class="literal">example</code> table
        as well 8 bytes of record data plus 12 bytes of overhead.
      </p><p>
        Thus, for one million records, we need 58MB for index memory to
        handle the hash indexes for the primary key and the unique
        constraint. We also need 64MB for the records of the base table
        and the unique index table, plus the two ordered index tables.
      </p><p>
        You can see that hash indexes takes up a fair amount of memory
        space; however, they provide very fast access to the data in
        return. They are also used in MySQL Cluster to handle uniqueness
        constraints.
      </p><p>
        Currently, the only partitioning algorithm is hashing and
        ordered indexes are local to each node. Thus, ordered indexes
        cannot be used to handle uniqueness constraints in the general
        case.
      </p><p>
        An important point for both <code class="literal">IndexMemory</code> and
        <code class="literal">DataMemory</code> is that the total database size is
        the sum of all data memory and all index memory for each node
        group. Each node group is used to store replicated information,
        so if there are four nodes with two replicas, there will be two
        node groups. Thus, the total data memory available is 2 ×
        <code class="literal">DataMemory</code> for each data node.
      </p><p>
        It is highly recommended that <code class="literal">DataMemory</code> and
        <code class="literal">IndexMemory</code> be set to the same values for all
        nodes. Data distribution is even over all nodes in the cluster,
        so the maximum amount of space available for any node can be no
        greater than that of the smallest node in the cluster.
      </p><p>
        <code class="literal">DataMemory</code> and <code class="literal">IndexMemory</code>
        can be changed, but decreasing either of these can be risky;
        doing so can easily lead to a node or even an entire MySQL
        Cluster that is unable to restart due to there being
        insufficient memory space. Increasing these values should be
        acceptable, but it is recommended that such upgrades are
        performed in the same manner as a software upgrade, beginning
        with an update of the configuration file, and then restarting
        the management server followed by restarting each data node in
        turn.
      </p><p>
        Updates do not increase the amount of index memory used. Inserts
        take effect immediately; however, rows are not actually deleted
        until the transaction is committed.
      </p><p><b>Transaction parameters. </b>
          The next three <code class="literal">[ndbd]</code> parameters that we
          discuss are important because they affect the number of
          parallel transactions and the sizes of transactions that can
          be handled by the system.
          <code class="literal">MaxNoOfConcurrentTransactions</code> sets the
          number of parallel transactions possible in a node.
          <code class="literal">MaxNoOfConcurrentOperations</code> sets the number
          of records that can be in update phase or locked
          simultaneously.
        </p><p>
        Both of these parameters (especially
        <code class="literal">MaxNoOfConcurrentOperations</code>) are likely
        targets for users setting specific values and not using the
        default value. The default value is set for systems using small
        transactions, to ensure that these do not use excessive memory.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2261567"></a><p><a name="ndbparam-ndbd-maxnoofconcurrenttransactions"></a>
            <code class="literal">MaxNoOfConcurrentTransactions</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">4096</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Each cluster data node requires a transaction record for
            each active transaction in the cluster. The task of
            coordinating transactions is distributed among all of the
            data nodes. The total number of transaction records in the
            cluster is the number of transactions in any given node
            times the number of nodes in the cluster.
          </p><p>
            Transaction records are allocated to individual MySQL
            servers. Each connection to a MySQL server requires at least
            one transaction record, plus an additional transaction
            object per table accessed by that connection. This means
            that a reasonable minimum for this parameter is

</p><pre class="programlisting">MaxNoOfConcurrentTransactions =
    (maximum number of tables accessed in any single transaction + 1)
    * number of cluster SQL nodes
</pre><p>

            For example, suppose that there are 4 SQL nodes using the
            cluster. A single join involving 5 tables requires 6
            transaction records; if there are 5 such joins in a
            transaction, then 5 * 6 = 30 transaction records are
            required for this transaction, per MySQL server, or 30 * 4 =
            120 transaction records total.
          </p><p>
            This parameter must be set to the same value for all cluster
            data nodes. This is due to the fact that, when a data node
            fails, the oldest surviving node re-creates the transaction
            state of all transactions that were ongoing in the failed
            node.
          </p><p>
            Changing the value of
            <code class="literal">MaxNoOfConcurrentTransactions</code> requires a
            complete shutdown and restart of the cluster.
          </p><p>
            The default value is 4096.
          </p></li><li><a class="indexterm" name="id2261711"></a><p><a name="ndbparam-ndbd-maxnoofconcurrentoperations"></a>
            <code class="literal">MaxNoOfConcurrentOperations</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            It is a good idea to adjust the value of this parameter
            according to the size and number of transactions. When
            performing transactions of only a few operations each and
            not involving a great many records, there is no need to set
            this parameter very high. When performing large transactions
            involving many records need to set this parameter higher.
          </p><p>
            Records are kept for each transaction updating cluster data,
            both in the transaction coordinator and in the nodes where
            the actual updates are performed. These records contain
            state information needed to find UNDO records for rollback,
            lock queues, and other purposes.
          </p><p>
            This parameter should be set to the number of records to be
            updated simultaneously in transactions, divided by the
            number of cluster data nodes. For example, in a cluster
            which has four data nodes and which is expected to handle
            1,000,000 concurrent updates using transactions, you should
            set this value to 1000000 / 4 = 250000.
          </p><p>
            Read queries which set locks also cause operation records to
            be created. Some extra space is allocated within individual
            nodes to accommodate cases where the distribution is not
            perfect over the nodes.
          </p><p>
            When queries make use of the unique hash index, there are
            actually two operation records used per record in the
            transaction. The first record represents the read in the
            index table and the second handles the operation on the base
            table.
          </p><p>
            The default value is 32768.
          </p><p>
            This parameter actually handles two values that can be
            configured separately. The first of these specifies how many
            operation records are to be placed with the transaction
            coordinator. The second part specifies how many operation
            records are to be local to the database.
          </p><p>
            A very large transaction performed on an eight-node cluster
            requires as many operation records in the transaction
            coordinator as there are reads, updates, and deletes
            involved in the transaction. However, the operation records
            of the are spread over all eight nodes. Thus, if it is
            necessary to configure the system for one very large
            transaction, it is a good idea to configure the two parts
            separately. <code class="literal">MaxNoOfConcurrentOperations</code>
            will always be used to calculate the number of operation
            records in the transaction coordinator portion of the node.
          </p><p>
            It is also important to have an idea of the memory
            requirements for operation records. These consume about 1KB
            per record.
          </p></li><li><a class="indexterm" name="id2261872"></a><p><a name="ndbparam-ndbd-maxnooflocaloperations"></a>
            <code class="literal">MaxNoOfLocalOperations</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">UNDEFINED</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            By default, this parameter is calculated as 1.1 ×
            <code class="literal">MaxNoOfConcurrentOperations</code>. This fits
            systems with many simultaneous transactions, none of them
            being very large. If there is a need to handle one very
            large transaction at a time and there are many nodes, it is
            a good idea to override the default value by explicitly
            specifying this parameter.
          </p></li></ul></div><p><b>Transaction temporary storage. </b>
          The next set of <code class="literal">[ndbd]</code> parameters is used
          to determine temporary storage when executing a statement that
          is part of a Cluster transaction. All records are released
          when the statement is completed and the cluster is waiting for
          the commit or rollback.
        </p><p>
        The default values for these parameters are adequate for most
        situations. However, users with a need to support transactions
        involving large numbers of rows or operations may need to
        increase these values to enable better parallelism in the
        system, whereas users whose applications require relatively
        small transactions can decrease the values to save memory.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2262016"></a><p><a name="ndbparam-ndbd-maxnoofconcurrentindexoperations"></a>
            <code class="literal">MaxNoOfConcurrentIndexOperations</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">8K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            For queries using a unique hash index, another temporary set
            of operation records is used during a query's execution
            phase. This parameter sets the size of that pool of records.
            Thus, this record is allocated only while executing a part
            of a query. As soon as this part has been executed, the
            record is released. The state needed to handle aborts and
            commits is handled by the normal operation records, where
            the pool size is set by the parameter
            <code class="literal">MaxNoOfConcurrentOperations</code>.
          </p><p>
            The default value of this parameter is 8192. Only in rare
            cases of extremely high parallelism using unique hash
            indexes should it be necessary to increase this value. Using
            a smaller value is possible and can save memory if the DBA
            is certain that a high degree of parallelism is not required
            for the cluster.
          </p></li><li><a class="indexterm" name="id2262137"></a><p><a name="ndbparam-ndbd-maxnooffiredtriggers"></a>
            <code class="literal">MaxNoOfFiredTriggers</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">4000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The default value of <code class="literal">MaxNoOfFiredTriggers</code>
            is 4000, which is sufficient for most situations. In some
            cases it can even be decreased if the DBA feels certain the
            need for parallelism in the cluster is not high.
          </p><p>
            A record is created when an operation is performed that
            affects a unique hash index. Inserting or deleting a record
            in a table with unique hash indexes or updating a column
            that is part of a unique hash index fires an insert or a
            delete in the index table. The resulting record is used to
            represent this index table operation while waiting for the
            original operation that fired it to complete. This operation
            is short-lived but can still require a large number of
            records in its pool for situations with many parallel write
            operations on a base table containing a set of unique hash
            indexes.
          </p></li><li><a class="indexterm" name="id2262258"></a><p><a name="ndbparam-ndbd-transactionbuffermemory"></a>
            <code class="literal">TransactionBufferMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The memory affected by this parameter is used for tracking
            operations fired when updating index tables and reading
            unique indexes. This memory is used to store the key and
            column information for these operations. It is only very
            rarely that the value for this parameter needs to be altered
            from the default.
          </p><p>
            The default value for
            <code class="literal">TransactionBufferMemory</code> is 1MB.
          </p><p>
            Normal read and write operations use a similar buffer, whose
            usage is even more short-lived. The compile-time parameter
            <code class="literal">ZATTRBUF_FILESIZE</code> (found in
            <code class="filename">ndb/src/kernel/blocks/Dbtc/Dbtc.hpp</code>)
            set to 4000 × 128 bytes (500KB). A similar buffer for
            key information, <code class="literal">ZDATABUF_FILESIZE</code> (also
            in <code class="filename">Dbtc.hpp</code>) contains 4000 × 16 =
            62.5KB of buffer space. <code class="literal">Dbtc</code> is the
            module that handles transaction coordination.
          </p></li></ul></div><p><b>Scans and buffering. </b>
          There are additional <code class="literal">[ndbd]</code> parameters in
          the <code class="literal">Dblqh</code> module (in
          <code class="filename">ndb/src/kernel/blocks/Dblqh/Dblqh.hpp</code>)
          that affect reads and updates. These include
          <code class="literal">ZATTRINBUF_FILESIZE</code>, set by default to
          10000 × 128 bytes (1250KB) and
          <code class="literal">ZDATABUF_FILE_SIZE</code>, set by default to
          10000*16 bytes (roughly 156KB) of buffer space. To date, there
          have been neither any reports from users nor any results from
          our own extensive tests suggesting that either of these
          compile-time limits should be increased.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2262462"></a><p><a name="ndbparam-ndbd-maxnoofconcurrentscans"></a>
            <code class="literal">MaxNoOfConcurrentScans</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">2-500</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is used to control the number of parallel
            scans that can be performed in the cluster. Each transaction
            coordinator can handle the number of parallel scans defined
            for this parameter. Each scan query is performed by scanning
            all partitions in parallel. Each partition scan uses a scan
            record in the node where the partition is located, the
            number of records being the value of this parameter times
            the number of nodes. The cluster should be able to sustain
            <code class="literal">MaxNoOfConcurrentScans</code> scans concurrently
            from all nodes in the cluster.
          </p><p>
            Scans are actually performed in two cases. The first of
            these cases occurs when no hash or ordered indexes exists to
            handle the query, in which case the query is executed by
            performing a full table scan. The second case is encountered
            when there is no hash index to support the query but there
            is an ordered index. Using the ordered index means executing
            a parallel range scan. The order is kept on the local
            partitions only, so it is necessary to perform the index
            scan on all partitions.
          </p><p>
            The default value of
            <code class="literal">MaxNoOfConcurrentScans</code> is 256. The
            maximum value is 500.
          </p></li><li><a class="indexterm" name="id2262595"></a><p><a name="ndbparam-ndbd-maxnooflocalscans"></a>
            <code class="literal">MaxNoOfLocalScans</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">UNDEFINED</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Specifies the number of local scan records if many scans are
            not fully parallelized. If the number of local scan records
            is not provided, it is calculated as the product of
            <code class="literal">MaxNoOfConcurrentScans</code> and the number of
            data nodes in the system. The minimum value is 32.
          </p></li><li><a class="indexterm" name="id2262707"></a><p><a name="ndbparam-ndbd-batchsizeperlocalscan"></a>
            <code class="literal">BatchSizePerLocalScan</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-992</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is used to calculate the number of lock
            records used to handle concurrent scan operations.
          </p><p>
            The default value is 64; this value has a strong connection
            to the <code class="literal">ScanBatchSize</code> defined in the SQL
            nodes.
          </p></li><li><a class="indexterm" name="id2262821"></a><p><a name="ndbparam-ndbd-longmessagebuffer"></a>
            <code class="literal">LongMessageBuffer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">512K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This is an internal buffer used for passing messages within
            individual nodes and between nodes. Although it is highly
            unlikely that this would need to be changed, it is
            configurable. By default, it is set to 1MB.
          </p></li></ul></div><p><a name="mysql-cluster-logging-and-checkpointing"></a>
        <span class="bold"><strong>Logging and checkpointing</strong></span>
      </p><p>
        The following <code class="literal">[ndbd]</code> parameters control log
        and checkpoint behavior.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2262951"></a><p><a name="ndbparam-ndbd-nooffragmentlogfiles"></a>
            <code class="literal">NoOfFragmentLogFiles</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">8</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">3-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter sets the number of REDO log files for the
            node, and thus the amount of space allocated to REDO
            logging. Because the REDO log files are organized in a ring,
            it is extremely important that the first and last log files
            in the set (sometimes referred to as the “<span class="quote">head</span>”
            and “<span class="quote">tail</span>” log files, respectively) do not
            meet. When these approach one another too closely, the node
            begins aborting all transactions encompassing updates due to
            a lack of room for new log records.
          </p><p>
            A <code class="literal">REDO</code> log record is not removed until
            three local checkpoints have been completed since that log
            record was inserted. Checkpointing frequency is determined
            by its own set of configuration parameters discussed
            elsewhere in this chapter.
          </p><p>
            How these parameters interact and proposals for how to
            configure them are discussed in
            <a href="mysql-cluster.html#mysql-cluster-config-lcp-params" title="17.3.6. Configuring MySQL Cluster Parameters for Local Checkpoints">Section 17.3.6, “Configuring MySQL Cluster Parameters for Local Checkpoints”</a>.
          </p><p>
            The default parameter value is 8, which means 8 sets of 4
            16MB files for a total of 512MB. In other words, REDO log
            space is always allocated in blocks of 64MB. In scenarios
            requiring a great many updates, the value for
            <code class="literal">NoOfFragmentLogFiles</code> may need to be set
            as high as 300 or even higher to provide sufficient space
            for REDO logs.
          </p><p>
            If the checkpointing is slow and there are so many writes to
            the database that the log files are full and the log tail
            cannot be cut without jeopardizing recovery, all updating
            transactions are aborted with internal error code 410
            (<code class="literal">Out of log file space temporarily</code>). This
            condition prevails until a checkpoint has completed and the
            log tail can be moved forward.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              This parameter cannot be changed “<span class="quote">on the
              fly</span>”; you must restart the node using
              <code class="option">--initial</code>. If you wish to change this
              value for all data nodes in a running cluster, you can do
              so via a rolling node restart (using
              <code class="option">--initial</code> when starting each data node).
            </p></div></li><li><a class="indexterm" name="id2263133"></a><p><a name="ndbparam-ndbd-maxnoofopenfiles"></a>
            <code class="literal">MaxNoOfOpenFiles</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">40</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">20-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter sets a ceiling on how many internal threads
            to allocate for open files. <span class="emphasis"><em>Any situation
            requiring a change in this parameter should be reported as a
            bug</em></span>.
          </p><p>
            The default value is 40.
          </p></li><li><a class="indexterm" name="id2263252"></a><p><a name="ndbparam-ndbd-maxnoofsavedmessages"></a>
            <code class="literal">MaxNoOfSavedMessages</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">25</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter sets the maximum number of trace files that
            are kept before overwriting old ones. Trace files are
            generated when, for whatever reason, the node crashes.
          </p><p>
            The default is 25 trace files.
          </p></li></ul></div><p><b>Metadata objects. </b>
          The next set of <code class="literal">[ndbd]</code> parameters defines
          pool sizes for metadata objects, used to define the maximum
          number of attributes, tables, indexes, and trigger objects
          used by indexes, events, and replication between clusters.
          Note that these act merely as “<span class="quote">suggestions</span>” to
          the cluster, and any that are not specified revert to the
          default values shown.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2263389"></a><p><a name="ndbparam-ndbd-maxnoofattributes"></a>
            <code class="literal">MaxNoOfAttributes</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Defines the number of attributes that can be defined in the
            cluster.
          </p><p>
            The default value is 1000, with the minimum possible value
            being 32. The maximum is 4294967039. Each attribute consumes
            around 200 bytes of storage per node due to the fact that
            all metadata is fully replicated on the servers.
          </p><p>
            When setting <code class="literal">MaxNoOfAttributes</code>, it is
            important to prepare in advance for any
            <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements that
            you might want to perform in the future. This is due to the
            fact, during the execution of <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER
            TABLE</code></a> on a Cluster table, 3 times the number of
            attributes as in the original table are used, and a good
            practice is to allow double this amount. For example, if the
            MySQL Cluster table having the greatest number of attributes
            (<em class="replaceable"><code>greatest_number_of_attributes</code></em>)
            has 100 attributes, a good starting point for the value of
            <code class="literal">MaxNoOfAttributes</code> would be <code class="literal">6 *
            <em class="replaceable"><code>greatest_number_of_attributes</code></em> =
            600</code>.
          </p><p>
            You should also estimate the average number of attributes
            per table and multiply this by the total number of MySQL
            Cluster tables. If this value is larger than the value
            obtained in the previous paragraph, you should use the
            larger value instead.
          </p><p>
            Assuming that you can create all desired tables without any
            problems, you should also verify that this number is
            sufficient by trying an actual <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER
            TABLE</code></a> after configuring the parameter. If this is
            not successful, increase
            <code class="literal">MaxNoOfAttributes</code> by another multiple of
            <code class="literal">MaxNoOfTables</code> and test it again.
          </p></li><li><a class="indexterm" name="id2263577"></a><p><a name="ndbparam-ndbd-maxnooftables"></a>
            <code class="literal">MaxNoOfTables</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">128</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">8-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            A table object is allocated for each table and for each
            unique hash index in the cluster. This parameter sets the
            maximum number of table objects for the cluster as a whole.
          </p><p>
            For each attribute that has a
            <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> data type an extra table
            is used to store most of the
            <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> data. These tables also
            must be taken into account when defining the total number of
            tables.
          </p><p>
            The default value of this parameter is 128. The minimum is 8
            and the maximum is 1600. Each table object consumes
            approximately 20KB per node.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              The sum of <code class="literal">MaxNoOfTables</code>,
              <code class="literal">MaxNoOfOrderedIndexes</code>, and
              <code class="literal">MaxNoOfUniqueHashIndexes</code> must not
              exceed <code class="literal">2<sup>32</sup> –
              2</code> (4294967294).
            </p></div></li><li><a class="indexterm" name="id2263741"></a><p><a name="ndbparam-ndbd-maxnooforderedindexes"></a>
            <code class="literal">MaxNoOfOrderedIndexes</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">128</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            For each ordered index in the cluster, an object is
            allocated describing what is being indexed and its storage
            segments. By default, each index so defined also defines an
            ordered index. Each unique index and primary key has both an
            ordered index and a hash index.
            <code class="literal">MaxNoOfOrderedIndexes</code> sets the total
            number of hash indexes that can be in use in the system at
            any one time.
          </p><p>
            The default value of this parameter is 128. Each hash index
            object consumes approximately 10KB of data per node.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              The sum of <code class="literal">MaxNoOfTables</code>,
              <code class="literal">MaxNoOfOrderedIndexes</code>, and
              <code class="literal">MaxNoOfUniqueHashIndexes</code> must not
              exceed <code class="literal">2<sup>32</sup> –
              2</code> (4294967294).
            </p></div></li><li><a class="indexterm" name="id2263893"></a><p><a name="ndbparam-ndbd-maxnoofuniquehashindexes"></a>
            <code class="literal">MaxNoOfUniqueHashIndexes</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            For each unique index that is not a primary key, a special
            table is allocated that maps the unique key to the primary
            key of the indexed table. By default, an ordered index is
            also defined for each unique index. To prevent this, you
            must specify the <code class="literal">USING HASH</code> option when
            defining the unique index.
          </p><p>
            The default value is 64. Each index consumes approximately
            15KB per node.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              The sum of <code class="literal">MaxNoOfTables</code>,
              <code class="literal">MaxNoOfOrderedIndexes</code>, and
              <code class="literal">MaxNoOfUniqueHashIndexes</code> must not
              exceed <code class="literal">2<sup>32</sup> –
              2</code> (4294967294).
            </p></div></li><li><a class="indexterm" name="id2264044"></a><p><a name="ndbparam-ndbd-maxnooftriggers"></a>
            <code class="literal">MaxNoOfTriggers</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">768</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Internal update, insert, and delete triggers are allocated
            for each unique hash index. (This means that three triggers
            are created for each unique hash index.) However, an
            <span class="emphasis"><em>ordered</em></span> index requires only a single
            trigger object. Backups also use three trigger objects for
            each normal table in the cluster.
          </p><p>
            This parameter sets the maximum number of trigger objects in
            the cluster.
          </p><p>
            The default value is 768.
          </p></li><li><a class="indexterm" name="id2264162"></a><p><a name="ndbparam-ndbd-maxnoofindexes"></a>
            <code class="literal">MaxNoOfIndexes</code>
          </p><p>
            This parameter is deprecated in MySQL 5.0; you
            should use <code class="literal">MaxNoOfOrderedIndexes</code> and
            <code class="literal">MaxNoOfUniqueHashIndexes</code> instead.
          </p><p>
            This parameter is used only by unique hash indexes. There
            needs to be one record in this pool for each unique hash
            index defined in the cluster.
          </p><p>
            The default value of this parameter is 128.
          </p></li></ul></div><p><b>Boolean parameters. </b>
          The behavior of data nodes is also affected by a set of
          <code class="literal">[ndbd]</code> parameters taking on boolean values.
          These parameters can each be specified as
          <code class="literal">TRUE</code> by setting them equal to
          <code class="literal">1</code> or <code class="literal">Y</code>, and as
          <code class="literal">FALSE</code> by setting them equal to
          <code class="literal">0</code> or <code class="literal">N</code>.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2264269"></a><p><a name="ndbparam-ndbd-lockpagesinmainmemory"></a>
            <code class="literal">LockPagesInMainMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values (&gt;= 5.0.0, &lt;= 5.0.35)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-1</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Permitted Values (&gt;= 5.0.36)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-2</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            For a number of operating systems, including Solaris and
            Linux, it is possible to lock a process into memory and so
            avoid any swapping to disk. This can be used to help
            guarantee the cluster's real-time characteristics.
          </p><p>
            Beginning with MySQL 5.0.36, this parameter takes one of the
            integer values <code class="literal">0</code>, <code class="literal">1</code>,
            or <code class="literal">2</code>, which act as follows:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">0</code>: Disables locking. This is the
                default value.
              </p></li><li><p>
                <code class="literal">1</code>: Performs the lock after allocating
                memory for the process.
              </p></li><li><p>
                <code class="literal">2</code>: Performs the lock before memory
                for the process is allocated.
              </p></li></ul></div><p>
            Previously, this parameter was a Boolean.
            <code class="literal">0</code> or <code class="literal">false</code> was the
            default setting, and disabled locking. <code class="literal">1</code>
            or <code class="literal">true</code> enabled locking of the process
            after its memory was allocated.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              Beginning with MySQL 5.0.36, it is no longer possible to
              use <code class="literal">true</code> or <code class="literal">false</code>
              for the value of this parameter; when upgrading from a
              previous version, you must change the value to
              <code class="literal">0</code>, <code class="literal">1</code>, or
              <code class="literal">2</code>.
            </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              To make use of this parameter, the data node process must
              be run as system root.
            </p></div></li><li><a class="indexterm" name="id2264558"></a><p><a name="ndbparam-ndbd-stoponerror"></a>
            <code class="literal">StopOnError</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">true</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies whether an <span><strong class="command">ndbd</strong></span>
            process should exit or perform an automatic restart when an
            error condition is encountered.
          </p><p>
            This feature is enabled by default.
          </p></li><li><a class="indexterm" name="id2264673"></a><p><a name="ndbparam-ndbd-diskless"></a>
            <code class="literal">Diskless</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-1</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            It is possible to specify MySQL Cluster tables as
            <em class="firstterm">diskless</em>, meaning that tables are not
            checkpointed to disk and that no logging occurs. Such tables
            exist only in main memory. A consequence of using diskless
            tables is that neither the tables nor the records in those
            tables survive a crash. However, when operating in diskless
            mode, it is possible to run <span><strong class="command">ndbd</strong></span> on a
            diskless computer.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              This feature causes the <span class="emphasis"><em>entire</em></span>
              cluster to operate in diskless mode.
            </p></div><p>
            When this feature is enabled, Cluster online backup is
            disabled. In addition, a partial start of the cluster is not
            possible.
          </p><p>
            <code class="literal">Diskless</code> is disabled by default.
          </p></li><li><a class="indexterm" name="id2264814"></a><p><a name="ndbparam-ndbd-restartonerrorinsert"></a>
            <code class="literal">RestartOnErrorInsert</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">2</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This feature is accessible only when building the debug
            version where it is possible to insert errors in the
            execution of individual blocks of code as part of testing.
          </p><p>
            This feature is disabled by default.
          </p></li></ul></div><p><a name="mysql-cluster-timeouts-intervals-disk-paging"></a>
        <span class="bold"><strong>Controlling Timeouts, Intervals, and Disk
        Paging</strong></span>
      </p><p>
        There are a number of <code class="literal">[ndbd]</code> parameters
        specifying timeouts and intervals between various actions in
        Cluster data nodes. Most of the timeout values are specified in
        milliseconds. Any exceptions to this are mentioned where
        applicable.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2264949"></a><p><a name="ndbparam-ndbd-timebetweenwatchdogcheck"></a>
            <code class="literal">TimeBetweenWatchDogCheck</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">6000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">70-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            To prevent the main thread from getting stuck in an endless
            loop at some point, a “<span class="quote">watchdog</span>” thread checks
            the main thread. This parameter specifies the number of
            milliseconds between checks. If the process remains in the
            same state after three checks, the watchdog thread
            terminates it.
          </p><p>
            This parameter can easily be changed for purposes of
            experimentation or to adapt to local conditions. It can be
            specified on a per-node basis although there seems to be
            little reason for doing so.
          </p><p>
            The default timeout is 4000 milliseconds (4 seconds).
          </p></li><li><a class="indexterm" name="id2265069"></a><p><a name="ndbparam-ndbd-startpartialtimeout"></a>
            <code class="literal">StartPartialTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">30000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies how long the Cluster waits for all
            data nodes to come up before the cluster initialization
            routine is invoked. This timeout is used to avoid a partial
            Cluster startup whenever possible.
          </p><p>
            This parameter is overridden when performing an initial
            start or initial restart of the cluster.
          </p><p>
            The default value is 30000 milliseconds (30 seconds). 0
            disables the timeout, in which case the cluster may start
            only if all nodes are available.
          </p></li><li><a class="indexterm" name="id2265184"></a><p><a name="ndbparam-ndbd-startpartitionedtimeout"></a>
            <code class="literal">StartPartitionedTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">60000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            If the cluster is ready to start after waiting for
            <code class="literal">StartPartialTimeout</code> milliseconds but is
            still possibly in a partitioned state, the cluster waits
            until this timeout has also passed.
          </p><p>
            This parameter is overridden when performing an initial
            start or initial restart of the cluster.
          </p><p>
            The default timeout is 60000 milliseconds (60 seconds).
          </p></li><li><a class="indexterm" name="id2265303"></a><p><a name="ndbparam-ndbd-startfailuretimeout"></a>
            <code class="literal">StartFailureTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            If a data node has not completed its startup sequence within
            the time specified by this parameter, the node startup
            fails. Setting this parameter to 0 (the default value) means
            that no data node timeout is applied.
          </p><p>
            For nonzero values, this parameter is measured in
            milliseconds. For data nodes containing extremely large
            amounts of data, this parameter should be increased. For
            example, in the case of a data node containing several
            gigabytes of data, a period as long as 10–15 minutes
            (that is, 600000 to 1000000 milliseconds) might be required
            to perform a node restart.
          </p></li><li><a class="indexterm" name="id2265419"></a><p><a name="ndbparam-ndbd-heartbeatintervaldbdb"></a>
            <code class="literal">HeartbeatIntervalDbDb</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1500</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">10-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            One of the primary methods of discovering failed nodes is by
            the use of heartbeats. This parameter states how often
            heartbeat signals are sent and how often to expect to
            receive them. After missing three heartbeat intervals in a
            row, the node is declared dead. Thus, the maximum time for
            discovering a failure through the heartbeat mechanism is
            four times the heartbeat interval.
          </p><p>
            The default heartbeat interval is 1500 milliseconds (1.5
            seconds). This parameter must not be changed drastically and
            should not vary widely between nodes. If one node uses 5000
            milliseconds and the node watching it uses 1000
            milliseconds, obviously the node will be declared dead very
            quickly. This parameter can be changed during an online
            software upgrade, but only in small increments.
          </p></li><li><a class="indexterm" name="id2265534"></a><p><a name="ndbparam-ndbd-heartbeatintervaldbapi"></a>
            <code class="literal">HeartbeatIntervalDbApi</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1500</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">100-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Each data node sends heartbeat signals to each MySQL server
            (SQL node) to ensure that it remains in contact. If a MySQL
            server fails to send a heartbeat in time it is declared
            “<span class="quote">dead,</span>” in which case all ongoing transactions
            are completed and all resources released. The SQL node
            cannot reconnect until all activities initiated by the
            previous MySQL instance have been completed. The
            three-heartbeat criteria for this determination are the same
            as described for <code class="literal">HeartbeatIntervalDbDb</code>.
          </p><p>
            The default interval is 1500 milliseconds (1.5 seconds).
            This interval can vary between individual data nodes because
            each data node watches the MySQL servers connected to it,
            independently of all other data nodes.
          </p></li><li><a class="indexterm" name="id2265657"></a><p><a name="ndbparam-ndbd-timebetweenlocalcheckpoints"></a>
            <code class="literal">TimeBetweenLocalCheckpoints</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">20</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-31</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is an exception in that it does not specify a
            time to wait before starting a new local checkpoint; rather,
            it is used to ensure that local checkpoints are not
            performed in a cluster where relatively few updates are
            taking place. In most clusters with high update rates, it is
            likely that a new local checkpoint is started immediately
            after the previous one has been completed.
          </p><p>
            The size of all write operations executed since the start of
            the previous local checkpoints is added. This parameter is
            also exceptional in that it is specified as the base-2
            logarithm of the number of 4-byte words, so that the default
            value 20 means 4MB (4 ×
            2<sup>20</sup>) of write operations, 21
            would mean 8MB, and so on up to a maximum value of 31, which
            equates to 8GB of write operations.
          </p><p>
            All the write operations in the cluster are added together.
            Setting <code class="literal">TimeBetweenLocalCheckpoints</code> to 6
            or less means that local checkpoints will be executed
            continuously without pause, independent of the cluster's
            workload.
          </p></li><li><a class="indexterm" name="id2265790"></a><p><a name="ndbparam-ndbd-timebetweenglobalcheckpoints"></a>
            <code class="literal">TimeBetweenGlobalCheckpoints</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">2000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">10-32000</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When a transaction is committed, it is committed in main
            memory in all nodes on which the data is mirrored. However,
            transaction log records are not flushed to disk as part of
            the commit. The reasoning behind this behavior is that
            having the transaction safely committed on at least two
            autonomous host machines should meet reasonable standards
            for durability.
          </p><p>
            It is also important to ensure that even the worst of cases
            — a complete crash of the cluster — is handled
            properly. To guarantee that this happens, all transactions
            taking place within a given interval are put into a global
            checkpoint, which can be thought of as a set of committed
            transactions that has been flushed to disk. In other words,
            as part of the commit process, a transaction is placed in a
            global checkpoint group. Later, this group's log records are
            flushed to disk, and then the entire group of transactions
            is safely committed to disk on all computers in the cluster.
          </p><p>
            This parameter defines the interval between global
            checkpoints. The default is 2000 milliseconds.
          </p></li><li><a class="indexterm" name="id2265912"></a><p><a name="ndbparam-ndbd-timebetweeninactivetransactionabortcheck"></a>
            <code class="literal">TimeBetweenInactiveTransactionAbortCheck</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1000-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Timeout handling is performed by checking a timer on each
            transaction once for every interval specified by this
            parameter. Thus, if this parameter is set to 1000
            milliseconds, every transaction will be checked for timing
            out once per second.
          </p><p>
            The default value is 1000 milliseconds (1 second).
          </p></li><li><a class="indexterm" name="id2266022"></a><p><a name="ndbparam-ndbd-transactioninactivetimeout"></a>
            <code class="literal">TransactionInactiveTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">4G</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter states the maximum time that is permitted to
            lapse between operations in the same transaction before the
            transaction is aborted.
          </p><p>
            The default for this parameter is zero (no timeout). For a
            real-time database that needs to ensure that no transaction
            keeps locks for too long, this parameter should be set to a
            relatively small value. The unit is milliseconds.
          </p></li><li><a class="indexterm" name="id2266134"></a><p><a name="ndbparam-ndbd-transactiondeadlockdetectiontimeout"></a>
            <code class="literal">TransactionDeadlockDetectionTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1200</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">50-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When a node executes a query involving a transaction, the
            node waits for the other nodes in the cluster to respond
            before continuing. A failure to respond can occur for any of
            the following reasons:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                The node is “<span class="quote">dead</span>”
              </p></li><li><p>
                The operation has entered a lock queue
              </p></li><li><p>
                The node requested to perform the action could be
                heavily overloaded.
              </p></li></ul></div><p>
            This timeout parameter states how long the transaction
            coordinator waits for query execution by another node before
            aborting the transaction, and is important for both node
            failure handling and deadlock detection. In MySQL 5.0.20 and
            earlier versions, setting it too high could cause
            undesirable behavior in situations involving deadlocks and
            node failure. Beginning with MySQL 5.0.21, active
            transactions occurring during node failures are actively
            aborted by the MySQL Cluster Transaction Coordinator, and so
            high settings are no longer an issue with this parameter.
          </p><p>
            The default timeout value is 1200 milliseconds (1.2
            seconds). The effective minimum value is 100 milliseconds;
            it is possible to set it as low as 50 milliseconds, but any
            such value is treated as 100 ms. (<a href="http://bugs.mysql.com/44099" target="_top">Bug#44099</a>)
          </p></li><li><a class="indexterm" name="id2266294"></a><p><a name="ndbparam-ndbd-noofdiskpagestodiskafterrestarttup"></a>
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">40</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When executing a local checkpoint, the algorithm flushes all
            data pages to disk. Merely doing so as quickly as possible
            without any moderation is likely to impose excessive loads
            on processors, networks, and disks. To control the write
            speed, this parameter specifies how many pages per 100
            milliseconds are to be written. In this context, a
            “<span class="quote">page</span>” is defined as 8KB. This parameter is
            specified in units of 80KB per second, so setting
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> to a
            value of <code class="literal">20</code> entails writing 1.6MB in data
            pages to disk each second during a local checkpoint. This
            value includes the writing of UNDO log records for data
            pages. That is, this parameter handles the limitation of
            writes from data memory. UNDO log records for index pages
            are handled by the parameter
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>. (See
            the entry for <code class="literal">IndexMemory</code> for information
            about index pages.)
          </p><p>
            In short, this parameter specifies how quickly to execute
            local checkpoints. It operates in conjunction with
            <code class="literal">NoOfFragmentLogFiles</code>,
            <code class="literal">DataMemory</code>, and
            <code class="literal">IndexMemory</code>.
          </p><p>
            For more information about the interaction between these
            parameters and possible strategies for choosing appropriate
            values for them, see
            <a href="mysql-cluster.html#mysql-cluster-config-lcp-params" title="17.3.6. Configuring MySQL Cluster Parameters for Local Checkpoints">Section 17.3.6, “Configuring MySQL Cluster Parameters for Local Checkpoints”</a>.
          </p><p>
            The default value is 40 (3.2MB of data pages per second).
          </p></li><li><a class="indexterm" name="id2266470"></a><p><a name="ndbparam-ndbd-noofdiskpagestodiskafterrestartacc"></a>
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">20</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter uses the same units as
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            acts in a similar fashion, but limits the speed of writing
            index pages from index memory.
          </p><p>
            The default value of this parameter is 20 (1.6MB of index
            memory pages per second).
          </p></li><li><a class="indexterm" name="id2266585"></a><p><a name="ndbparam-ndbd-noofdiskpagestodiskduringrestarttup"></a>
            <code class="literal">NoOfDiskPagesToDiskDuringRestartTUP</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">40</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is used in a fashion similar to
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>, only
            it does so with regard to local checkpoints executed in the
            node when a node is restarting. A local checkpoint is always
            performed as part of all node restarts. During a node
            restart it is possible to write to disk at a higher speed
            than at other times, because fewer activities are being
            performed in the node.
          </p><p>
            This parameter covers pages written from data memory.
          </p><p>
            The default value is 40 (3.2MB per second).
          </p></li><li><a class="indexterm" name="id2266712"></a><p><a name="ndbparam-ndbd-noofdiskpagestodiskduringrestartacc"></a>
            <code class="literal">NoOfDiskPagesToDiskDuringRestartACC</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">20</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Controls the number of index memory pages that can be
            written to disk during the local checkpoint phase of a node
            restart.
          </p><p>
            As with
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>,
            values for this parameter are expressed in terms of 8KB
            pages written per 100 milliseconds (80KB/second).
          </p><p>
            The default value is 20 (1.6MB per second).
          </p></li><li><a class="indexterm" name="id2266838"></a><p><a name="ndbparam-ndbd-arbitrationtimeout"></a>
            <code class="literal">ArbitrationTimeout</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1000</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">10-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies how long data nodes wait for a
            response from the arbitrator to an arbitration message. If
            this is exceeded, the network is assumed to have split.
          </p><p>
            The default value is 1000 milliseconds (1 second).
          </p></li></ul></div><p><b>Buffering and logging. </b>
          Several <code class="literal">[ndbd]</code> configuration parameters
          corresponding to former compile-time parameters were
          introduced in MySQL 4.1.5. These enable the advanced user to
          have more control over the resources used by node processes
          and to adjust various buffer sizes at need.
        </p><p>
        These buffers are used as front ends to the file system when
        writing log records to disk. If the node is running in diskless
        mode, these parameters can be set to their minimum values
        without penalty due to the fact that disk writes are
        “<span class="quote">faked</span>” by the <code class="literal">NDB</code>
        storage engine's file system abstraction layer.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2266989"></a><p><a name="ndbparam-ndbd-undoindexbuffer"></a>
            <code class="literal">UndoIndexBuffer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">2M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1M-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The UNDO index buffer, whose size is set by this parameter,
            is used during local checkpoints. The
            <code class="literal">NDB</code> storage engine uses a
            recovery scheme based on checkpoint consistency in
            conjunction with an operational REDO log. To produce a
            consistent checkpoint without blocking the entire system for
            writes, UNDO logging is done while performing the local
            checkpoint. UNDO logging is activated on a single table
            fragment at a time. This optimization is possible because
            tables are stored entirely in main memory.
          </p><p>
            The UNDO index buffer is used for the updates on the primary
            key hash index. Inserts and deletes rearrange the hash
            index; the NDB storage engine writes UNDO log records that
            map all physical changes to an index page so that they can
            be undone at system restart. It also logs all active insert
            operations for each fragment at the start of a local
            checkpoint.
          </p><p>
            Reads and updates set lock bits and update a header in the
            hash index entry. These changes are handled by the
            page-writing algorithm to ensure that these operations need
            no UNDO logging.
          </p><p>
            This buffer is 2MB by default. The minimum value is 1MB,
            which is sufficient for most applications. For applications
            doing extremely large or numerous inserts and deletes
            together with large transactions and large primary keys, it
            may be necessary to increase the size of this buffer. If
            this buffer is too small, the NDB storage engine issues
            internal error code 677 (<code class="literal">Index UNDO buffers
            overloaded</code>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li><li><a class="indexterm" name="id2267138"></a><p><a name="ndbparam-ndbd-undodatabuffer"></a>
            <code class="literal">UndoDataBuffer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">16M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1M-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter sets the size of the UNDO data buffer, which
            performs a function similar to that of the UNDO index
            buffer, except the UNDO data buffer is used with regard to
            data memory rather than index memory. This buffer is used
            during the local checkpoint phase of a fragment for inserts,
            deletes, and updates.
          </p><p>
            Because UNDO log entries tend to grow larger as more
            operations are logged, this buffer is also larger than its
            index memory counterpart, with a default value of 16MB.
          </p><p>
            This amount of memory may be unnecessarily large for some
            applications. In such cases, it is possible to decrease this
            size to a minimum of 1MB.
          </p><p>
            It is rarely necessary to increase the size of this buffer.
            If there is such a need, it is a good idea to check whether
            the disks can actually handle the load caused by database
            update activity. A lack of sufficient disk space cannot be
            overcome by increasing the size of this buffer.
          </p><p>
            If this buffer is too small and gets congested, the NDB
            storage engine issues internal error code 891
            (<span class="errortext">Data UNDO buffers overloaded</span>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li><li><a class="indexterm" name="id2267277"></a><p><a name="ndbparam-ndbd-redobuffer"></a>
            <code class="literal">RedoBuffer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">8M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1M-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            All update activities also need to be logged. The REDO log
            makes it possible to replay these updates whenever the
            system is restarted. The NDB recovery algorithm uses a
            “<span class="quote">fuzzy</span>” checkpoint of the data together with
            the UNDO log, and then applies the REDO log to play back all
            changes up to the restoration point.
          </p><p>
            <code class="literal">RedoBuffer</code> sets the size of the buffer in
            which the REDO log is written, and is 8MB by default. The
            minimum value is 1MB.
          </p><p>
            If this buffer is too small, the NDB storage engine issues
            error code 1221 (<code class="literal">REDO log buffers
            overloaded</code>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li></ul></div><p><b>Controlling log messages. </b>
          In managing the cluster, it is very important to be able to
          control the number of log messages sent for various event
          types to <code class="literal">stdout</code>. For each event category,
          there are 16 possible event levels (numbered 0 through 15).
          Setting event reporting for a given event category to level 15
          means all event reports in that category are sent to
          <code class="literal">stdout</code>; setting it to 0 means that there
          will be no event reports made in that category.
        </p><p>
        By default, only the startup message is sent to
        <code class="literal">stdout</code>, with the remaining event reporting
        level defaults being set to 0. The reason for this is that these
        messages are also sent to the management server's cluster log.
      </p><p>
        An analogous set of levels can be set for the management client
        to determine which event levels to record in the cluster log.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2267463"></a><p><a name="ndbparam-ndbd-loglevelstartup"></a>
            <code class="literal">LogLevelStartup</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated during startup of
            the process.
          </p><p>
            The default level is 1.
          </p></li><li><a class="indexterm" name="id2267570"></a><p><a name="ndbparam-ndbd-loglevelshutdown"></a>
            <code class="literal">LogLevelShutdown</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated as part of graceful
            shutdown of a node.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2267678"></a><p><a name="ndbparam-ndbd-loglevelstatistic"></a>
            <code class="literal">LogLevelStatistic</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for statistical events such as number of
            primary key reads, number of updates, number of inserts,
            information relating to buffer usage, and so on.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2267787"></a><p><a name="ndbparam-ndbd-loglevelcheckpoint"></a>
            <code class="literal">LogLevelCheckpoint</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated by local and global
            checkpoints.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2267895"></a><p><a name="ndbparam-ndbd-loglevelnoderestart"></a>
            <code class="literal">LogLevelNodeRestart</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated during node
            restart.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2268003"></a><p><a name="ndbparam-ndbd-loglevelconnection"></a>
            <code class="literal">LogLevelConnection</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated by connections
            between cluster nodes.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2268111"></a><p><a name="ndbparam-ndbd-loglevelerror"></a>
            <code class="literal">LogLevelError</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated by errors and
            warnings by the cluster as a whole. These errors do not
            cause any node failure but are still considered worth
            reporting.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2268220"></a><p><a name="ndbparam-ndbd-loglevelcongestion"></a>
            <code class="literal">LogLevelCongestion</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.0</td></tr><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values (&gt;= 5.0.0)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated by congestion.
            These errors do not cause node failure but are still
            considered worth reporting.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2268338"></a><p><a name="ndbparam-ndbd-loglevelinfo"></a>
            <code class="literal">LogLevelInfo</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-15</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The reporting level for events generated for information
            about the general state of the cluster.
          </p><p>
            The default level is 0.
          </p></li></ul></div><p><b>Backup parameters. </b>
          The <code class="literal">[ndbd]</code> parameters discussed in this
          section define memory buffers set aside for execution of
          online backups.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2268468"></a><p><a name="ndbparam-ndbd-backupdatabuffersize"></a>
            <code class="literal">BackupDataBufferSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">2M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            In creating a backup, there are two buffers used for sending
            data to the disk. The backup data buffer is used to fill in
            data recorded by scanning a node's tables. Once this buffer
            has been filled to the level specified as
            <code class="literal">BackupWriteSize</code> (see below), the pages
            are sent to disk. While flushing data to disk, the backup
            process can continue filling this buffer until it runs out
            of space. When this happens, the backup process pauses the
            scan and waits until some disk writes have completed freed
            up memory so that scanning may continue.
          </p><p>
            The default value is 2MB.
          </p></li><li><a class="indexterm" name="id2268587"></a><p><a name="ndbparam-ndbd-backuplogbuffersize"></a>
            <code class="literal">BackupLogBufferSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">2M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The backup log buffer fulfills a role similar to that played
            by the backup data buffer, except that it is used for
            generating a log of all table writes made during execution
            of the backup. The same principles apply for writing these
            pages as with the backup data buffer, except that when there
            is no more space in the backup log buffer, the backup fails.
            For that reason, the size of the backup log buffer must be
            large enough to handle the load caused by write activities
            while the backup is being made. See
            <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="17.7.3.3. Configuration for MySQL Cluster Backups">Section 17.7.3.3, “Configuration for MySQL Cluster Backups”</a>.
          </p><p>
            The default value for this parameter should be sufficient
            for most applications. In fact, it is more likely for a
            backup failure to be caused by insufficient disk write speed
            than it is for the backup log buffer to become full. If the
            disk subsystem is not configured for the write load caused
            by applications, the cluster is unlikely to be able to
            perform the desired operations.
          </p><p>
            It is preferable to configure cluster nodes in such a manner
            that the processor becomes the bottleneck rather than the
            disks or the network connections.
          </p><p>
            The default value is 2MB.
          </p></li><li><a class="indexterm" name="id2268716"></a><p><a name="ndbparam-ndbd-backupmemory"></a>
            <code class="literal">BackupMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">4M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is simply the sum of
            <code class="literal">BackupDataBufferSize</code> and
            <code class="literal">BackupLogBufferSize</code>.
          </p><p>
            The default value is 2MB + 2MB = 4MB.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              If <code class="literal">BackupDataBufferSize</code> and
              <code class="literal">BackupLogBufferSize</code> taken together
              exceed 4MB, then this parameter must be set explicitly in
              the <code class="filename">config.ini</code> file to their sum.
            </p></div></li><li><a class="indexterm" name="id2268861"></a><p><a name="ndbparam-ndbd-backupwritesize"></a>
            <code class="literal">BackupWriteSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">2K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies the default size of messages
            written to disk by the backup log and backup data buffers.
          </p><p>
            The default value is 32KB.
          </p></li><li><a class="indexterm" name="id2268969"></a><p><a name="ndbparam-ndbd-backupmaxwritesize"></a>
            <code class="literal">BackupMaxWriteSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">2K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter specifies the maximum size of messages
            written to disk by the backup log and backup data buffers.
          </p><p>
            The default value is 256KB.
          </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          When specifying these parameters, the following relationships
          must hold true. Otherwise, the data node will be unable to
          start.
        </p></div><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">BackupDataBufferSize &gt;= BackupWriteSize +
            188KB</code>
          </p></li><li><p>
            <code class="literal">BackupLogBufferSize &gt;= BackupWriteSize +
            16KB</code>
          </p></li><li><p>
            <code class="literal">BackupMaxWriteSize &gt;= BackupWriteSize</code>
          </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          To add new data nodes to a MySQL Cluster, it is necessary to
          shut down the cluster completely, update the
          <code class="filename">config.ini</code> file, and then restart the
          cluster (that is, you must perform a system restart). All data
          node processes must be started with the
          <code class="option">--initial</code> option.
        </p><p>
          We are working to make it possible to add new data node groups
          to a running cluster online in a future release; however, we
          do not plan to implement this change in MySQL
          5.0.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-api-definition"></a>17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster</h4></div></div></div><a class="indexterm" name="id2269160"></a><a class="indexterm" name="id2269172"></a><a class="indexterm" name="id2269185"></a><p>
        The <code class="literal">[mysqld]</code> and <code class="literal">[api]</code>
        sections in the <code class="filename">config.ini</code> file define the
        behavior of the MySQL servers (SQL nodes) and other applications
        (API nodes) used to access cluster data. None of the parameters
        shown is required. If no computer or host name is provided, any
        host can use this SQL or API node.
      </p><p>
        Generally speaking, a <code class="literal">[mysqld]</code> section is
        used to indicate a MySQL server providing an SQL interface to
        the cluster, and an <code class="literal">[api]</code> section is used for
        applications other than <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> processes
        accessing cluster data, but the two designations are actually
        synonomous; you can, for instance, list parameters for a MySQL
        server acting as an SQL node in an <code class="literal">[api]</code>
        section.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For a discussion of MySQL server options for MySQL Cluster,
          see <a href="mysql-cluster.html#mysql-cluster-program-options-mysqld" title="17.4.2. mysqld Command Options for MySQL Cluster">Section 17.4.2, “<span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster”</a>;
          for information about MySQL server system variables relating
          to MySQL Cluster, see
          <a href="mysql-cluster.html#mysql-cluster-system-variables" title="17.4.3. MySQL Cluster System Variables">Section 17.4.3, “MySQL Cluster System Variables”</a>.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2269274"></a><p><a name="ndbparam-api-id"></a>
            <code class="literal">Id</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-63</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The <code class="literal">Id</code> is an integer value used to
            identify the node in all cluster internal messages. It must
            be an integer in the range 1 to 63 inclusive, and must be
            unique among all node IDs within the cluster.
          </p><p>
            This parameter can also be written as
            <code class="literal">NodeId</code>, although the short form is
            sufficient (and preferred for this reason).
          </p></li><li><a class="indexterm" name="id2269394"></a><p><a name="ndbparam-api-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>system</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers (hosts) defined in a <code class="literal">[computer]</code>
            section of the configuration file.
          </p></li><li><a class="indexterm" name="id2269508"></a><p><a name="ndbparam-api-hostname"></a>
            <code class="literal">HostName</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>initial, node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Specifying this parameter defines the hostname of the
            computer on which the SQL node (API node) is to reside. To
            specify a hostname, either this parameter or
            <code class="literal">ExecuteOnComputer</code> is required.
          </p><p>
            If no <code class="literal">HostName</code> or
            <code class="literal">ExecuteOnComputer</code> is specified in a given
            <code class="literal">[mysql]</code> or <code class="literal">[api]</code>
            section of the <code class="filename">config.ini</code> file, then an
            SQL or API node may connect using the corresponding
            “<span class="quote">slot</span>” from any host which can establish a
            network connection to the management server host machine.
            <span class="emphasis"><em>This differs from the default behavior for data
            nodes, where <code class="literal">localhost</code> is assumed for
            <code class="literal">HostName</code> unless otherwise
            specified</em></span>.
          </p></li><li><a class="indexterm" name="id2269673"></a><p><a name="ndbparam-api-arbitrationrank"></a>
            <code class="literal">ArbitrationRank</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-2</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter defines which nodes can act as arbitrators.
            Both MGM nodes and SQL nodes can be arbitrators. A value of
            0 means that the given node is never used as an arbitrator,
            a value of 1 gives the node high priority as an arbitrator,
            and a value of 2 gives it low priority. A normal
            configuration uses the management server as arbitrator,
            setting its <code class="literal">ArbitrationRank</code> to 1 (the
            default) and those for all SQL nodes to 0.
          </p></li><li><a class="indexterm" name="id2269786"></a><p><a name="ndbparam-api-arbitrationdelay"></a>
            <code class="literal">ArbitrationDelay</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Setting this parameter to any other value than 0 (the
            default) means that responses by the arbitrator to
            arbitration requests will be delayed by the stated number of
            milliseconds. It is usually not necessary to change this
            value.
          </p></li><li><a class="indexterm" name="id2269892"></a><p><a name="ndbparam-api-batchbytesize"></a>
            <code class="literal">BatchByteSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1024-1M</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            For queries that are translated into full table scans or
            range scans on indexes, it is important for best performance
            to fetch records in properly sized batches. It is possible
            to set the proper size both in terms of number of records
            (<code class="literal">BatchSize</code>) and in terms of bytes
            (<code class="literal">BatchByteSize</code>). The actual batch size is
            limited by both parameters.
          </p><p>
            The speed at which queries are performed can vary by more
            than 40% depending upon how this parameter is set. In future
            releases, MySQL Server will make educated guesses on how to
            set parameters relating to batch size, based on the query
            type.
          </p><p>
            This parameter is measured in bytes and by default is equal
            to 32KB.
          </p></li><li><a class="indexterm" name="id2270027"></a><p><a name="ndbparam-api-batchsize"></a>
            <code class="literal">BatchSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-992</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is measured in number of records and is by
            default set to 64. The maximum size is 992.
          </p></li><li><a class="indexterm" name="id2270131"></a><p><a name="ndbparam-api-maxscanbatchsize"></a>
            <code class="literal">MaxScanBatchSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">32K-16M</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            The batch size is the size of each batch sent from each data
            node. Most scans are performed in parallel to protect the
            MySQL Server from receiving too much data from many nodes in
            parallel; this parameter sets a limit to the total batch
            size over all nodes.
          </p><p>
            The default value of this parameter is set to 256KB. Its
            maximum size is 16MB.
          </p></li></ul></div><p>
        You can obtain some information from a MySQL server running as a
        Cluster SQL node using <a href="sql-syntax.html#show-status" title="12.5.5.32. SHOW STATUS Syntax"><code class="literal">SHOW
        STATUS</code></a> in the <code class="literal">mysql</code> client, as
        shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'ndb%';</code></strong>
+-----------------------------+---------------+
| Variable_name               | Value         |
+-----------------------------+---------------+
| Ndb_cluster_node_id         | 5             |
| Ndb_config_from_host        | 192.168.0.112 |
| Ndb_config_from_port        | 1186          |
| Ndb_number_of_storage_nodes | 4             |
+-----------------------------+---------------+
4 rows in set (0.02 sec)
</pre><p>
        For information about these Cluster system status variables, see
        <a href="server-administration.html#server-status-variables" title="5.1.6. Server Status Variables">Section 5.1.6, “Server Status Variables”</a>.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          To add new SQL or API nodes to the configuration of a running
          MySQL Cluster, it is necessary to perform a rolling restart of
          all cluster nodes after adding new <code class="literal">[mysqld]</code>
          or <code class="literal">[api]</code> sections to the
          <code class="filename">config.ini</code> file (or files, if you are
          using more than one management server). This must be done
          before the new SQL or API nodes can connect to the cluster.
        </p><p>
          It is <span class="emphasis"><em>not</em></span> necessary to perform any
          restart of the cluster if new SQL or API nodes can employ
          previously unused API slots in the cluster configuration to
          connect to the cluster.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-tcp-definition"></a>17.3.4.7. MySQL Cluster TCP/IP Connections</h4></div></div></div><p>
        TCP/IP is the default transport mechanism for all connections
        between nodes in a MySQL Cluster. Normally it is not necessary
        to define TCP/IP connections; MySQL Cluster automatically sets
        up such connections for all data nodes, management nodes, and
        SQL or API nodes.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For an exception to this rule, see
          <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="17.3.4.8. MySQL Cluster TCP/IP Connections Using Direct Connections">Section 17.3.4.8, “MySQL Cluster TCP/IP Connections Using Direct Connections”</a>.
        </p></div><p>
        To override the default connection parameters, it is necessary
        to define a connection using one or more
        <code class="literal">[tcp]</code> sections in the
        <code class="filename">config.ini</code> file. Each
        <code class="literal">[tcp]</code> section explicitly defines a TCP/IP
        connection between two MySQL Cluster nodes, and must contain at
        a minimum the parameters <code class="literal">NodeId1</code> and
        <code class="literal">NodeId2</code>, as well as any connection parameters
        to override.
      </p><p>
        It is also possible to change the default values for these
        parameters by setting them in the <code class="literal">[tcp
        default]</code> section.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Any <code class="literal">[tcp]</code> sections in the
          <code class="filename">config.ini</code> file should be listed
          <span class="emphasis"><em>last</em></span>, following all other sections in the
          file. However, this is not required for a <code class="literal">[tcp
          default]</code> section. This requirement is a known issue
          with the way in which the <code class="filename">config.ini</code> file
          is read by the MySQL Cluster management server.
        </p></div><p>
        Connection parameters which can be set in
        <code class="literal">[tcp]</code> and <code class="literal">[tcp default]</code>
        sections of the <code class="filename">config.ini</code> file are listed
        here:
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="ndbparam-tcp-nodeid"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide their node IDs in the <code class="literal">[tcp]</code>
            section of the configuration file. These are the same unique
            <code class="literal">Id</code> values for each of these nodes as
            described in <a href="mysql-cluster.html#mysql-cluster-api-definition" title="17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster">Section 17.3.4.6, “Defining SQL and Other API Nodes in a MySQL Cluster”</a>.
          </p></li><li><a class="indexterm" name="id2270496"></a><p><a name="ndbparam-tcp-sendbuffermemory"></a>
            <code class="literal">SendBufferMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">64K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            TCP transporters use a buffer to store all messages before
            performing the send call to the operating system. When this
            buffer reaches 64KB its contents are sent; these are also
            sent when a round of messages have been executed. To handle
            temporary overload situations it is also possible to define
            a bigger send buffer.
          </p><p>
            The default size of the send buffer is 256 KB; 2MB is
            recommended in most situations in which it is necessary to
            set this parameter. The minimum size is 64 KB; the
            theoretical maximum is 4 GB.
          </p></li><li><a class="indexterm" name="id2270608"></a><p><a name="ndbparam-tcp-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">true</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            To be able to retrace a distributed message datagram, it is
            necessary to identify each message. When this parameter is
            set to <code class="literal">Y</code>, message IDs are transported
            over the network. This feature is disabled by default in
            production builds, and enabled in <code class="literal">-debug</code>
            builds.
          </p></li><li><a class="indexterm" name="id2270726"></a><p><a name="ndbparam-tcp-checksum"></a>
            <code class="literal">Checksum</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">false</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is a boolean parameter (enabled by setting it
            to <code class="literal">Y</code> or <code class="literal">1</code>, disabled by
            setting it to <code class="literal">N</code> or <code class="literal">0</code>).
            It is disabled by default. When it is enabled, checksums for
            all messages are calculated before they placed in the send
            buffer. This feature ensures that messages are not corrupted
            while waiting in the send buffer, or by the transport
            mechanism.
          </p></li><li><a class="indexterm" name="id2270855"></a><p><a name="ndbparam-tcp-portnumber"></a>
            <code class="literal">PortNumber</code>
            (<span class="emphasis"><em>OBSOLETE</em></span>)
          </p><p>
            This formerly specified the port number to be used for
            listening for connections from other nodes. This parameter
            should no longer be used.
          </p></li><li><a class="indexterm" name="id2270887"></a><p><a name="ndbparam-tcp-receivebuffermemory"></a>
            <code class="literal">ReceiveBufferMemory</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">64K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">16K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Specifies the size of the buffer used when receiving data
            from the TCP/IP socket.
          </p><p>
            The default value of this parameter from its of 64 KB; 1M is
            recommended in most situations where the size of the receive
            buffer needs to be set. The minimum possible value is 16K;
            theoretical maximum is 4G.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-tcp-definition-direct"></a>17.3.4.8. MySQL Cluster TCP/IP Connections Using Direct Connections</h4></div></div></div><a class="indexterm" name="id2271006"></a><a class="indexterm" name="id2271018"></a><a class="indexterm" name="id2271034"></a><p>
        Setting up a cluster using direct connections between data nodes
        requires specifying explicitly the crossover IP addresses of the
        data nodes so connected in the <code class="literal">[tcp]</code> section
        of the cluster <code class="filename">config.ini</code> file.
      </p><p>
        In the following example, we envision a cluster with at least
        four hosts, one each for a management server, an SQL node, and
        two data nodes. The cluster as a whole resides on the
        <code class="literal">172.23.72.*</code> subnet of a LAN. In addition to
        the usual network connections, the two data nodes are connected
        directly using a standard crossover cable, and communicate with
        one another directly using IP addresses in the
        <code class="literal">1.1.0.*</code> address range as shown:
      </p><pre class="programlisting"># Management Server
[ndb_mgmd]
Id=1
HostName=172.23.72.20

# SQL Node
[mysqld]
Id=2
HostName=172.23.72.21

# Data Nodes
[ndbd]
Id=3
HostName=172.23.72.22

[ndbd]
Id=4
HostName=172.23.72.23

# TCP/IP Connections
[tcp]
NodeId1=3
NodeId2=4
HostName1=1.1.0.1
HostName2=1.1.0.2
</pre><p>
        The <code class="literal">HostName<em class="replaceable"><code>N</code></em></code>
        parameter, where <em class="replaceable"><code>N</code></em> is an integer, is
        used only when specifying direct TCP/IP connections.
      </p><p>
        The use of direct connections between data nodes can improve the
        cluster's overall efficiency by allowing the data nodes to
        bypass an Ethernet device such as a switch, hub, or router, thus
        cutting down on the cluster's latency. It is important to note
        that to take the best advantage of direct connections in this
        fashion with more than two data nodes, you must have a direct
        connection between each data node and every other data node in
        the same node group.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-shm-definition"></a>17.3.4.9. MySQL Cluster Shared-Memory Connections</h4></div></div></div><a class="indexterm" name="id2271123"></a><a class="indexterm" name="id2271135"></a><a class="indexterm" name="id2271148"></a><a class="indexterm" name="id2271160"></a><p>
        MySQL Cluster attempts to use the shared memory transporter and
        configure it automatically where possible. (In very early
        versions of MySQL Cluster, shared memory segments functioned
        only when the server binary was built using
        <code class="option">--with-ndb-shm</code>.) <code class="literal">[shm]</code>
        sections in the <code class="filename">config.ini</code> file explicitly
        define shared-memory connections between nodes in the cluster.
        When explicitly defining shared memory as the connection method,
        it is necessary to define at least <code class="literal">NodeId1</code>,
        <code class="literal">NodeId2</code> and <code class="literal">ShmKey</code>. All
        other parameters have default values that should work well in
        most cases.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          <span class="emphasis"><em>SHM functionality is considered experimental
          only</em></span>. It is not officially supported in any current
          MySQL Cluster release, and testing results indicate that SHM
          performance is not appreciably greater than when using TCP/IP
          for the transporter.
        </p><p>
          For these reasons, you must determine for yourself or by using
          our free resources (forums, mailing lists) whether SHM can be
          made to work correctly in your specific case.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2271240"></a><a class="indexterm" name="id2271249"></a><p><a name="ndbparam-shm-nodeids"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide node identifiers for each of them, as
            <code class="literal">NodeId1</code> and <code class="literal">NodeId2</code>.
          </p></li><li><a class="indexterm" name="id2271298"></a><p><a name="ndbparam-shm-shmkey"></a>
            <code class="literal">ShmKey</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When setting up shared memory segments, a node ID, expressed
            as an integer, is used to identify uniquely the shared
            memory segment to use for the communication. There is no
            default value.
          </p></li><li><a class="indexterm" name="id2271402"></a><p><a name="ndbparam-shm-shmsize"></a>
            <code class="literal">ShmSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">64K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Each SHM connection has a shared memory segment where
            messages between nodes are placed by the sender and read by
            the reader. The size of this segment is defined by
            <code class="literal">ShmSize</code>. The default value is 1MB.
          </p></li><li><a class="indexterm" name="id2271512"></a><p><a name="ndbparam-shm-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">false</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            To retrace the path of a distributed message, it is
            necessary to provide each message with a unique identifier.
            Setting this parameter to <code class="literal">Y</code> causes these
            message IDs to be transported over the network as well. This
            feature is disabled by default in production builds, and
            enabled in <code class="literal">-debug</code> builds.
          </p></li><li><a class="indexterm" name="id2271630"></a><p><a name="ndbparam-shm-checksum"></a>
            <code class="literal">Checksum</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">true</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is a boolean
            (<code class="literal">Y</code>/<code class="literal">N</code>) parameter which
            is disabled by default. When it is enabled, checksums for
            all messages are calculated before being placed in the send
            buffer.
          </p><p>
            This feature prevents messages from being corrupted while
            waiting in the send buffer. It also serves as a check
            against data being corrupted during transport.
          </p></li><li><a class="indexterm" name="id2271751"></a><p><a name="ndbparam-shm-signum"></a>
            <code class="literal">SigNum</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When using the shared memory transporter, a process sends an
            operating system signal to the other process when there is
            new data available in the shared memory. Should that signal
            conflict with with an existing signal, this parameter can be
            used to change it. This is a possibility when using SHM due
            to the fact that different operating systems use different
            signal numbers.
          </p><p>
            The default value of <code class="literal">SigNum</code> is 0;
            therefore, it must be set to avoid errors in the cluster log
            when using the shared memory transporter. Typically, this
            parameter is set to 10 in the <code class="literal">[shm
            default]</code> section of the
            <code class="filename">config.ini</code> file.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-sci-definition"></a>17.3.4.10. SCI Transport Connections in MySQL Cluster</h4></div></div></div><a class="indexterm" name="id2271888"></a><a class="indexterm" name="id2271901"></a><a class="indexterm" name="id2271913"></a><a class="indexterm" name="id2271926"></a><p>
        <code class="literal">[sci]</code> sections in the
        <code class="filename">config.ini</code> file explicitly define SCI
        (Scalable Coherent Interface) connections between cluster nodes.
        Using SCI transporters in MySQL Cluster is supported only when
        the MySQL binaries are built using
        <code class="option">--with-ndb-sci=<em class="replaceable"><code>/your/path/to/SCI</code></em></code>.
        The <em class="replaceable"><code>path</code></em> should point to a directory
        that contains at a minimum <code class="filename">lib</code> and
        <code class="filename">include</code> directories containing SISCI
        libraries and header files. (See
        <a href="mysql-cluster.html#mysql-cluster-interconnects" title="17.9. Using High-Speed Interconnects with MySQL Cluster">Section 17.9, “Using High-Speed Interconnects with MySQL Cluster”</a> for more
        information about SCI.)
      </p><p>
        In addition, SCI requires specialized hardware.
      </p><p>
        It is strongly recommended to use SCI Transporters only for
        communication between <span><strong class="command">ndbd</strong></span> processes. Note
        also that using SCI Transporters means that the
        <span><strong class="command">ndbd</strong></span> processes never sleep. For this reason,
        SCI Transporters should be used only on machines having at least
        two CPUs dedicated for use by <span><strong class="command">ndbd</strong></span> processes.
        There should be at least one CPU per <span><strong class="command">ndbd</strong></span>
        process, with at least one CPU left in reserve to handle
        operating system activities.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2272026"></a><a class="indexterm" name="id2272035"></a><p><a name="ndbparam-sci-nodeids"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide node identifiers for each of them, as
            <code class="literal">NodeId1</code> and <code class="literal">NodeId2</code>.
          </p></li><li><a class="indexterm" name="id2272084"></a><p><a name="ndbparam-sci-host1sciid0"></a>
            <code class="literal">Host1SciId0</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This identifies the SCI node ID on the first Cluster node
            (identified by <code class="literal">NodeId1</code>).
          </p></li><li><p><a name="ndbparam-sci-host1sciid1"></a>
            <code class="literal">Host1SciId1</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            It is possible to set up SCI Transporters for failover
            between two SCI cards which then should use separate
            networks between the nodes. This identifies the node ID and
            the second SCI card to be used on the first node.
          </p></li><li><p><a name="ndbparam-sci-host2sciid0"></a>
            <code class="literal">Host2SciId0</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This identifies the SCI node ID on the second Cluster node
            (identified by <code class="literal">NodeId2</code>).
          </p></li><li><p><a name="ndbparam-sci-host2sciid1"></a>
            <code class="literal">Host2SciId1</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            When using two SCI cards to provide failover, this parameter
            identifies the second SCI card to be used on the second
            node.
          </p></li><li><a class="indexterm" name="id2272485"></a><p><a name="ndbparam-sci-sharedbuffersize"></a>
            <code class="literal">SharedBufferSize</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">10M</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">64K-4G</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            Each SCI transporter has a shared memory segment used for
            communication between the two nodes. Setting the size of
            this segment to the default value of 1MB should be
            sufficient for most applications. Using a smaller value can
            lead to problems when performing many parallel inserts; if
            the shared buffer is too small, this can also result in a
            crash of the <span><strong class="command">ndbd</strong></span> process.
          </p></li><li><a class="indexterm" name="id2272598"></a><p><a name="ndbparam-sci-sendlimit"></a>
            <code class="literal">SendLimit</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">8K</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">128-32K</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            A small buffer in front of the SCI media stores messages
            before transmitting them over the SCI network. By default,
            this is set to 8KB. Our benchmarks show that performance is
            best at 64KB but 16KB reaches within a few percent of this,
            and there was little if any advantage to increasing it
            beyond 8KB.
          </p></li><li><a class="indexterm" name="id2272704"></a><p><a name="ndbparam-sci-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">true</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            To trace a distributed message it is necessary to identify
            each message uniquely. When this parameter is set to
            <code class="literal">Y</code>, message IDs are transported over the
            network. This feature is disabled by default in production
            builds, and enabled in <code class="literal">-debug</code> builds.
          </p></li><li><a class="indexterm" name="id2272821"></a><p><a name="ndbparam-sci-checksum"></a>
            <code class="literal">Checksum</code>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Restart Type</strong></span></td><td>node</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">false</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">-</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
            This parameter is a boolean value, and is disabled by
            default. When <code class="literal">Checksum</code> is enabled,
            checksums are calculated for all messages before they are
            placed in the send buffer. This feature prevents messages
            from being corrupted while waiting in the send buffer. It
            also serves as a check against data being corrupted during
            transport.
          </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-params-overview"></a>17.3.5. Overview of MySQL Cluster Configuration Parameters</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-ndbd">17.3.5.1. MySQL Cluster Data Node Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-mgmd">17.3.5.2. MySQL Cluster Management Node Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-api">17.3.5.3. MySQL Cluster SQL Node and API Node Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-params-other">17.3.5.4. Other MySQL Cluster Configuration Parameters</a></span></dt></dl></div><a class="indexterm" name="id2272943"></a><a class="indexterm" name="id2272955"></a><p>
      The next four sections provide summary tables of MySQL Cluster
      configuration parameters used in the
      <code class="filename">config.ini</code> file to govern the cluster's
      functioning. Each table lists the parameters for one of the
      Cluster node process types (<span><strong class="command">ndbd</strong></span>,
      <span><strong class="command">ndb_mgmd</strong></span>, and <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>), and
      includes the parameter's type as well as its default, mimimum, and
      maximum values as applicable.
    </p><p>
      It is also stated what type of restart is required (node restart
      or system restart) — and whether the restart must be done
      with <code class="option">--initial</code> — to change the value of a
      given configuration parameter.
    </p><p>
      When performing a node restart or an initial node restart, all of
      the cluster's data nodes must be restarted in turn (also referred
      to as a <em class="firstterm">rolling restart</em>). It is possible to
      update cluster configuration parameters marked as
      <code class="literal">node</code> online — that is, without shutting
      down the cluster — in this fashion. An initial node restart
      requires restarting each <span><strong class="command">ndbd</strong></span> process with the
      <code class="option">--initial</code> option.
    </p><p>
      A system restart requires a complete shutdown and restart of the
      entire cluster. An initial system restart requires taking a backup
      of the cluster, wiping the cluster file system after shutdown, and
      then restoring from the backup following the restart.
    </p><p>
      In any cluster restart, all of the cluster's management servers
      must be restarted in order for them to read the updated
      configuration parameter values.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Values for numeric cluster parameters can generally be increased
        without any problems, although it is advisable to do so
        progressively, making such adjustments in relatively small
        increments. However, decreasing the values of such parameters
        — particularly those relating to memory usage and disk
        space — is not to be undertaken lightly, and it is
        recommended that you do so only following careful planning and
        testing. In addition, it is the generally the case that
        parameters relating to memory and disk usage which can be raised
        using a simple node restart require an initial node restart to
        be lowered.
      </p></div><p>
      Because some of these parameters can be used for configuring more
      than one type of cluster node, they may appear in more than one of
      the tables.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <code class="literal">4294967039</code> — which often appears as a
        maximum value in these tables — is defined in the
        <code class="literal">NDBCLUSTER</code> sources as
        <code class="literal">MAX_INT_RNIL</code> and is equal to
        <code class="literal">0xFFFFFEFF</code>, or
        <code class="literal">2<sup>32</sup> –
        2<sup>8</sup> – 1</code>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-params-ndbd"></a>17.3.5.1. MySQL Cluster Data Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2273130"></a><a class="indexterm" name="id2273142"></a><a class="indexterm" name="id2273151"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[ndbd]</code> or <code class="literal">[ndbd
        default]</code> sections of a <code class="filename">config.ini</code>
        file for configuring MySQL Cluster data nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="17.3.4.5. Defining MySQL Cluster Data Nodes">Section 17.3.4.5, “Defining MySQL Cluster Data Nodes”</a>.
      </p><div class="table"><a name="id2273188"></a><p class="title"><b>Table 17.1. Data Node Configuration Parameters</b></p><table summary="Data Node Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-arbitrationtimeout">ArbitrationTimeout</a></td><td>milliseconds</td><td>1000</td><td>10</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backupdatabuffersize">BackupDataBufferSize</a></td><td>bytes</td><td>2M</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backupdatadir">BackupDataDir</a></td><td>path</td><td>FileSystemPath/BACKUP</td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backuplogbuffersize">BackupLogBufferSize</a></td><td>bytes</td><td>2M</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backupmaxwritesize">BackupMaxWriteSize</a></td><td>bytes</td><td>256K</td><td>2K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backupmemory">BackupMemory</a></td><td>bytes</td><td>4M</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-backupwritesize">BackupWriteSize</a></td><td>bytes</td><td>32K</td><td>2K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-batchsizeperlocalscan">BatchSizePerLocalScan</a></td><td>integer</td><td>64</td><td>1</td><td>992</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-datadir">DataDir</a></td><td>path</td><td>.</td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-datamemory">DataMemory</a></td><td>bytes</td><td>80M</td><td>1M</td><td>1024G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-diskless">Diskless</a></td><td>true|false (1|0)</td><td> </td><td> </td><td>1</td><td>IS</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-executeoncomputer">ExecuteOnComputer</a></td><td>name</td><td> </td><td> </td><td> </td><td>S</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-heartbeatintervaldbapi">HeartbeatIntervalDbApi</a></td><td>milliseconds</td><td>1500</td><td>100</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-heartbeatintervaldbdb">HeartbeatIntervalDbDb</a></td><td>milliseconds</td><td>1500</td><td>10</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-hostname">HostName</a></td><td>name or IP</td><td>localhost</td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-id">Id</a></td><td>unsigned</td><td> </td><td>1</td><td>48</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-indexmemory">IndexMemory</a></td><td>bytes</td><td>18M</td><td>1M</td><td>1T</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-lockpagesinmainmemory">LockPagesInMainMemory</a></td><td>true|false (1|0)</td><td> </td><td> </td><td>1</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelcheckpoint">LogLevelCheckpoint</a></td><td>log level</td><td> </td><td> </td><td>15</td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelcongestion">LogLevelCongestion</a></td><td>levelr</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelconnection">LogLevelConnection</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelerror">LogLevelError</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelinfo">LogLevelInfo</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelnoderestart">LogLevelNodeRestart</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelshutdown">LogLevelShutdown</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelstartup">LogLevelStartup</a></td><td>integer</td><td>1</td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-loglevelstatistic">LogLevelStatistic</a></td><td>integer</td><td> </td><td> </td><td>15</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-longmessagebuffer">LongMessageBuffer</a></td><td>bytes</td><td>1M</td><td>512K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofattributes">MaxNoOfAttributes</a></td><td>integer</td><td>1000</td><td>32</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofconcurrentindexoperations">MaxNoOfConcurrentIndexOperations</a></td><td>integer</td><td>8K</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofconcurrentoperations">MaxNoOfConcurrentOperations</a></td><td>integer</td><td>32K</td><td>32</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofconcurrentscans">MaxNoOfConcurrentScans</a></td><td>integer</td><td>256</td><td>2</td><td>500</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofconcurrenttransactions">MaxNoOfConcurrentTransactions</a></td><td>integer</td><td>4096</td><td>32</td><td>4G</td><td>S</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooffiredtriggers">MaxNoOfFiredTriggers</a></td><td>integer</td><td>4000</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooflocaloperations">MaxNoOfLocalOperations</a></td><td>integer</td><td>UNDEFINED</td><td>32</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooflocalscans">MaxNoOfLocalScans</a></td><td>integer</td><td>UNDEFINED</td><td>32</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofopenfiles">MaxNoOfOpenFiles</a></td><td>integer</td><td>40</td><td>20</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooforderedindexes">MaxNoOfOrderedIndexes</a></td><td>integer</td><td>128</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofsavedmessages">MaxNoOfSavedMessages</a></td><td>integer</td><td>25</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooftables">MaxNoOfTables</a></td><td>integer</td><td>128</td><td>8</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnooftriggers">MaxNoOfTriggers</a></td><td>integer</td><td>768</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-maxnoofuniquehashindexes">MaxNoOfUniqueHashIndexes</a></td><td>integer</td><td>64</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-noofdiskpagestodiskafterrestartacc">NoOfDiskPagesToDiskAfterRestartACC</a></td><td>8K pages/100 milliseconds</td><td>20</td><td>1</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-noofdiskpagestodiskafterrestarttup">NoOfDiskPagesToDiskAfterRestartTUP</a></td><td>8K pages/100 milliseconds</td><td>40</td><td>1</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-noofdiskpagestodiskduringrestartacc">NoOfDiskPagesToDiskDuringRestartACC</a></td><td>8K pages/100 milliseconds</td><td>20</td><td>1</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-noofdiskpagestodiskduringrestarttup">NoOfDiskPagesToDiskDuringRestartTUP</a></td><td>8K pages/100 milliseconds</td><td>40</td><td>1</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-nooffragmentlogfiles">NoOfFragmentLogFiles</a></td><td>integer</td><td>8</td><td>3</td><td>4G</td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-noofreplicas">NoOfReplicas</a></td><td>integer</td><td>None</td><td>1</td><td>4</td><td>IS</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-redobuffer">RedoBuffer</a></td><td>bytes</td><td>8M</td><td>1M</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-restartonerrorinsert">RestartOnErrorInsert</a></td><td>error code</td><td>2</td><td> </td><td>4</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-serverport">ServerPort</a></td><td>unsigned</td><td> </td><td>1</td><td>64K</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-startfailuretimeout">StartFailureTimeout</a></td><td>milliseconds</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-startpartialtimeout">StartPartialTimeout</a></td><td>milliseconds</td><td>30000</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-startpartitionedtimeout">StartPartitionedTimeout</a></td><td>milliseconds</td><td>60000</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-stoponerror">StopOnError</a></td><td>true|false (1|0)</td><td>true</td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-stringmemory">StringMemory</a></td><td>% or bytes</td><td> </td><td> </td><td>4G</td><td>S</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-timebetweenglobalcheckpoints">TimeBetweenGlobalCheckpoints</a></td><td>milliseconds</td><td>2000</td><td>10</td><td>32000</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-timebetweeninactivetransactionabortcheck">TimeBetweenInactiveTransactionAbortCheck</a></td><td>milliseconds</td><td>1000</td><td>1000</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-timebetweenlocalcheckpoints">TimeBetweenLocalCheckpoints</a></td><td>number of 4-byte words, as a base-2 logarithm</td><td>20</td><td> </td><td>31</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-timebetweenwatchdogcheck">TimeBetweenWatchDogCheck</a></td><td>milliseconds</td><td>6000</td><td>70</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-transactionbuffermemory">TransactionBufferMemory</a></td><td>bytes</td><td>1M</td><td>1K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-transactiondeadlockdetectiontimeout">TransactionDeadlockDetectionTimeout</a></td><td>milliseconds</td><td>1200</td><td>50</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-transactioninactivetimeout">TransactionInactiveTimeout</a></td><td>milliseconds</td><td>4G</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-undodatabuffer">UndoDataBuffer</a></td><td>unsigned</td><td>16M</td><td>1M</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-ndbd-undoindexbuffer">UndoIndexBuffer</a></td><td>unsigned</td><td>2M</td><td>1M</td><td>4G</td><td>N</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          To add new data nodes to a MySQL Cluster, it is necessary to
          shut down the cluster completely, update the
          <code class="filename">config.ini</code> file, and then restart the
          cluster (that is, you must perform a system restart). All data
          node processes must be started with the
          <code class="option">--initial</code> option.
        </p><p>
          We are working to make it possible to add new data node groups
          to a running cluster online in a future release; however, we
          do not plan to implement this change in MySQL
          5.0.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-params-mgmd"></a>17.3.5.2. MySQL Cluster Management Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2274384"></a><a class="indexterm" name="id2274397"></a><a class="indexterm" name="id2274406"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[ndb_mgmd]</code> or <code class="literal">[mgm]</code>
        sections of a <code class="filename">config.ini</code> file for
        configuring MySQL Cluster management nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="17.3.4.4. Defining a MySQL Cluster Management Server">Section 17.3.4.4, “Defining a MySQL Cluster Management Server”</a>.
      </p><div class="table"><a name="id2274443"></a><p class="title"><b>Table 17.2. Management Node Configuration Parameters</b></p><table summary="Management Node Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-arbitrationdelay">ArbitrationDelay</a></td><td>milliseconds</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-arbitrationrank">ArbitrationRank</a></td><td>0-2</td><td> </td><td> </td><td>2</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-datadir">DataDir</a></td><td>path</td><td>.</td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-executeoncomputer">ExecuteOnComputer</a></td><td>name</td><td> </td><td> </td><td> </td><td>S</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-hostname">HostName</a></td><td>name or IP</td><td> </td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-id">Id</a></td><td>unsigned</td><td> </td><td>1</td><td>63</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-logdestination">LogDestination</a></td><td>{CONSOLE|SYSLOG|FILE}</td><td>FILE:filename=ndb_nodeid_cluster.log,maxsize=1000000,maxfiles=6</td><td> </td><td> </td><td>N</td></tr><tr><td align="left">MaxNoOfSavedEvents</td><td>unsigned</td><td>100</td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-mgmd-portnumber">PortNumber</a></td><td>unsigned</td><td>1186</td><td> </td><td>64K</td><td>N</td></tr><tr><td align="left">PortNumberStats</td><td>unsigned</td><td> </td><td> </td><td>64K</td><td>N</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          After making changes in a management node's
          configuration, it is necessary to perform a rolling restart of
          the cluster in order for the new configuration to take effect.
          See <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="17.3.4.4. Defining a MySQL Cluster Management Server">Section 17.3.4.4, “Defining a MySQL Cluster Management Server”</a>, for more
          information.
        </p><p>
          To add new management servers to a running MySQL Cluster, it
          is also necessary perform a rolling restart of all cluster
          nodes after modifying any existing
          <code class="filename">config.ini</code> files. For more information
          about issues arising when using multiple management nodes, see
          <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes">Section 17.10.9, “Limitations Relating to Multiple MySQL Cluster Nodes”</a>.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-params-api"></a>17.3.5.3. MySQL Cluster SQL Node and API Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2274680"></a><a class="indexterm" name="id2274692"></a><a class="indexterm" name="id2274701"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[SQL]</code> and <code class="literal">[api]</code>
        sections of a <code class="filename">config.ini</code> file for
        configuring MySQL Cluster SQL nodes and API nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-api-definition" title="17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster">Section 17.3.4.6, “Defining SQL and Other API Nodes in a MySQL Cluster”</a>.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For a discussion of MySQL server options for MySQL Cluster,
          see <a href="mysql-cluster.html#mysql-cluster-program-options-mysqld" title="17.4.2. mysqld Command Options for MySQL Cluster">Section 17.4.2, “<span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster”</a>;
          for information about MySQL server system variables relating
          to MySQL Cluster, see
          <a href="mysql-cluster.html#mysql-cluster-system-variables" title="17.4.3. MySQL Cluster System Variables">Section 17.4.3, “MySQL Cluster System Variables”</a>.
        </p></div><div class="table"><a name="id2274756"></a><p class="title"><b>Table 17.3. API Node Configuration Parameters</b></p><table summary="API Node Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-arbitrationdelay">ArbitrationDelay</a></td><td>milliseconds</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-arbitrationrank">ArbitrationRank</a></td><td>0-2</td><td> </td><td> </td><td>2</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-batchbytesize">BatchByteSize</a></td><td>bytes</td><td>32K</td><td>1024</td><td>1M</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-executeoncomputer">ExecuteOnComputer</a></td><td>name</td><td> </td><td> </td><td> </td><td>S</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-hostname">HostName</a></td><td>name or IP</td><td> </td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-id">Id</a></td><td>unsigned</td><td> </td><td>1</td><td>63</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-api-maxscanbatchsize">MaxScanBatchSize</a></td><td>bytes</td><td>256K</td><td>32K</td><td>16M</td><td>N</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          To add new SQL or API nodes to the configuration of a running
          MySQL Cluster, it is necessary to perform a rolling restart of
          all cluster nodes after adding new <code class="literal">[mysqld]</code>
          or <code class="literal">[api]</code> sections to the
          <code class="filename">config.ini</code> file (or files, if you are
          using more than one management server). This must be done
          before the new SQL or API nodes can connect to the cluster.
        </p><p>
          It is <span class="emphasis"><em>not</em></span> necessary to perform any
          restart of the cluster if new SQL or API nodes can employ
          previously unused API slots in the cluster configuration to
          connect to the cluster.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-params-other"></a>17.3.5.4. Other MySQL Cluster Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2274961"></a><a class="indexterm" name="id2274973"></a><a class="indexterm" name="id2274982"></a><a class="indexterm" name="id2274991"></a><a class="indexterm" name="id2275000"></a><p>
        The following tables provide information about parameters used
        in the <code class="literal">[computer]</code>, <code class="literal">[tcp]</code>,
        <code class="literal">[shm]</code>, and <code class="literal">[sci]</code> sections
        of a <code class="filename">config.ini</code> file for configuring MySQL
        Cluster management nodes. For detailed descriptions and other
        additional information about individual parameters, see
        <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="17.3.4.7. MySQL Cluster TCP/IP Connections">Section 17.3.4.7, “MySQL Cluster TCP/IP Connections”</a>,
        <a href="mysql-cluster.html#mysql-cluster-shm-definition" title="17.3.4.9. MySQL Cluster Shared-Memory Connections">Section 17.3.4.9, “MySQL Cluster Shared-Memory Connections”</a>, or
        <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="17.3.4.10. SCI Transport Connections in MySQL Cluster">Section 17.3.4.10, “SCI Transport Connections in MySQL Cluster”</a>, as appropriate.
      </p><div class="table"><a name="id2275059"></a><p class="title"><b>Table 17.4. COMPUTER Configuration Parameters</b></p><table summary="COMPUTER Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-computer-hostname">HostName</a></td><td>name or IP</td><td> </td><td> </td><td> </td><td>IN</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-computer-id">Id</a></td><td>string</td><td> </td><td> </td><td> </td><td>IN</td></tr></tbody></table></div><div class="table"><a name="id2275134"></a><p class="title"><b>Table 17.5. TCP Configuration Parameters</b></p><table summary="TCP Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-tcp-checksum">Checksum</a></td><td> </td><td>false</td><td> </td><td> </td><td>N</td></tr><tr><td align="left">Group</td><td>unsigned</td><td>55</td><td> </td><td>200</td><td>N</td></tr><tr><td align="left">NodeId1</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeId2</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeIdServer</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-tcp-portnumber">PortNumber</a></td><td>unsigned</td><td> </td><td> </td><td>64K</td><td>N</td></tr><tr><td align="left">Proxy</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-tcp-receivebuffermemory">ReceiveBufferMemory</a></td><td>bytes</td><td>64K</td><td>16K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-tcp-sendbuffermemory">SendBufferMemory</a></td><td>unsigned</td><td>256K</td><td>64K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-tcp-sendsignalid">SendSignalId</a></td><td> </td><td>true</td><td> </td><td> </td><td>N</td></tr></tbody></table></div><div class="table"><a name="id2275313"></a><p class="title"><b>Table 17.6. SHM Configuration Parameters</b></p><table summary="SHM Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-shm-checksum">Checksum</a></td><td> </td><td>true</td><td> </td><td> </td><td>N</td></tr><tr><td align="left">Group</td><td>unsigned</td><td>35</td><td> </td><td>200</td><td>N</td></tr><tr><td align="left">NodeId1</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeId2</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeIdServer</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">PortNumber</td><td>unsigned</td><td> </td><td> </td><td>64K</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-shm-sendsignalid">SendSignalId</a></td><td> </td><td>false</td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-shm-shmkey">ShmKey</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-shm-shmsize">ShmSize</a></td><td>bytes</td><td>1M</td><td>64K</td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-shm-signum">Signum</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr></tbody></table></div><div class="table"><a name="id2275493"></a><p class="title"><b>Table 17.7. SCI Configuration Parameters</b></p><table summary="SCI Configuration Parameters" border="1"><colgroup><col align="left"><col><col><col><col><col></colgroup><thead><tr><th align="left">Name</th><th>Type/Units</th><th>Default</th><th>Min Value</th><th>Max Value</th><th>Restart Type</th></tr></thead><tbody><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-checksum">Checksum</a></td><td> </td><td>false</td><td> </td><td> </td><td>N</td></tr><tr><td align="left">Group</td><td>unsigned</td><td>15</td><td> </td><td>200</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-host1sciid0">Host1SciId0</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-host1sciid1">Host1SciId1</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-host2sciid0">Host2SciId0</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-host2sciid1">Host2SciId1</a></td><td>unsigned</td><td> </td><td> </td><td>4G</td><td>N</td></tr><tr><td align="left">NodeId1</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeId2</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">NodeIdServer</td><td> </td><td> </td><td> </td><td> </td><td>N</td></tr><tr><td align="left">PortNumber</td><td>unsigned</td><td> </td><td> </td><td>64K</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-sendlimit">SendLimit</a></td><td>unsigned</td><td>8K</td><td>128</td><td>32K</td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-sendsignalid">SendSignalId</a></td><td> </td><td>true</td><td> </td><td> </td><td>N</td></tr><tr><td align="left"><a href="mysql-cluster.html#ndbparam-sci-sharedbuffersize">SharedBufferSize</a></td><td>unsigned</td><td>10M</td><td>64K</td><td>4G</td><td>N</td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-config-lcp-params"></a>17.3.6. Configuring MySQL Cluster Parameters for Local Checkpoints</h3></div></div></div><a class="indexterm" name="id2275732"></a><a class="indexterm" name="id2275741"></a><a class="indexterm" name="id2275750"></a><a class="indexterm" name="id2275763"></a><a class="indexterm" name="id2275775"></a><a class="indexterm" name="id2275788"></a><a class="indexterm" name="id2275797"></a><p>
      The parameters discussed in
      <a href="mysql-cluster.html#mysql-cluster-logging-and-checkpointing">Logging
      and Checkpointing</a> and in
      <a href="mysql-cluster.html#mysql-cluster-data-memory-index-memory-string-memory">Data
      Memory, Index Memory, and String Memory</a> that are used to
      configure local checkpoints for a MySQL Cluster do not exist in
      isolation, but rather are very much interdepedent on each other.
      In this section, we illustrate how these parameters —
      including <code class="literal">DataMemory</code>,
      <code class="literal">IndexMemory</code>,
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code>,
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>, and
      <code class="literal">NoOfFragmentLogFiles</code> — relate to one
      another in a working Cluster.
    </p><p>
      In this example, we assume that our application performs the
      following numbers of types of operations per hour:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          50000 selects
        </p></li><li><p>
          15000 inserts
        </p></li><li><p>
          15000 updates
        </p></li><li><p>
          15000 deletes
        </p></li></ul></div><p>
      We also make the following assumptions about the data used in the
      application:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          We are working with a single table having 40 columns.
        </p></li><li><p>
          Each column can hold up to 32 bytes of data.
        </p></li><li><p>
          A typical <a href="sql-syntax.html#update" title="12.2.11. UPDATE Syntax"><code class="literal">UPDATE</code></a> run by the
          application affects the values of 5 columns.
        </p></li><li><p>
          No <code class="literal">NULL</code> values are inserted by the
          application.
        </p></li></ul></div><p>
      A good starting point is to determine the amount of time that
      should elapse between local checkpoints (LCPs). It is worth noting
      that, in the event of a system restart, it takes 40-60 percent of
      this interval to execute the REDO log — for example, if the
      time between LCPs is 5 minutes (300 seconds), then it should take
      2 to 3 minutes (120 to 180 seconds) for the REDO log to be read.
    </p><p>
      The maximum amount of data per node can be assumed to be the size
      of the <code class="literal">DataMemory</code> parameter. In this example,
      we assume that this is 2 GB. The
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> parameter
      represents the amount of data to be checkpointed per unit time
      — however, this parameter is actually expressed as the
      number of 8K memory pages to be checkpointed per 100 milliseconds.
      2 GB per 300 seconds is approximately 6.8 MB per second, or 700 KB
      per 100 milliseconds, which works out to roughly 85 pages per 100
      milliseconds.
    </p><p>
      Similarly, we can calculate
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code> in terms of
      the time for local checkpoints and the amount of memory required
      for indexes — that is, the <code class="literal">IndexMemory</code>.
      Assuming that we allow 512 MB for indexes, this works out to
      approximately 20 8-KB pages per 100 milliseconds for this
      parameter.
    </p><p>
      Next, we need to determine the number of REDO log files required
      — that is, fragment log files — the corresponding
      parameter being <code class="literal">NoOfFragmentLogFiles</code>. We need
      to make sure that there are sufficient REDO log files for keeping
      records for at least 3 local checkpoints. In a production setting,
      there are always uncertainties — for instance, we cannot be
      sure that disks always operate at top speed or with maximum
      throughput. For this reason, it is best to err on the side of
      caution, so we double our requirement and calculate a number of
      fragment log files which should be enough to keep records covering
      6 local checkpoints.
    </p><p>
      It is also important to remember that the disk also handles writes
      to the REDO log and UNDO log, so if you find that the amount of
      data being written to disk as determined by the values of
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code> and
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> is
      approaching the amount of disk bandwidth available, you may wish
      to increase the time between local checkpoints.
    </p><p>
      Given 5 minutes (300 seconds) per local checkpoint, this means
      that we need to support writing log records at maximum speed for 6
      * 300 = 1800 seconds. The size of a REDO log record is 72 bytes
      plus 4 bytes per updated column value plus the maximum size of the
      updated column, and there is one REDO log record for each table
      record updated in a transaction, on each node where the data
      reside. Using the numbers of operations set out previously in this
      section, we derive the following:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          50000 select operations per hour yields 0 log records (and
          thus 0 bytes), since <a href="sql-syntax.html#select" title="12.2.8. SELECT Syntax"><code class="literal">SELECT</code></a>
          statements are not recorded in the REDO log.
        </p></li><li><p>
          15000 <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statements per
          hour is approximately 5 delete operations per second. (Since
          we wish to be conservative in our estimate, we round up here
          and in the following calculations.) No columns are updated by
          deletes, so these statements consume only 5 operations * 72
          bytes per operation = 360 bytes per second.
        </p></li><li><p>
          15000 <a href="sql-syntax.html#update" title="12.2.11. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements per
          hour is roughly the same as 5 updates per second. Each update
          uses 72 bytes, plus 4 bytes per column * 5 columns updated,
          plus 32 bytes per column * 5 columns — this works out to
          72 + 20 + 160 = 252 bytes per operation, and multiplying this
          by 5 operation per second yields 1260 bytes per second.
        </p></li><li><p>
          15000 <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statements per
          hour is equivalent to 5 insert operations per second. Each
          insert requires REDO log space of 72 bytes, plus 4 bytes per
          record * 40 columns, plus 32 bytes per column * 40 columns,
          which is 72 + 160 + 1280 = 1512 bytes per operation. This
          times 5 operations per second yields 7560 bytes per second.
        </p></li></ul></div><p>
      So the total number of REDO log bytes being written per second is
      approximately 0 + 360 + 1260 + 7560 = 9180 bytes. Multiplied by
      1800 seconds, this yields 16524000 bytes required for REDO
      logging, or approximately 15.75 MB. The unit used for
      <code class="literal">NoOfFragmentLogFiles</code> represents a set of 4
      16-MB log files — that is, 64 MB. Thus, the minimum value
      (3) for this parameter is sufficient for the scenario envisioned
      in this example, since 3 times 64 = 192 MB, or about 12 times what
      is required; the default value of 8 (or 512 MB) is more than ample
      in this case.
    </p><p>
      A copy of each altered table record is kept in the UNDO log. In
      the scenario discussed above, the UNDO log would not require any
      more space than what is provided by the default seetings. However,
      given the size of disks, it is sensible to allocate at least 1 GB
      for it.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-options-variables"></a>17.4. MySQL Cluster Options and Variables</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-option-tables">17.4.1. MySQL Cluster Server Option and Variable Reference</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-mysqld">17.4.2. <span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-system-variables">17.4.3. MySQL Cluster System Variables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-status-variables">17.4.4. MySQL Cluster Status Variables</a></span></dt></dl></div><p>
    This section provides information about MySQL server options, server
    and status variables that are specific to MySQL Cluster. For general
    information on using these, and for other options and variables not
    specific to MySQL Cluster, see <a href="server-administration.html#mysqld-server" title="5.1. The MySQL Server">Section 5.1, “The MySQL Server”</a>.
  </p><p>
    For MySQL Cluster configuration parameters used in the cluster
    confiuration file (usually named <code class="filename">config.ini</code>),
    see <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-option-tables"></a>17.4.1. MySQL Cluster Server Option and Variable Reference</h3></div></div></div><p>
      The following table provides a list of the command-line options,
      server and status variables applicable within
      <code class="literal">mysqld</code> when it is running as an SQL node in a
      MySQL Cluster. For a table showing <span class="emphasis"><em>all</em></span>
      command-line options, server and status variables available for
      use with <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>, see
      <a href="server-administration.html#mysqld-option-tables" title="5.1.1. Server Option and Variable Reference">Section 5.1.1, “Server Option and Variable Reference”</a>.
    </p><div class="table"><a name="id2276235"></a><p class="title"><b>Table 17.8. <span>mysqld</span> Option/Variable Reference</b></p><table summary="mysqld Option/Variable Reference" border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"></colgroup><thead><tr><th><span class="bold"><strong>Name</strong></span></th><th align="center"><span class="bold"><strong>Cmd-Line</strong></span></th><th align="center"><span class="bold"><strong>Option file</strong></span></th><th align="center"><span class="bold"><strong>System Var</strong></span></th><th align="center"><span class="bold"><strong>Status Var</strong></span></th><th align="center"><span class="bold"><strong>Var Scope</strong></span></th><th align="center"><span class="bold"><strong>Dynamic</strong></span></th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#statvar_Handler_discover">Handler_discover</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#sysvar_have_ndbcluster">have_ndbcluster</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_autoincrement_prefetch_sz">ndb_autoincrement_prefetch_sz</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_cache_check_time">ndb_cache_check_time</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="mysql-cluster.html#statvar_Ndb_cluster_node_id">Ndb_cluster_node_id</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#statvar_Ndb_config_from_host">Ndb_config_from_host</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#statvar_Ndb_config_from_port">Ndb_config_from_port</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_force_send">ndb_force_send</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_index_stat_cache_entries">ndb_index_stat_cache_entries</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_index_stat_enable">ndb_index_stat_enable</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_index_stat_update_freq">ndb_index_stat_update_freq</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td>ndb-mgmd-host</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#mysqld_option_ndb-nodeid">ndb-nodeid</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_optimized_node_selection">ndb_optimized_node_selection</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_report_thresh_binlog_epoch_slip">ndb_report_thresh_binlog_epoch_slip</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_report_thresh_binlog_mem_usage">ndb_report_thresh_binlog_mem_usage</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_use_exact_count">ndb_use_exact_count</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td><a href="mysql-cluster.html#sysvar_ndb_use_transactions">ndb_use_transactions</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndbcluster">ndbcluster</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-program-options-mysqld"></a>17.4.2. <span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2276830"></a><a class="indexterm" name="id2276842"></a><a class="indexterm" name="id2276855"></a><a class="indexterm" name="id2276867"></a><a class="indexterm" name="id2276880"></a><p>
      This section provides descriptions of <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>
      server options relating to MySQL Cluster. For information about
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> options not specific to MySQL Cluster,
      and for general information about the use of options with
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>, see <a href="server-administration.html#server-options" title="5.1.2. Server Command Options">Section 5.1.2, “Server Command Options”</a>.
    </p><p>
      For information about command-line options used with other MySQL
      Cluster processes (<span><strong class="command">ndbd</strong></span>,
      <span><strong class="command">ndb_mgmd</strong></span>, and <span><strong class="command">ndb_mgm</strong></span>), see
      <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>. For
      information about command-line options used with
      <code class="literal">NDB</code> utility programs (such as
      <span><strong class="command">ndb_desc</strong></span>, <span><strong class="command">ndb_size.pl</strong></span>, and
      <span><strong class="command">ndb_show_tables</strong></span>), see
      <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_ndb-connectstring"></a>
          <a class="indexterm" name="id2276989"></a>

          <a class="indexterm" name="id2277002"></a>

          <code class="option">--ndb-connectstring=<em class="replaceable"><code>connect_string</code></em></code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-connectstring</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb-connectstring</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          When using the <code class="literal">NDBCLUSTER</code> storage
          engine, this option specifies the management server that
          distributes cluster configuration data. See
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, for syntax.
        </p></li><li><p><a name="option_mysqld_ndbcluster"></a>
          <a class="indexterm" name="id2277114"></a>

          <a class="indexterm" name="id2277126"></a>

          <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndbcluster</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndbcluster</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The <code class="literal">NDBCLUSTER</code> storage engine is
          necessary for using MySQL Cluster. If a
          <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> binary includes support for the
          <code class="literal">NDBCLUSTER</code> storage engine, the
          engine is disabled by default. Use the
          <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option to enable
          it. Use <code class="option">--skip-ndbcluster</code> to explicitly
          disable the engine.
        </p></li><li><p><a name="mysqld_option_ndb-nodeid"></a>
          <a class="indexterm" name="id2277274"></a>

          <a class="indexterm" name="id2277286"></a>

          <code class="option">--ndb-nodeid=#</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.45</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-nodeid=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb-nodeid</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">Ndb_cluster_node_id</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Permitted Values (&gt;= 5.0.45)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-63</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Set this MySQL server's node ID in a MySQL Cluster. This
          can be used instead of specifying the node ID as part of the
          connectstring or in the <code class="filename">config.ini</code> file,
          or allowing the cluster to determine an arbitrary node ID. If
          you use this option, then <code class="option">--ndb-nodeid</code> must
          be specified <span class="emphasis"><em>before</em></span>
          <code class="option">--ndb-connectstring</code>. If
          <code class="option">--ndb-nodeid</code> is used <span class="emphasis"><em>and</em></span>
          a node ID is specified in the connectstring, then the MySQL
          server will not be able to connect to the cluster. In
          addition, if <code class="option">--nodeid</code> is used, then either a
          matching node ID must be found in a
          <code class="literal">[mysqld]</code> or <code class="literal">[api]</code>
          section of <code class="filename">config.ini</code>, or there must be
          an “<span class="quote">open</span>” <code class="literal">[mysqld]</code> or
          <code class="literal">[api]</code> section in the file (that is, a
          section without an <code class="literal">Id</code> parameter specified).
        </p><p>
          Regardless of how the node ID is determined, its is shown as
          the value of the global status variable
          <code class="literal">Ndb_cluster_node_id</code> in the output of
          <a href="sql-syntax.html#show-status" title="12.5.5.32. SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>, and as
          <code class="literal">cluster_node_id</code> in the
          <code class="literal">connection</code> row of the output of
          <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
          NDBCLUSTER STATUS</code></a>.
        </p><p>
          For more information about node IDs for MySQL Cluster SQL
          nodes, see <a href="mysql-cluster.html#mysql-cluster-api-definition" title="17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster">Section 17.3.4.6, “Defining SQL and Other API Nodes in a MySQL Cluster”</a>.
        </p></li><li><p><a name="option_mysqld_skip-ndbcluster"></a>
          <a class="indexterm" name="id2277552"></a>

          <a class="indexterm" name="id2277564"></a>

          <code class="option">--skip-ndbcluster</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--skip-ndbcluster</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">skip-ndbcluster</code></td></tr></tbody></table></div><p>
          Disable the <code class="literal">NDBCLUSTER</code> storage
          engine. This is the default for binaries that were built with
          <code class="literal">NDBCLUSTER</code> storage engine
          support; the server allocates memory and other resources for
          this storage engine only if the
          <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option is given
          explicitly. See <a href="mysql-cluster.html#mysql-cluster-quick" title="17.3.3. Quick Test Setup of MySQL Cluster">Section 17.3.3, “Quick Test Setup of MySQL Cluster”</a>, for an
          example.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-system-variables"></a>17.4.3. MySQL Cluster System Variables</h3></div></div></div><p>
      This section provides detailed information about MySQL server
      system variables that are specific to MySQL Cluster and the
      <code class="literal">NDB</code> storage engine. For system
      variables not specific to MySQL Cluster, see
      <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>. For general information
      on using system variables, see
      <a href="server-administration.html#using-system-variables" title="5.1.5. Using System Variables">Section 5.1.5, “Using System Variables”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="sysvar_have_ndbcluster"></a>
          <a href="mysql-cluster.html#sysvar_have_ndbcluster"><code class="literal">have_ndbcluster</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">have_ndbcluster</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          <code class="literal">YES</code> if <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> supports
          <code class="literal">NDBCLUSTER</code> tables.
          <code class="literal">DISABLED</code> if
          <code class="option">--skip-ndbcluster</code> is used.
        </p></li><li><p><a name="sysvar_multi_range_count"></a>
          <code class="literal">multi_range_count</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.3</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--multi_range_count=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">multi_range_count</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="mysql-cluster.html#sysvar_multi_range_count"><code class="literal">multi_range_count</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">multi_range_count</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-4294967295</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The maximum number of ranges to send to a table handler at
          once during range selects. The default value is 256. Sending
          multiple ranges to a handler at once can improve the
          performance of certain selects dramatically. This is
          especially true for the
          <code class="literal">NDBCLUSTER</code> table handler, which
          needs to send the range requests to all nodes. Sending a batch
          of those requests at once reduces communication costs
          significantly.
        </p><p>
          This variable was added in MySQL 5.0.3.
        </p></li><li><p><a name="sysvar_ndb_autoincrement_prefetch_sz"></a>
          <a href="mysql-cluster.html#sysvar_ndb_autoincrement_prefetch_sz"><code class="literal">ndb_autoincrement_prefetch_sz</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_autoincrement_prefetch_sz</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_autoincrement_prefetch_sz</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="mysql-cluster.html#sysvar_ndb_autoincrement_prefetch_sz"><code class="literal">ndb_autoincrement_prefetch_sz</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_autoincrement_prefetch_sz</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values (&lt;= 5.0.54)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-256</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Permitted Values (&gt;= 5.0.56)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-256</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Determines the probability of gaps in an autoincremented
          column. Set it to <code class="literal">1</code> to minimize this.
          Setting it to a high value for optimization — makes
          inserts faster, but decreases the likelihood that consecutive
          autoincrement numbers will be used in a batch of inserts.
          Default value: <code class="literal">32</code>. Minimum value:
          <code class="literal">1</code>.
        </p><p>
          Beginning with MySQL 5.0.56, this variable affects the number
          of <code class="literal">AUTO_INCREMENT</code> IDs that are fetched
          between statements only. Within a statement, at least 32 IDs
          are now obtained at a time. The default value for
          <a href="mysql-cluster.html#sysvar_ndb_autoincrement_prefetch_sz"><code class="literal">ndb_autoincrement_prefetch_sz</code></a>
          is now <code class="literal">1</code>, to increase the speed of
          statements inserting single rows. (<a href="http://bugs.mysql.com/31956" target="_top">Bug#31956</a>)
        </p></li><li><p><a name="sysvar_ndb_cache_check_time"></a>
          <a href="mysql-cluster.html#sysvar_ndb_cache_check_time"><code class="literal">ndb_cache_check_time</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_cache_check_time</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_cache_check_time</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="mysql-cluster.html#sysvar_ndb_cache_check_time"><code class="literal">ndb_cache_check_time</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_cache_check_time</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The number of milliseconds that elapse between checks of MySQL
          Cluster SQL nodes by the MySQL query cache. Setting this to 0
          (the default and minimum value) means that the query cache
          checks for validation on every query.
        </p><p>
          The recommended maximum value for this variable is 1000, which
          means that the check is performed once per second. A larger
          value means that the check is performed and possibly
          invalidated due to updates on different SQL nodes less often.
          It is generally not desirable to set this to a value greater
          than 2000.
        </p></li><li><p><a name="sysvar_ndb_force_send"></a>
          <a href="mysql-cluster.html#sysvar_ndb_force_send"><code class="literal">ndb_force_send</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-force-send</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_force_send</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="mysql-cluster.html#sysvar_ndb_force_send"><code class="literal">ndb_force_send</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_force_send</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Forces sending of buffers to <code class="literal">NDB</code>
          immediately, without waiting for other threads. Defaults to
          <code class="literal">ON</code>.
        </p></li><li><p><a name="sysvar_ndb_index_stat_cache_entries"></a>
          <a href="mysql-cluster.html#sysvar_ndb_index_stat_cache_entries"><code class="literal">ndb_index_stat_cache_entries</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_index_stat_cache_entries</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_index_stat_cache_entries</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4294967295</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Sets the granularity of the statistics by determining the
          number of starting and ending keys to store in the statistics
          memory cache. Zero means no caching takes place; in this case,
          the data nodes are always queried directly. Default value:
          <code class="literal">32</code>.
        </p></li><li><p><a name="sysvar_ndb_index_stat_enable"></a>
          <a href="mysql-cluster.html#sysvar_ndb_index_stat_enable"><code class="literal">ndb_index_stat_enable</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_index_stat_enable</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_index_stat_enable</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Use <code class="literal">NDB</code> index statistics in query
          optimization. Defaults to <code class="literal">ON</code>.
        </p></li><li><p><a name="sysvar_ndb_index_stat_update_freq"></a>
          <a href="mysql-cluster.html#sysvar_ndb_index_stat_update_freq"><code class="literal">ndb_index_stat_update_freq</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_index_stat_update_freq</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_index_stat_update_freq</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">20</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4294967295</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          How often to query data nodes instead of the statistics cache.
          For example, a value of <code class="literal">20</code> (the default)
          means to direct every 20<sup>th</sup> query to
          the data nodes.
        </p></li><li><p><a name="sysvar_ndb_optimized_node_selection"></a>
          <a href="mysql-cluster.html#sysvar_ndb_optimized_node_selection"><code class="literal">ndb_optimized_node_selection</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-optimized-node-selection</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_optimized_node_selection</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Causes an SQL node to use the “<span class="quote">closest</span>” data node
          as transaction coordinator. For this purpose, a data node
          having a shared memory connection with the SQL node is
          considered to be “<span class="quote">closest</span>” to the SQL node; the
          next closest (in order of decreasing proximity) are: TCP
          connection to <code class="literal">localhost</code>; SCI connection;
          TCP connection from a host other than
          <code class="literal">localhost</code>.
        </p><p>
          This option is enabled by default. Set to <code class="literal">0</code>
          or <code class="literal">OFF</code> to disable it, in which case the SQL
          node uses each data node in the cluster in succession. When
          this option is disabled each SQL thread attempts to use a
          given data node 8 times before proceeding to the next one.
        </p></li><li><p><a name="sysvar_ndb_report_thresh_binlog_epoch_slip"></a>
          <a href="mysql-cluster.html#sysvar_ndb_report_thresh_binlog_epoch_slip"><code class="literal">ndb_report_thresh_binlog_epoch_slip</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_report_thresh_binlog_epoch_slip</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_report_thresh_binlog_epoch_slip</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">3</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-256</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This is a threshold on the number of epochs to be behind
          before reporting binlog status. For example, a value of
          <code class="literal">3</code> (the default) means that if the
          difference between which epoch has been received from the
          storage nodes and which epoch has been applied to the binlog
          is 3 or more, a status message will be sent to the cluster
          log.
        </p></li><li><p><a name="sysvar_ndb_report_thresh_binlog_mem_usage"></a>
          <a href="mysql-cluster.html#sysvar_ndb_report_thresh_binlog_mem_usage"><code class="literal">ndb_report_thresh_binlog_mem_usage</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_report_thresh_binlog_mem_usage</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_report_thresh_binlog_mem_usage</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">10</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-10</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This is a threshold on the percentage of free memory remaining
          before reporting binlog status. For example, a value of
          <code class="literal">10</code> (the default) means that if the amount
          of available memory for receiving binlog data from the data
          nodes falls below 10%, a status message will be sent to the
          cluster log.
        </p></li><li><p><a name="sysvar_ndb_use_exact_count"></a>
          <a href="mysql-cluster.html#sysvar_ndb_use_exact_count"><code class="literal">ndb_use_exact_count</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_use_exact_count</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Forces <code class="literal">NDB</code> to use a count of
          records during <code class="literal">SELECT COUNT(*)</code> query
          planning to speed up this type of query. The default value is
          <code class="literal">ON</code>. For faster queries overall, disable
          this feature by setting the value of
          <a href="mysql-cluster.html#sysvar_ndb_use_exact_count"><code class="literal">ndb_use_exact_count</code></a> to
          <code class="literal">OFF</code>.
        </p></li><li><p><a name="sysvar_ndb_use_transactions"></a>
          <a href="mysql-cluster.html#sysvar_ndb_use_transactions"><code class="literal">ndb_use_transactions</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb_use_transactions</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">ndb_use_transactions</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_use_transactions</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          You can disable <code class="literal">NDB</code> transaction
          support by setting this variable's values to
          <code class="literal">OFF</code> (not recommended). The default is
          <code class="literal">ON</code>.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-status-variables"></a>17.4.4. MySQL Cluster Status Variables</h3></div></div></div><p>
      This section provides detailed information about MySQL server
      status variables that relate to MySQL Cluster and the
      <code class="literal">NDB</code> storage engine. For status
      variables not specific to MySQL Cluster, and for general
      information on using status variables, see
      <a href="server-administration.html#server-status-variables" title="5.1.6. Server Status Variables">Section 5.1.6, “Server Status Variables”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="statvar_Handler_discover"></a>
          <a href="mysql-cluster.html#statvar_Handler_discover"><code class="literal">Handler_discover</code></a>
        </p><p>
          The MySQL server can ask the
          <code class="literal">NDBCLUSTER</code> storage engine if it
          knows about a table with a given name. This is called
          discovery. <a href="mysql-cluster.html#statvar_Handler_discover"><code class="literal">Handler_discover</code></a>
          indicates the number of times that tables have been discovered
          via this mechanism.
        </p></li><li><p><a name="statvar_Ndb_cluster_node_id"></a>
          <a href="mysql-cluster.html#statvar_Ndb_cluster_node_id"><code class="literal">Ndb_cluster_node_id</code></a>
        </p><p>
          If the server is acting as a MySQL Cluster node, then the
          value of this variable its node ID in the cluster.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p></li><li><p><a name="statvar_Ndb_config_from_host"></a>
          <a href="mysql-cluster.html#statvar_Ndb_config_from_host"><code class="literal">Ndb_config_from_host</code></a>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the host name or IP address of the Cluster
          management server from which it gets its configuration data.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is an empty string.
        </p><p>
          Prior to MySQL 5.0.23, this variable was named
          <code class="literal">Ndb_connected_host</code>.
        </p></li><li><p><a name="statvar_Ndb_config_from_port"></a>
          <a href="mysql-cluster.html#statvar_Ndb_config_from_port"><code class="literal">Ndb_config_from_port</code></a>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the number of the port through which it is
          connected to the Cluster management server from which it gets
          its configuration data.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p><p>
          Prior to MySQL 5.0.23, this variable was named
          <code class="literal">Ndb_connected_port</code>.
        </p></li><li><p><a name="statvar_Ndb_number_of_data_nodes"></a>
          <a href="mysql-cluster.html#statvar_Ndb_number_of_data_nodes"><code class="literal">Ndb_number_of_data_nodes</code></a>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the number of data nodes in the cluster.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p><p>
          Prior to MySQL 5.0.29, this variable was named
          <code class="literal">Ndb_number_of_storage_nodes</code>.
        </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-upgrade-downgrade"></a>17.5. Upgrading and Downgrading MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-rolling-restart">17.5.1. Performing a Rolling Restart of a MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility">17.5.2. MySQL Cluster 5.0 Upgrade and Downgrade Compatibility</a></span></dt></dl></div><a class="indexterm" name="id2279798"></a><a class="indexterm" name="id2279811"></a><a class="indexterm" name="id2279823"></a><p>
    This portion of the MySQL Cluster chapter covers upgrading and
    downgrading a MySQL Cluster from one MySQL release to another. It
    discusses different types of Cluster upgrades and downgrades, and
    provides a Cluster upgrade/downgrade compatibility matrix (see
    <a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility" title="17.5.2. MySQL Cluster 5.0 Upgrade and Downgrade Compatibility">Section 17.5.2, “MySQL Cluster 5.0 Upgrade and Downgrade Compatibility”</a>).
    You are expected already to be familiar with installing and
    configuring a MySQL Cluster prior to attempting an upgrade or
    downgrade. See <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a>.
  </p><p>
    This section remains in development, and continues to be updated and
    expanded.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-rolling-restart"></a>17.5.1. Performing a Rolling Restart of a MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2279865"></a><a class="indexterm" name="id2279877"></a><a class="indexterm" name="id2279886"></a><a class="indexterm" name="id2279899"></a><a class="indexterm" name="id2279911"></a><p>
      This section discusses how to perform a <em class="firstterm">rolling
      restart</em> of a MySQL Cluster installation, so called
      because it involves stopping and starting (or restarting) each
      node in turn, so that the cluster itself remains operational. This
      is often done as part of a <em class="firstterm">rolling upgrade</em>
      or <em class="firstterm">rolling downgrade</em>, where high
      availability of the cluster is mandatory and no downtime of the
      cluster as a whole is permissible. Where we refer to upgrades, the
      information provided here also generally applies to downgrades as
      well.
    </p><p>
      There are a number of reasons why a rolling restart might be
      desirable:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Cluster configuration change. </b><a class="indexterm" name="id2279953"></a>
            To make a change in the cluster's configuration, such
            as adding an SQL node to the cluster, or setting a
            configuration parameter to a new value.
          </p></li><li><p><b>Cluster software upgrade/downgrade. </b>
            To upgrade the cluster to a newer version of the MySQL
            Cluster software (or to downgrade it to an older version).
            This is usually referred to as a “<span class="quote">rolling
            upgrade</span>” (or “<span class="quote">rolling downgrade</span>”, when
            reverting to an older version of MySQL Cluster).
          </p></li><li><p><b>Change on node host. </b>
            To make changes in the hardware or operating system on which
            one or more cluster nodes are running.
          </p></li><li><p><b>Cluster reset. </b><a class="indexterm" name="id2280017"></a>
            To reset the cluster because it has reached an undesirable
            state. In such cases it is often desirable to reload the
            data and metadata of one or more data nodes. This can be
            done 1 of 3 ways:

            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  Start each data node process (<span><strong class="command">ndbd</strong></span>,
                  or possibly <span><strong class="command">ndbmtd</strong></span> in MySQL Cluster
                  NDB 7.0 and later) with the
                  <a href="mysql-cluster.html#option_ndbd_initial"><code class="option">--initial</code></a> option, which
                  forces the data node to clear its filesystem and
                  reload data and metadata from the other data nodes.
                </p></li><li><p>
                  Create a backup using the <span><strong class="command">ndb_mgm</strong></span>
                  client <code class="literal">BACKUP</code> command prior to
                  performing the restart. Following the upgrade, restore
                  the node or nodes using
                  <span><strong class="command">ndb_restore</strong></span>.
                </p><p>
                  See <a href="mysql-cluster.html#mysql-cluster-backup" title="17.7.3. Online Backup of MySQL Cluster">Section 17.7.3, “Online Backup of MySQL Cluster”</a>, and
                  <a href="mysql-cluster.html#mysql-cluster-programs-ndb-restore" title="17.6.15. ndb_restore — Restore a MySQL Cluster Backup">Section 17.6.15, “<span><strong class="command">ndb_restore</strong></span> — Restore a MySQL Cluster Backup”</a>,
                  for more information.
                </p></li><li><p>
                  Use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> (see
                  <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program">Section 4.5.4, “<span><strong class="command">mysqldump</strong></span> — A Database Backup Program”</a>) to create a backup prior
                  to the upgrade; afterwards, restore the dump using
                  <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
                  INFILE</code></a>.
                </p></li></ul></div><p>
          </p></li><li><p><b>Freeing of resources. </b><a class="indexterm" name="id2280142"></a>
            To allow memory allocated to a table by successive
            <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> and
            <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> operations to be freed
            for re-use by other MySQL Cluster tables.
          </p></li></ul></div><p>
      The process for performing a rolling restart may be generalized as
      follows:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Stop all cluster management nodes (<span><strong class="command">ndb_mgmd</strong></span>
          processes), reconfigure them, then restart them.
        </p></li><li><p>
          Stop, reconfigure, then restart each cluster data node
          (<span><strong class="command">ndbd</strong></span> process) in turn.
        </p></li><li><p>
          Stop, reconfigure, then restart each cluster SQL node
          (<a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process) in turn.
        </p></li></ol></div><p>
      The specifics for implementing a particular rolling upgrade depend
      upon the actual changes being made. A more detailed view of the
      process is presented here:
    </p><div class="mediaobject"><img src="images/rolling-restarts.png" width="421" height="543" alt="MySQL Cluster Rolling Restarts (By
        Type)"></div><p>
      In the previous diagram, the <span class="bold"><strong>Stop</strong></span>
      and <span class="bold"><strong>Start</strong></span> steps indicate that the
      process must be stopped completely using a shell command (such as
      <a href="sql-syntax.html#kill" title="12.5.6.3. KILL Syntax"><span><strong class="command">kill</strong></span></a> on most Unix systems) or the management
      client <code class="literal">STOP</code> command, then started again from a
      system shell by invoking the <span><strong class="command">ndbd</strong></span> or
      <span><strong class="command">ndb_mgmd</strong></span> executable as appropriate.
      <span class="bold"><strong>Restart</strong></span> indicates the process may
      be restarted using the <span><strong class="command">ndb_mgm</strong></span> management
      client <code class="literal">RESTART</code> command.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        When performing an upgrade or downgrade of the cluster software,
        you <span class="emphasis"><em>must</em></span> upgrade or downgrade the
        management nodes <span class="emphasis"><em>first</em></span>, then the data
        nodes, and finally the SQL nodes. Doing so in any other order
        may leave the cluster in an unusable state.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-upgrade-downgrade-compatibility"></a>17.5.2. MySQL Cluster 5.0 Upgrade and Downgrade Compatibility</h3></div></div></div><a class="indexterm" name="id2280347"></a><a class="indexterm" name="id2280360"></a><a class="indexterm" name="id2280372"></a><a class="indexterm" name="id2280385"></a><p>
      This section provides information about MySQL Cluster software and
      table file compatibility between MySQL 5.0 releases
      with regard to performing upgrades and downgrades.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Only compatibility between MySQL versions with regard to
        <code class="literal">NDBCLUSTER</code> is taken into account in
        this section, and there are likely other issues to be
        considered. <span class="emphasis"><em>As with any other MySQL software upgrade
        or downgrade, you are strongly encouraged to review the relevant
        portions of the MySQL Manual for the MySQL versions from which
        and to which you intend to migrate, before attempting an upgrade
        or downgrade of the MySQL Cluster software</em></span>. See
        <a href="installing.html#upgrade" title="2.18.1. Upgrading MySQL">Section 2.18.1, “Upgrading MySQL”</a>.
      </p></div><p>
      The following table shows Cluster upgrade and downgrade
      compatibility between different releases of MySQL
      5.0:
    </p><div class="mediaobject"><img src="images/mysql-cluster-upgrade-downgrade-5-0.png" width="158" height="1340" alt="MySQL Cluster upgrade/downgrade compatibility,
        MySQL 5.0"></div><p><b>Notes. </b>
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              MySQL 5.0.2 was the first public release in this series.
            </p></li><li><p>
              Direct upgrades or downgrades between MySQL Cluster 4.1
              and 5.0 are not supported; you must dump all
              <code class="literal">NDBCLUSTER</code> tables using
              <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>, install the new version of
              the software, and then reload the tables from the dump.
            </p></li><li><p>
              Online downgrades from MySQL Cluster 5.0.12 to 5.0.11 (or
              earlier) are not supported.
            </p></li><li><p>
              You cannot restore with <span><strong class="command">ndb_restore</strong></span> to
              a MySQL 5.0 Cluster using a backup made from a Cluster
              running MySQL 5.1. You must use
              <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> in such cases.
            </p></li><li><p>
              There was no public release of MySQL 5.0.23.
            </p></li></ul></div><p>
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-programs"></a>17.6. MySQL Cluster Programs</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-mysqld">17.6.1. MySQL Server Usage for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndbd">17.6.2. <span><strong class="command">ndbd</strong></span> — The MySQL Cluster Data Node Daemon</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgmd">17.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgm">17.6.4. <span><strong class="command">ndb_mgm</strong></span> — The MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-config">17.6.5. <span><strong class="command">ndb_config</strong></span> — Extract MySQL Cluster Configuration Information</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-cpcd">17.6.6. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-delete-all">17.6.7. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-desc">17.6.8. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-drop-index">17.6.9. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-drop-table">17.6.10. <span><strong class="command">ndb_drop_table</strong></span> — Drop an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-error-reporter">17.6.11. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-backup-file">17.6.12. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-schema-file">17.6.13. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-print-sys-file">17.6.14. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-restore">17.6.15. <span><strong class="command">ndb_restore</strong></span> — Restore a MySQL Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-select-all">17.6.16. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from an NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-select-count">17.6.17. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-show-tables">17.6.18. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-size-pl">17.6.19. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-programs-ndb-waiter">17.6.20. <span><strong class="command">ndb_waiter</strong></span> — Wait for MySQL Cluster to Reach a Given Status</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-common">17.6.21. Options Common to MySQL Cluster Programs</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-tables">17.6.22. Summary Tables of NDB Program Options</a></span></dt></dl></div><a class="indexterm" name="id2280643"></a><a class="indexterm" name="id2280655"></a><a class="indexterm" name="id2280664"></a><a class="indexterm" name="id2280674"></a><a class="indexterm" name="id2280682"></a><a class="indexterm" name="id2280692"></a><a class="indexterm" name="id2280700"></a><a class="indexterm" name="id2280709"></a><a class="indexterm" name="id2280718"></a><a class="indexterm" name="id2280727"></a><a class="indexterm" name="id2280736"></a><a class="indexterm" name="id2280745"></a><a class="indexterm" name="id2280754"></a><a class="indexterm" name="id2280763"></a><a class="indexterm" name="id2280772"></a><a class="indexterm" name="id2280781"></a><a class="indexterm" name="id2280790"></a><a class="indexterm" name="id2280799"></a><a class="indexterm" name="id2280808"></a><a class="indexterm" name="id2280817"></a><a class="indexterm" name="id2280826"></a><a class="indexterm" name="id2280834"></a><a class="indexterm" name="id2280843"></a><a class="indexterm" name="id2280852"></a><a class="indexterm" name="id2280861"></a><p>
    Using and managing a MySQL Cluster requires several specialized
    programs, which we describe in this chapter. We discuss the purposes
    of these programs in a MySQL Cluster, how to use the programs, and
    what startup options are available for each of them.
  </p><p>
    These programs include the MySQL Cluster data, management, and SQL
    node process daemons (<span><strong class="command">ndbd</strong></span>,
    <span><strong class="command">ndb_mgmd</strong></span>, and <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>) and the
    management client (<span><strong class="command">ndb_mgm</strong></span>).
  </p><p>
    Other NDB utility, diagnostic, and example programs are included
    with the MySQL Cluster distribution. These include
    <span><strong class="command">ndb_restore</strong></span>, <span><strong class="command">ndb_show_tables</strong></span>,
    and <span><strong class="command">ndb_config</strong></span>). These programs are covered later
    in this chapter.
  </p><p>
    The last two sections of this chapter contain tables of options
    used, respectively, with <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> and with the
    various NDB programs.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-mysqld"></a>17.6.1. MySQL Server Usage for MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2280947"></a><a class="indexterm" name="id2280960"></a><a class="indexterm" name="id2280972"></a><a class="indexterm" name="id2280985"></a><a class="indexterm" name="id2280994"></a><p>
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> is the traditional MySQL server process.
      To be used with MySQL Cluster, <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> needs to
      be built with support for the
      <code class="literal">NDBCLUSTER</code> storage engine, as it is
      in the precompiled binaries available from
      <a href="http://dev.mysql.com/downloads/" target="_top">http://dev.mysql.com/downloads/</a>. If you build MySQL from
      source, you must invoke <span><strong class="command">configure</strong></span> with the
      <code class="option">--with-ndbcluster</code> option to enable <code class="literal">NDB
      Cluster</code> storage engine support.
    </p><p>
      If the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> binary has been built with
      Cluster support, the <code class="literal">NDBCLUSTER</code>
      storage engine is still disabled by default. You can use either of
      two possible options to enable this engine:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Use <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> as a startup
          option on the command line when starting
          <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>.
        </p></li><li><p>
          Insert a line containing
          <code class="literal">NDBCLUSTER</code> in the
          <code class="literal">[mysqld]</code> section of your
          <code class="filename">my.cnf</code> file.
        </p></li></ul></div><p>
      An easy way to verify that your server is running with the
      <code class="literal">NDBCLUSTER</code> storage engine enabled is
      to issue the <a href="sql-syntax.html#show-engines" title="12.5.5.13. SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> statement
      in the MySQL Monitor (<a href="programs.html#mysql" title="4.5.1. mysql — The MySQL Command-Line Tool"><span><strong class="command">mysql</strong></span></a>). You should see
      the value <code class="literal">YES</code> as the <code class="literal">Support</code>
      value in the row for <code class="literal">NDBCLUSTER</code>. If
      you see <code class="literal">NO</code> in this row or if there is no such
      row displayed in the output, you are not running an
      <code class="literal">NDB</code>-enabled version of MySQL. If you
      see <code class="literal">DISABLED</code> in this row, you need to enable it
      in either one of the two ways just described.
    </p><a class="indexterm" name="id2281193"></a><a class="indexterm" name="id2281205"></a><a class="indexterm" name="id2281214"></a><p>
      To read cluster configuration data, the MySQL server requires at a
      minimum three pieces of information:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The MySQL server's own cluster node ID
        </p></li><li><p>
          The host name or IP address for the management server (MGM
          node)
        </p></li><li><p>
          The number of the TCP/IP port on which it can connect to the
          management server
        </p></li></ul></div><p>
      Node IDs can be allocated dynamically, so it is not strictly
      necessary to specify them explicitly.
    </p><p>
      The <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> parameter
      <code class="literal">ndb-connectstring</code> is used to specify the
      connectstring either on the command line when starting
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> or in <code class="filename">my.cnf</code>. The
      connectstring contains the host name or IP address where the
      management server can be found, as well as the TCP/IP port it
      uses.
    </p><p>
      In the following example, <code class="literal">ndb_mgmd.mysql.com</code> is
      the host where the management server resides, and the management
      server listens for cluster messages on port 1186:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld --ndbcluster --ndb-connectstring=ndb_mgmd.mysql.com:1186</code></strong>
</pre><p>
      See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, for more
      information on connectstrings.
    </p><p>
      Given this information, the MySQL server will be a full
      participant in the cluster. (We often refer to a
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process running in this manner as an SQL
      node.) It will be fully aware of all cluster data nodes as well as
      their status, and will establish connections to all data nodes. In
      this case, it is able to use any data node as a transaction
      coordinator and to read and update node data.
    </p><p>
      You can see in the <a href="programs.html#mysql" title="4.5.1. mysql — The MySQL Command-Line Tool"><span><strong class="command">mysql</strong></span></a> client whether a MySQL
      server is connected to the cluster using <a href="sql-syntax.html#show-processlist" title="12.5.5.27. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a>. If the MySQL server is connected to the
      cluster, and you have the <a href="server-administration.html#priv_process"><code class="literal">PROCESS</code></a>
      privilege, then the first row of the output is as shown here:
    </p><pre class="programlisting">mysql&gt; SHOW PROCESSLIST \G
*************************** 1. row ***************************
     Id: 1
   User: system user
   Host:
     db:
Command: Daemon
   Time: 1
  State: Waiting for event from ndbcluster
   Info: NULL
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        To participate in a MySQL Cluster, the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>
        process must be started with <span class="emphasis"><em>both</em></span> the
        options <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> and
        <code class="option">--ndb-connectstring</code> (or their equivalents in
        <code class="filename">my.cnf</code>). If <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> is
        started with only the
        <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option, or if it is
        unable to contact the cluster, it is not possible to work with
        <code class="literal">NDB</code> tables, <span class="emphasis"><em>nor is it
        possible to create any new tables regardless of storage
        engine</em></span>. The latter restriction is a safety measure
        intended to prevent the creation of tables having the same names
        as <code class="literal">NDB</code> tables while the SQL node is
        not connected to the cluster. If you wish to create tables using
        a different storage engine while the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>
        process is not participating in a MySQL Cluster, you must
        restart the server <span class="emphasis"><em>without</em></span> the
        <a href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndbd"></a>17.6.2. <span><strong class="command">ndbd</strong></span> — The MySQL Cluster Data Node Daemon</h3></div></div></div><a class="indexterm" name="id2281476"></a><a class="indexterm" name="id2281484"></a><a class="indexterm" name="id2281496"></a><a class="indexterm" name="id2281507"></a><a class="indexterm" name="id2281515"></a><p>
          <span><strong class="command">ndbd</strong></span> is the process that is used to handle
          all the data in tables using the NDB Cluster storage engine.
          This is the process that empowers a data node to accomplish
          distributed transaction handling, node recovery, checkpointing
          to disk, online backup, and related tasks.
        </p><p>
          In a MySQL Cluster, a set of <span><strong class="command">ndbd</strong></span> processes
          cooperate in handling data. These processes can execute on the
          same computer (host) or on different computers. The
          correspondences between data nodes and Cluster hosts is
          completely configurable.
        </p><a class="indexterm" name="id2281551"></a><a class="indexterm" name="id2281563"></a><a class="indexterm" name="id2281576"></a><a class="indexterm" name="id2281588"></a><p>
          The following list describes command options specific to the
          MySQL Cluster data node program <span><strong class="command">ndbd</strong></span>. For
          options common to all <code class="literal">NDBCLUSTER</code>
          programs, see
          <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
        </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_ndbd_bind-address"></a>
              <code class="option">--bind-address</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.29</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--bind-address=name</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Causes <span><strong class="command">ndbd</strong></span> to bind to a specific
              network interface (host name or IP address). This option
              has no default value.
            </p><p>
              This option was added in MySQL 5.0.29.
            </p></li><li><p><a name="option_ndbd_daemon"></a>
              <code class="option">--daemon</code>, <code class="option">-d</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--daemon</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndbd</strong></span> to execute as a daemon
              process. This is the default behavior.
              <code class="option">--nodaemon</code> can be used to prevent the
              process from running as a daemon.
            </p></li><li><a class="indexterm" name="id2281828"></a><p><a name="option_ndbd_initial"></a>
              <code class="option">--initial</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--initial</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndbd</strong></span> to perform an initial
              start. An initial start erases any files created for
              recovery purposes by earlier instances of
              <span><strong class="command">ndbd</strong></span>. It also re-creates recovery log
              files. Note that on some operating systems this process
              can take a substantial amount of time.
            </p><p>
              An <code class="option">--initial</code> start is to be used
              <span class="emphasis"><em>only</em></span> when starting the
              <span><strong class="command">ndbd</strong></span> process under very special
              circumstances; this is because this option causes all
              files to be removed from the Cluster file system and all
              redo log files to be re-created. These circumstances are
              listed here:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  When performing a software upgrade which has changed
                  the contents of any files.
                </p></li><li><p>
                  When restarting the node with a new version of
                  <span><strong class="command">ndbd</strong></span>.
                </p></li><li><p>
                  As a measure of last resort when for some reason the
                  node restart or system restart repeatedly fails. In
                  this case, be aware that this node can no longer be
                  used to restore data due to the destruction of the
                  data files.
                </p></li></ul></div><p>
              Use of this option prevents the
              <code class="literal">StartPartialTimeout</code> and
              <code class="literal">StartPartitionedTimeout</code> configuration
              parameters from having any effect.
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                This option does <span class="emphasis"><em>not</em></span> affect any
                backup files that have already been created by the
                affected node.
              </p></div><p>
              It is permissible to use this option when starting the
              cluster for the very first time (that is, before any data
              node files have been created); however, it is
              <span class="emphasis"><em>not</em></span> necessary to do so.
            </p></li><li><a class="indexterm" name="id2282023"></a><p><a name="option_ndbd_initial-start"></a>
              <code class="option">--initial-start</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.21</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--initial-start</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              This option is used when performing a partial initial
              start of the cluster. Each node should be started with
              this option, as well as <code class="option">--nowait-nodes</code>.
            </p><p>
              For example, suppose you have a 4-node cluster whose data
              nodes have the IDs 2, 3, 4, and 5, and you wish to perform
              a partial initial start using only nodes 2, 4, and 5
              — that is, omitting node 3:
            </p><pre class="programlisting">ndbd --ndbd-nodeid=2 --nowait-nodes=3 --initial-start
ndbd --ndbd-nodeid=4 --nowait-nodes=3 --initial-start
ndbd --ndbd-nodeid=5 --nowait-nodes=3 --initial-start
</pre><p>
              This option was added in MySQL 5.0.21.
            </p></li><li><a class="indexterm" name="id2282148"></a><p><a name="option_ndbd_nowait-nodes"></a>
              <code class="option">--nowait-nodes=<em class="replaceable"><code>node_id_1</code></em>[,
              <em class="replaceable"><code>node_id_2</code></em>[, ...]]</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.21</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--nowait-nodes=list</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              This option takes a list of data nodes which for which the
              cluster will not wait for before starting.
            </p><p>
              This can be used to start the cluster in a partitioned
              state. For example, to start the cluster with only half of
              the data nodes (nodes 2, 3, 4, and 5) running in a 4-node
              cluster, you can start each <span><strong class="command">ndbd</strong></span>
              process with <code class="option">--nowait-nodes=3,5</code>. In this
              case, the cluster starts as soon as nodes 2 and 4 connect,
              and does <span class="emphasis"><em>not</em></span> wait
              <code class="literal">StartPartitionedTimeout</code> milliseconds
              for nodes 3 and 5 to connect as it would otherwise.
            </p><p>
              If you wanted to start up the same cluster as in the
              previous example without one <span><strong class="command">ndbd</strong></span>
              — say, for example, that the host machine for node 3
              has suffered a hardware failure — then start nodes
              2, 4, and 5 with <code class="option">--nowait-nodes=3</code>. Then
              the cluster will start as soon as nodes 2, 4, and 5
              connect and will not wait for node 3 to start.
            </p><p>
              This option was added in MySQL 5.0.21.
            </p></li><li><a class="indexterm" name="id2282305"></a><p><a name="option_ndbd_nodaemon"></a>
              <code class="option">--nodaemon</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--nodaemon</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndbd</strong></span> not to start as a daemon
              process. This is useful when <span><strong class="command">ndbd</strong></span> is
              being debugged and you want output to be redirected to the
              screen.
            </p></li><li><a class="indexterm" name="id2282410"></a><a class="indexterm" name="id2282419"></a><p><a name="option_ndbd_nostart"></a>
              <code class="option">--nostart</code>, <code class="option">-n</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--nostart</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndbd</strong></span> not to start
              automatically. When this option is used,
              <span><strong class="command">ndbd</strong></span> connects to the management server,
              obtains configuration data from it, and initializes
              communication objects. However, it does not actually start
              the execution engine until specifically requested to do so
              by the management server. This can be accomplished by
              issuing the proper <code class="literal">START</code> command in the
              management client (see
              <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="17.7.2. Commands in the MySQL Cluster Management Client">Section 17.7.2, “Commands in the MySQL Cluster Management Client”</a>).
            </p></li></ul></div><a class="indexterm" name="id2282540"></a><a class="indexterm" name="id2282552"></a><p>
          <span><strong class="command">ndbd</strong></span> generates a set of log files which are
          placed in the directory specified by
          <code class="literal">DataDir</code> in the
          <code class="filename">config.ini</code> configuration file.
        </p><p>
          These log files are listed below.
          <em class="replaceable"><code>node_id</code></em> is the node's unique
          identifier. Note that <em class="replaceable"><code>node_id</code></em>
          represents the node's unique identifier. For example,
          <code class="filename">ndb_2_error.log</code> is the error log
          generated by the data node whose node ID is
          <code class="literal">2</code>.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2282612"></a><a class="indexterm" name="id2282624"></a><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_error.log</code>
              is a file containing records of all crashes which the
              referenced <span><strong class="command">ndbd</strong></span> process has
              encountered. Each record in this file contains a brief
              error string and a reference to a trace file for this
              crash. A typical entry in this file might appear as shown
              here:
            </p><pre class="programlisting">Date/Time: Saturday 30 July 2004 - 00:20:01
Type of error: error
Message: Internal program error (failed ndbrequire)
Fault ID: 2341
Problem data: DbtupFixAlloc.cpp
Object of reference: DBTUP (Line: 173)
ProgramName: NDB Kernel
ProcessID: 14909
TraceFile: ndb_2_trace.log.2
***EOM***
</pre><p>
              Listings of possible <span><strong class="command">ndbd</strong></span> exit codes
              and messages generated when a data node process shuts down
              prematurely can be found in
              <a href="http://dev.mysql.com/doc/ndbapi/en/ndbd-error-messages.html" target="_top"><code class="literal">ndbd</code> Error Messages</a>.
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                <span class="emphasis"><em>The last entry in the error log file is not
                necessarily the newest one</em></span> (nor is it likely
                to be). Entries in the error log are
                <span class="emphasis"><em>not</em></span> listed in chronological order;
                rather, they correspond to the order of the trace files
                as determined in the
                <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.next</code>
                file (see below). Error log entries are thus overwritten
                in a cyclical and not sequential fashion.
              </p></div></li><li><a class="indexterm" name="id2282712"></a><a class="indexterm" name="id2282724"></a><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.<em class="replaceable"><code>trace_id</code></em></code>
              is a trace file describing exactly what happened just
              before the error occurred. This information is useful for
              analysis by the MySQL Cluster development team.
            </p><p>
              It is possible to configure the number of these trace
              files that will be created before old files are
              overwritten. <em class="replaceable"><code>trace_id</code></em> is a
              number which is incremented for each successive trace
              file.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.next</code>
              is the file that keeps track of the next trace file number
              to be assigned.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
              is a file containing any data output by the
              <span><strong class="command">ndbd</strong></span> process. This file is created only
              if <span><strong class="command">ndbd</strong></span> is started as a daemon, which
              is the default behavior.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>.pid</code>
              is a file containing the process ID of the
              <span><strong class="command">ndbd</strong></span> process when started as a daemon.
              It also functions as a lock file to avoid the starting of
              nodes with the same identifier.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_signal.log</code>
              is a file used only in debug versions of
              <span><strong class="command">ndbd</strong></span>, where it is possible to trace all
              incoming, outgoing, and internal messages with their data
              in the <span><strong class="command">ndbd</strong></span> process.
            </p></li></ul></div><p>
          It is recommended not to use a directory mounted through NFS
          because in some environments this can cause problems whereby
          the lock on the <code class="filename">.pid</code> file remains in
          effect even after the process has terminated.
        </p><p>
          To start <span><strong class="command">ndbd</strong></span>, it may also be necessary to
          specify the host name of the management server and the port on
          which it is listening. Optionally, one may also specify the
          node ID that the process is to use.
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd --connect-string="nodeid=2;host=ndb_mgmd.mysql.com:1186"</code></strong>
</pre><p>
          See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, for
          additional information about this issue.
          <a href="mysql-cluster.html#mysql-cluster-programs-ndbd" title="17.6.2. ndbd — The MySQL Cluster Data Node Daemon">Section 17.6.2, “<span><strong class="command">ndbd</strong></span> — The MySQL Cluster Data Node Daemon”</a>, describes other
          options for <span><strong class="command">ndbd</strong></span>.
        </p><p>
          When <span><strong class="command">ndbd</strong></span> starts, it actually initiates two
          processes. The first of these is called the “<span class="quote">angel
          process</span>”; its only job is to discover when the
          execution process has been completed, and then to restart the
          <span><strong class="command">ndbd</strong></span> process if it is configured to do so.
          Thus, if you attempt to kill <span><strong class="command">ndbd</strong></span> via the
          Unix <a href="sql-syntax.html#kill" title="12.5.6.3. KILL Syntax"><span><strong class="command">kill</strong></span></a> command, it is necessary to kill
          both processes, beginning with the angel process. The
          preferred method of terminating an <span><strong class="command">ndbd</strong></span>
          process is to use the management client and stop the process
          from there.
        </p><p>
          The execution process uses one thread for reading, writing,
          and scanning data, as well as all other activities. This
          thread is implemented asynchronously so that it can easily
          handle thousands of concurrent actions. In addition, a
          watch-dog thread supervises the execution thread to make sure
          that it does not hang in an endless loop. A pool of threads
          handles file I/O, with each thread able to handle one open
          file. Threads can also be used for transporter connections by
          the transporters in the <span><strong class="command">ndbd</strong></span> process. In a
          multi-processor system performing a large number of operations
          (including updates), the <span><strong class="command">ndbd</strong></span> process can
          consume up to 2 CPUs if permitted to do so.
        </p><p>
          For a machine with many CPUs it is possible to use several
          <span><strong class="command">ndbd</strong></span> processes which belong to different
          node groups; however, such a configuration is still considered
          experimental and is not supported for MySQL 5.0
          in a production setting. See
          <a href="mysql-cluster.html#mysql-cluster-limitations" title="17.10. Known Limitations of MySQL Cluster">Section 17.10, “Known Limitations of MySQL Cluster”</a>.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-mgmd"></a>17.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon</h3></div></div></div><a class="indexterm" name="id2283014"></a><a class="indexterm" name="id2283022"></a><a class="indexterm" name="id2283033"></a><a class="indexterm" name="id2283045"></a><a class="indexterm" name="id2283056"></a><p>
          The management server is the process that reads the cluster
          configuration file and distributes this information to all
          nodes in the cluster that request it. It also maintains a log
          of cluster activities. Management clients can connect to the
          management server and check the cluster's status.
        </p><a class="indexterm" name="id2283075"></a><a class="indexterm" name="id2283087"></a><a class="indexterm" name="id2283100"></a><a class="indexterm" name="id2283112"></a><p>
          The following list includes options that are specific to
          <span><strong class="command">ndb_mgmd</strong></span>. For options common to all NDB
          programs, see
          <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2283144"></a><a class="indexterm" name="id2283153"></a><a class="indexterm" name="id2283162"></a><p><a name="option_ndb_mgmd_config-file"></a>
              <code class="option">--config-file=<em class="replaceable"><code>filename</code></em></code>,
              <code class="option">-f <em class="replaceable"><code>filename</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">-c</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">filename</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">./config.ini</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs the management server as to which file it should
              use for its configuration file. By default, the management
              server looks for a file named
              <code class="filename">config.ini</code> in the same directory as
              the <span><strong class="command">ndb_mgmd</strong></span> executable; otherwise the
              file name and location must be specified explicitly.
            </p><p>
              This option also can be given as <code class="option">-c
              <em class="replaceable"><code>file_name</code></em></code>, but this
              shortcut is obsolete and should <span class="emphasis"><em>not</em></span>
              be used in new installations.
            </p></li><li><a class="indexterm" name="id2283291"></a><a class="indexterm" name="id2283300"></a><p><a name="option_ndb_mgmd_daemon"></a>
              <code class="option">--daemon</code>, <code class="option">-d</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--daemon</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndb_mgmd</strong></span> to start as a daemon
              process. This is the default behavior.
            </p></li><li><a class="indexterm" name="id2283402"></a><p><a name="option_ndb_mgmd_nodaemon"></a>
              <code class="option">--nodaemon</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--nodaemon</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Instructs <span><strong class="command">ndb_mgmd</strong></span> not to start as a
              daemon process.
            </p></li><li><a class="indexterm" name="id2283500"></a><a class="indexterm" name="id2283509"></a><p><a name="option_ndb_mgmd_print-full-config"></a>
              <code class="option">--print-full-config</code>, <code class="option">-P</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.0.10</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--print-full-config</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Shows extended information regarding the configuration of
              the cluster. With this option on the command line the
              <span><strong class="command">ndb_mgmd</strong></span> process prints information
              about the cluster setup including an extensive list of the
              cluster configuration sections as well as parameters and
              their values. Normally used together with the
              <code class="option">--config-file</code> (<code class="option">-f</code>)
              option.
            </p></li></ul></div><p>
          It is not strictly necessary to specify a connectstring when
          starting the management server. However, if you are using more
          than one management server, a connectstring should be provided
          and each node in the cluster should specify its node ID
          explicitly.
        </p><p>
          See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, for
          information about using connectstrings.
          <a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgmd" title="17.6.3. ndb_mgmd — The MySQL Cluster Management Server Daemon">Section 17.6.3, “<span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon”</a>, describes
          other options for <span><strong class="command">ndb_mgmd</strong></span>.
        </p><p>
          The following files are created or used by
          <span><strong class="command">ndb_mgmd</strong></span> in its starting directory, and are
          placed in the <code class="literal">DataDir</code> as specified in the
          <code class="filename">config.ini</code> configuration file. In the
          list that follows, <em class="replaceable"><code>node_id</code></em> is the
          unique node identifier.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2283686"></a><a class="indexterm" name="id2283698"></a><a class="indexterm" name="id2283707"></a><p>
              <code class="filename">config.ini</code> is the configuration file
              for the cluster as a whole. This file is created by the
              user and read by the management server.
              <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a>, discusses
              how to set up this file.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>
              is the cluster events log file. Examples of such events
              include checkpoint startup and completion, node startup
              events, node failures, and levels of memory usage. A
              complete listing of cluster events with descriptions may
              be found in <a href="mysql-cluster.html#mysql-cluster-management" title="17.7. Management of MySQL Cluster">Section 17.7, “Management of MySQL Cluster”</a>.
            </p><p>
              When the size of the cluster log reaches one million
              bytes, the file is renamed to
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log.<em class="replaceable"><code>seq_id</code></em></code>,
              where <em class="replaceable"><code>seq_id</code></em> is the sequence
              number of the cluster log file. (For example: If files
              with the sequence numbers 1, 2, and 3 already exist, the
              next log file is named using the number
              <code class="literal">4</code>.)
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
              is the file used for <code class="literal">stdout</code> and
              <code class="literal">stderr</code> when running the management
              server as a daemon.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>.pid</code>
              is the process ID file used when running the management
              server as a daemon.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-mgm"></a>17.6.4. <span><strong class="command">ndb_mgm</strong></span> — The MySQL Cluster Management Client</h3></div></div></div><a class="indexterm" name="id2283844"></a><a class="indexterm" name="id2283852"></a><a class="indexterm" name="id2283863"></a><a class="indexterm" name="id2283875"></a><a class="indexterm" name="id2283886"></a><a class="indexterm" name="id2283897"></a><a class="indexterm" name="id2283908"></a><p>
          The <span><strong class="command">ndb_mgm</strong></span> management client process is
          actually not needed to run the cluster. Its value lies in
          providing a set of commands for checking the cluster's status,
          starting backups, and performing other administrative
          functions. The management client accesses the management
          server using a C API. Advanced users can also employ this API
          for programming dedicated management processes to perform
          tasks similar to those performed by
          <span><strong class="command">ndb_mgm</strong></span>.
        </p><p>
          To start the management client, it is necessary to supply the
          host name and port number of the management server:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm [<em class="replaceable"><code>host_name</code></em> [<em class="replaceable"><code>port_num</code></em>]]</code></strong>
</pre><p>
          For example:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm ndb_mgmd.mysql.com 1186</code></strong>
</pre><p>
          The default host name and port number are
          <code class="literal">localhost</code> and 1186, respectively.
        </p><a class="indexterm" name="id2283985"></a><a class="indexterm" name="id2283997"></a><a class="indexterm" name="id2284010"></a><a class="indexterm" name="id2284022"></a><p>
          The following list includes options that are specific to
          <span><strong class="command">ndb_mgm</strong></span>. For options common to all NDB
          programs, see
          <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
        </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_ndb_mgm_try-reconnect"></a>
              <code class="option">--try-reconnect=<em class="replaceable"><code>number</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--try-reconnect=#</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              If the connection to the management server is broken, the
              node tries to reconnect to it every 5 seconds until it
              succeeds. By using this option, it is possible to limit
              the number of attempts to
              <em class="replaceable"><code>number</code></em> before giving up and
              reporting an error instead.
            </p></li></ul></div><p>
          Additional information about using <span><strong class="command">ndb_mgm</strong></span>
          can be found in
          <a href="mysql-cluster.html#mysql-cluster-program-options-ndb-mgm" title="17.6.22.4. Program Options for ndb_mgm">Section 17.6.22.4, “Program Options for <span><strong class="command">ndb_mgm</strong></span>”</a>, and
          <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="17.7.2. Commands in the MySQL Cluster Management Client">Section 17.7.2, “Commands in the MySQL Cluster Management Client”</a>.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-config"></a>17.6.5. <span><strong class="command">ndb_config</strong></span> — Extract MySQL Cluster Configuration Information</h3></div></div></div><a class="indexterm" name="id2284178"></a><p>
          This tool extracts configuration information for data nodes,
          SQL nodes, and API nodes from a cluster management node (and
          possibly its <code class="filename">config.ini</code> file).
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_config <em class="replaceable"><code>options</code></em>
</pre><p>
          The <em class="replaceable"><code>options</code></em> available for this
          utility differ somewhat from those used with the other
          utilities, and so are listed in their entirety in the next
          section, followed by some examples.
        </p><p>
          <span class="bold"><strong>Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_ndb_config_usage"></a>
              <a class="indexterm" name="id2284242"></a>

              <a class="indexterm" name="id2284255"></a>

              <code class="option">--usage</code>, <code class="option">--help</code>, or
              <code class="option">-?</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--help</code></td></tr></tbody></table></div><p>
              Causes <span><strong class="command">ndb_config</strong></span> to print a list of
              available options, and then exit.
            </p></li><li><p><a name="option_ndb_config_version"></a>
              <a class="indexterm" name="id2284328"></a>

              <a class="indexterm" name="id2284340"></a>

              <code class="option">--version</code>, <code class="option">-V</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">-V</code></td></tr></tbody></table></div><p>
              Causes <span><strong class="command">ndb_config</strong></span> to print a version
              information string, and then exit.
            </p></li><li><p><a name="option_ndb_config_ndb-connectstring"></a>
              <a class="indexterm" name="id2284409"></a>

              <a class="indexterm" name="id2284422"></a>

              <code class="option">--ndb-connectstring=<em class="replaceable"><code>connect_string</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-connectstring=name</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">localhost:1186</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Specifies the connectstring to use in connecting to the
              management server. The format for the connectstring is the
              same as described in
              <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, and
              defaults to <code class="literal">localhost:1186</code>.
            </p><p>
              The use of <code class="option">-c</code> as a short version for this
              option is supported for <span><strong class="command">ndb_config</strong></span>
              beginning with MySQL 5.0.29.
            </p></li><li><p><a name="option_ndb_config_config-file"></a>
              <a class="indexterm" name="id2284546"></a>

              <a class="indexterm" name="id2284558"></a>

              <code class="option">--config-file=<em class="replaceable"><code>path-to-file</code></em></code>
            </p><p>
              Gives the path to the management server's configuration
              file (<code class="filename">config.ini</code>). This may be a
              relative or absolute path. If the management node resides
              on a different host from the one on which
              <span><strong class="command">ndb_config</strong></span> is invoked, then an absolute
              path must be used.
            </p></li><li><p><a name="option_ndb_config_query"></a>
              <a class="indexterm" name="id2284604"></a>

              <a class="indexterm" name="id2284616"></a>

              <code class="option">--query=<em class="replaceable"><code>query-options</code></em></code>,
              <code class="option">-q</code>
              <em class="replaceable"><code>query-options</code></em>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--query=string</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              This is a comma-delimited list of <em class="firstterm">query
              options</em> — that is, a list of one or more
              node attributes to be returned. These include
              <code class="literal">id</code> (node ID), type (node type —
              that is, <code class="literal">ndbd</code>,
              <code class="literal">mysqld</code>, or
              <code class="literal">ndb_mgmd</code>), and any configuration
              parameters whose values are to be obtained.
            </p><p>
              For example,

              <a class="indexterm" name="id2284745"></a>

              <a class="indexterm" name="id2284758"></a>

              <code class="option">--query=id,type,indexmemory,datamemory</code>
              would return the node ID, node type,
              <code class="literal">DataMemory</code>, and
              <code class="literal">IndexMemory</code> for each node.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If a given parameter is not applicable to a certain type
                of node, than an empty string is returned for the
                corresponding value. See the examples later in this
                section for more information.
              </p></div></li><li><p><a name="option_ndb_config_host"></a>
              <a class="indexterm" name="id2284804"></a>

              <a class="indexterm" name="id2284816"></a>

              <code class="option">--host=<em class="replaceable"><code>hostname</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--host=name</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Specifies the host name of the node for which
              configuration information is to be obtained.
            </p></li><li><p><a name="option_ndb_config_id"></a>
              <a class="indexterm" name="id2284914"></a>

              <a class="indexterm" name="id2284926"></a>

              <code class="option">--id=<em class="replaceable"><code>node_id</code></em></code>,

              <a class="indexterm" name="id2284945"></a>

              <a class="indexterm" name="id2284957"></a>

              <code class="option">--nodeid=<em class="replaceable"><code>node_id</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-nodeid=#</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Used to specify the node ID of the node for which
              configuration information is to be obtained.
            </p></li><li><p><a name="option_ndb_config_nodes"></a>
              <a class="indexterm" name="id2285056"></a>

              <a class="indexterm" name="id2285068"></a>

              <code class="option">--nodes</code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--nodes</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              (Tells <span><strong class="command">ndb_config</strong></span> to print information
              from parameters defined in <code class="literal">[ndbd]</code>
              sections only. Currently, using this option has no affect,
              since these are the only values checked, but it may become
              possible in future to query parameters set in
              <code class="literal">[tcp]</code> and other sections of cluster
              configuration files.)
            </p></li><li><p><a name="option_ndb_config_type"></a>
              <a class="indexterm" name="id2285184"></a>

              <a class="indexterm" name="id2285196"></a>

              <code class="option">--type=<em class="replaceable"><code>node_type</code></em></code>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--type=name</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">enumeration</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr><tr><td><span class="bold"><strong>Valid Values</strong></span></td><td><code class="literal">ndbd</code>, <code class="literal">mysqld</code>, <code class="literal">ndb_mgmd</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Filters results so that only configuration values applying
              to nodes of the specified
              <em class="replaceable"><code>node_type</code></em>
              (<code class="literal">ndbd</code>, <code class="literal">mysqld</code>, or
              <code class="literal">ndb_mgmd</code>) are returned.
            </p></li><li><p><a name="option_ndb_config_fields"></a>
              <a class="indexterm" name="id2285340"></a>

              <a class="indexterm" name="id2285352"></a>

              <code class="option">--fields=<em class="replaceable"><code>delimiter</code></em></code>,
              <code class="option">-f</code> <em class="replaceable"><code>delimiter</code></em>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--fields=string</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Specifies a <em class="replaceable"><code>delimiter</code></em> string
              used to separate the fields in the result. The default is
              “<span class="quote"><code class="literal">,</code></span>” (the comma character).
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If the <em class="replaceable"><code>delimiter</code></em> contains
                spaces or escapes (such as <code class="literal">\n</code> for the
                linefeed character), then it must be quoted.
              </p></div></li><li><p><a name="option_ndb_config_rows"></a>
              <a class="indexterm" name="id2285484"></a>

              <a class="indexterm" name="id2285496"></a>

              <code class="option">--rows=<em class="replaceable"><code>separator</code></em></code>,
              <code class="option">-r</code> <em class="replaceable"><code>separator</code></em>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--rows=string</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
              Specifies a <em class="replaceable"><code>separator</code></em> string
              used to separate the rows in the result. The default is a
              space character.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If the <em class="replaceable"><code>separator</code></em> contains
                spaces or escapes (such as <code class="literal">\n</code> for the
                linefeed character), then it must be quoted.
              </p></div></li></ul></div><p>
          <span class="bold"><strong>Examples</strong></span>:
        </p><div class="orderedlist"><ol type="1"><li><p>
              To obtain the node ID and type of each node in the
              cluster:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --query=id,type --fields=':' --rows='\n'</code></strong>
1:ndbd
2:ndbd
3:ndbd
4:ndbd
5:ndb_mgmd
6:mysqld
7:mysqld
8:mysqld
9:mysqld
</pre><p>
              In this example, we used the <code class="option">--fields</code>
              options to separate the ID and type of each node with a
              colon character (<code class="literal">:</code>), and the
              <code class="option">--rows</code> options to place the values for
              each node on a new line in the output.
            </p></li><li><p>
              To produce a connectstring that can be used by data, SQL,
              and API nodes to connect to the management server:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --config-file=usr/local/mysql/cluster-data/config.ini --query=hostname,portnumber --fields=: --rows=, --type=ndb_mgmd</code></strong>
192.168.0.179:1186

</pre></li><li><p>
              This invocation of <span><strong class="command">ndb_config</strong></span> checks
              only data nodes (using the <code class="option">--type</code>
              option), and shows the values for each node's ID and host
              name, and its <code class="literal">DataMemory</code>,
              <code class="literal">IndexMemory</code>, and
              <code class="literal">DataDir</code> parameters:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --type=ndbd --query=id,host,datamemory,indexmemory,datadir -f ' : ' -r '\n'</code></strong>
1 : 192.168.0.193 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
2 : 192.168.0.112 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
3 : 192.168.0.176 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
4 : 192.168.0.119 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
</pre><p>
              In this example, we used the short options
              <code class="option">-f</code> and <code class="option">-r</code> for setting
              the field delimiter and row separator, respectively.
            </p></li><li><p>
              To exclude results from any host except one in particular,
              use the <code class="option">--host</code> option:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --host=192.168.0.176 -f : -r '\n' -q id,type</code></strong>
3:ndbd
5:ndb_mgmd
</pre><p>
              In this example, we also used the short form
              <code class="option">-q</code> to determine the attributes to be
              queried.
            </p><p>
              Similarly, you can limit results to a node with a specific
              ID using the <code class="option">--id</code> or
              <code class="option">--nodeid</code> option.
            </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-cpcd"></a>17.6.6. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</h3></div></div></div><a class="indexterm" name="id2285809"></a><p>
          This utility is found in the <code class="filename">libexec</code>
          directory. It is part of an internal automated test framework
          used in testing and debugging MySQL Cluster. Because it can
          control processes on remote systems, it is not advisable to
          use <span><strong class="command">ndb_cpcd</strong></span> in a production cluster.
        </p><p>
          The source files for <span><strong class="command">ndb_cpcd</strong></span> may be found
          in the directory <code class="filename">storage/ndb/src/cw/cpcd</code>,
          in the MySQL source tree.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-delete-all"></a>17.6.7. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from an NDB Table</h3></div></div></div><a class="indexterm" name="id2285865"></a><p>
          <span><strong class="command">ndb_delete_all</strong></span> deletes all rows from the
          given <code class="literal">NDB</code> table. In some cases,
          this can be much faster than
          <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> or even
          <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_delete_all -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          This deletes all rows from the table named
          <em class="replaceable"><code>tbl_name</code></em> in the database named
          <em class="replaceable"><code>db_name</code></em>. It is exactly equivalent
          to executing <code class="literal">TRUNCATE
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em></code>
          in MySQL.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2285971"></a>

              <a class="indexterm" name="id2285983"></a>

              <code class="option">--transactional</code>, <code class="option">-t</code>
            </p><p>
              Use of this option causes the delete operation to be
              performed as a single transaction.
            </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
                With very large tables, using this option may cause the
                number of operations available to the cluster to be
                exceeded.
              </p></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-desc"></a>17.6.8. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</h3></div></div></div><a class="indexterm" name="id2286031"></a><p>
          <span><strong class="command">ndb_desc</strong></span> provides a detailed description of
          one or more <code class="literal">NDB</code> tables.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_desc -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em> [-p]
</pre><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><p>
          MySQL table creation and population statements:
        </p><pre class="programlisting">USE test;

CREATE TABLE fish (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(20),

    PRIMARY KEY pk (id),
    UNIQUE KEY uk (name)
) ENGINE=NDBCLUSTER;

INSERT INTO fish VALUES
    ('','guppy'), ('','tuna'), ('','shark'),
    ('','manta ray'), ('','grouper'), ('','puffer');
</pre><p>
          Output from <span><strong class="command">ndb_desc</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_desc -c localhost fish -d test -p</code></strong>
-- fish --
Version: 16777221
Fragment type: 5
K Value: 6
Min load factor: 78
Max load factor: 80
Temporary table: no
Number of attributes: 2
Number of primary keys: 1
Length of frm data: 268
Row Checksum: 1
Row GCI: 1
TableStatus: Retrieved
-- Attributes --
id Int PRIMARY KEY DISTRIBUTION KEY AT=FIXED ST=MEMORY
name Varchar(20;latin1_swedish_ci) NULL AT=SHORT_VAR ST=MEMORY

-- Indexes --
PRIMARY KEY(id) - UniqueHashIndex
uk(name) - OrderedIndex
PRIMARY(id) - OrderedIndex
uk$unique(name) - UniqueHashIndex

-- Per partition info --
Partition  Row count  Commit count  Frag fixed memory  Frag varsized memory
2          2          2             65536              327680
1          2          2             65536              327680
3          2          2             65536              327680

NDBT_ProgramExit: 0 - OK
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2286148"></a>

              <a class="indexterm" name="id2286160"></a>

              <code class="option">--extra-partition-info</code>,
              <code class="option">-p</code>
            </p><p>
              Prints additional information about the table's
              partitions.
            </p></li><li><p>
              Information about multiple tables can be obtained in a
              single invocation of <span><strong class="command">ndb_desc</strong></span> by using
              their names, separated by spaces. All of the tables must
              be in the same database.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-drop-index"></a>17.6.9. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from an NDB Table</h3></div></div></div><a class="indexterm" name="id2286215"></a><p>
          <span><strong class="command">ndb_drop_index</strong></span> drops the specified index
          from an <code class="literal">NDB</code> table. <span class="emphasis"><em>It
          is recommended that you use this utility only as an example
          for writing NDB API applications</em></span> — see the
          Warning later in this section for details.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_drop_index -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>table_name</code></em> <em class="replaceable"><code>index</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          The statement shown above drops the index named
          <em class="replaceable"><code>index</code></em> from the
          <em class="replaceable"><code>table</code></em> in the
          <em class="replaceable"><code>database</code></em>.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None that
          are specific to this application.
        </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
            <span class="emphasis"><em>Operations performed on Cluster table indexes
            using the NDB API are not visible to MySQL and make the
            table unusable by a MySQL server</em></span>. If you use this
            program to drop an index, then try to access the table from
            an SQL node, an error results, as shown here:
          </p></div><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_drop_index -c localhost dogs ix -d ctest1</code></strong>
Dropping index dogs/idx...OK

NDBT_ProgramExit: 0 - OK

shell&gt; <strong class="userinput"><code>./mysql -u jon -p ctest1</code></strong>
Enter password: *******
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 7 to server version: 5.1.12-beta-20060817

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; SHOW TABLES;
+------------------+
| Tables_in_ctest1 |
+------------------+
| a                |
| bt1              |
| bt2              |
| dogs             |
| employees        |
| fish             |
+------------------+
6 rows in set (0.00 sec)

mysql&gt; SELECT * FROM dogs;
<span class="errortext">ERROR 1296 (HY000): Got error 4243 'Index not found' from NDBCLUSTER</span>
</pre><p>
          In such a case, your <span class="emphasis"><em>only</em></span> option for
          making the table available to MySQL again is to drop the table
          and re-create it. You can use either the SQL
          statement<a href="sql-syntax.html#drop-table" title="12.1.17. DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or the
          <span><strong class="command">ndb_drop_table</strong></span> utility (see
          <a href="mysql-cluster.html#mysql-cluster-programs-ndb-drop-table" title="17.6.10. ndb_drop_table — Drop an NDB Table">Section 17.6.10, “<span><strong class="command">ndb_drop_table</strong></span> — Drop an NDB Table”</a>) to
          drop the table.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-drop-table"></a>17.6.10. <span><strong class="command">ndb_drop_table</strong></span> — Drop an NDB Table</h3></div></div></div><a class="indexterm" name="id2286381"></a><p>
          <span><strong class="command">ndb_drop_table</strong></span> drops the specified
          <code class="literal">NDB</code> table. (If you try to use
          this on a table created with a storage engine other than NDB,
          it fails with the error <span class="errortext">723: No such table
          exists</span>.) This operation is extremely fast —
          in some cases, it can be an order of magnitude faster than
          using <a href="sql-syntax.html#drop-table" title="12.1.17. DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> on an
          <code class="literal">NDB</code> table from MySQL.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_drop_table -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-error-reporter"></a>17.6.11. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</h3></div></div></div><a class="indexterm" name="id2286477"></a><a class="indexterm" name="id2286484"></a><p>
          <span><strong class="command">ndb_error_reporter</strong></span> creates an archive from
          data node and management node log files that can be used to
          help diagnose bugs or other problems with a cluster.
          <span class="emphasis"><em>It is highly recommended that you make use of this
          utility when filing reports of bugs in MySQL
          Cluster</em></span>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_error_reporter <em class="replaceable"><code>path/to/config-file</code></em> [<em class="replaceable"><code>username</code></em>] [--fs]
</pre><p>
          This utility is intended for use on a management node host,
          and requires the path to the management host configuration
          file (<code class="filename">config.ini</code>). Optionally, you can
          supply the name of a user that is able to access the cluster's
          data nodes via SSH, in order to copy the data node log files.
          ndb_error_reporter then includes all of these files in archive
          that is created in the same directory in which it is run. The
          archive is named
          <code class="filename">ndb_error_report_<em class="replaceable"><code>YYYYMMDDHHMMSS</code></em>.tar.bz2</code>,
          where <em class="replaceable"><code>YYYYMMDDHHMMSS</code></em> is a datetime
          string.
        </p><p><a name="option_ndb_error_reporter_fs"></a>
          If the <code class="option">--fs</code> is used, then the data node file
          systems are also copied to the management host and included in
          the archive that is produced by this script. As data node file
          systems can be extremely large even after being compressed, we
          ask that you please do <span class="emphasis"><em>not</em></span> send archives
          created using this option to Sun Microsystems, Inc. unless you
          are specifically requested to do so.
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--fs</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-print-backup-file"></a>17.6.12. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</h3></div></div></div><a class="indexterm" name="id2286662"></a><p>
          <span><strong class="command">ndb_print_backup_file</strong></span> obtains diagnostic
          information from a cluster backup file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_backup_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          backup file. This can be any of the files
          (<code class="filename">.Data</code>, <code class="filename">.ctl</code>, or
          <code class="filename">.log</code> file) found in a cluster backup
          directory. These files are found in the data node's backup
          directory under the subdirectory
          <code class="filename">BACKUP-<em class="replaceable"><code>#</code></em></code>,
          where <em class="replaceable"><code>#</code></em> is the sequence number for
          the backup. For more information about cluster backup files
          and their contents, see
          <a href="mysql-cluster.html#mysql-cluster-backup-concepts" title="17.7.3.1. MySQL Cluster Backup Concepts">Section 17.7.3.1, “MySQL Cluster Backup Concepts”</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_schema_file</strong></span> and
          <span><strong class="command">ndb_print_sys_file</strong></span> (and unlike most of the
          other <code class="literal">NDB</code> utilities that are
          intended to be run on a management server host or to connect
          to a management server)
          <span><strong class="command">ndb_print_backup_file</strong></span> must be run on a
          cluster data node, since it accesses the data node file system
          directly. Because it does not make use of the management
          server, this utility can be used when the management server is
          not running, and even when the cluster has been completely
          shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-print-schema-file"></a>17.6.13. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</h3></div></div></div><a class="indexterm" name="id2286804"></a><p>
          <span><strong class="command">ndb_print_schema_file</strong></span> obtains diagnostic
          information from a cluster schema file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_schema_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          schema file. For more information about cluster schema files,
          see <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndbd-filesystem.html#ndb-internals-ndbd-filesystemdir-files" target="_top">Cluster Data Node <code class="literal">FileSystemDir</code> Files</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_backup_file</strong></span> and
          <span><strong class="command">ndb_print_sys_file</strong></span> (and unlike most of the
          other <code class="literal">NDB</code> utilities that are
          intended to be run on a management server host or to connect
          to a management server)
          <span><strong class="command">ndb_schema_backup_file</strong></span> must be run on a
          cluster data node, since it accesses the data node file system
          directly. Because it does not make use of the management
          server, this utility can be used when the management server is
          not running, and even when the cluster has been completely
          shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-print-sys-file"></a>17.6.14. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</h3></div></div></div><a class="indexterm" name="id2286921"></a><p>
          <span><strong class="command">ndb_print_sys_file</strong></span> obtains diagnostic
          information from a MySQL Cluster system file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_sys_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          system file (sysfile). Cluster system files are located in a
          data node's data directory (<code class="literal">DataDir</code>); the
          path under this directory to system files matches the pattern
          <code class="filename">ndb_<em class="replaceable"><code>#</code></em>_fs/D<em class="replaceable"><code>#</code></em>/DBDIH/P<em class="replaceable"><code>#</code></em>.sysfile</code>.
          In each case, the <em class="replaceable"><code>#</code></em> represents a
          number (not necessarily the same number). For more
          information, see
          <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndbd-filesystem.html#ndb-internals-ndbd-filesystemdir-files" target="_top">Cluster Data Node <code class="literal">FileSystemDir</code> Files</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_backup_file</strong></span> and
          <span><strong class="command">ndb_print_schema_file</strong></span> (and unlike most of
          the other <code class="literal">NDB</code> utilities that are
          intended to be run on a management server host or to connect
          to a management server)
          <span><strong class="command">ndb_print_backup_file</strong></span> must be run on a
          cluster data node, since it accesses the data node file system
          directly. Because it does not make use of the management
          server, this utility can be used when the management server is
          not running, and even when the cluster has been completely
          shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-restore"></a>17.6.15. <span><strong class="command">ndb_restore</strong></span> — Restore a MySQL Cluster Backup</h3></div></div></div><a class="indexterm" name="id2287066"></a><a class="indexterm" name="id2287077"></a><a class="indexterm" name="id2287088"></a><a class="indexterm" name="id2287100"></a><a class="indexterm" name="id2287111"></a><p>
          The cluster restoration program is implemented as a separate
          command-line utility <span><strong class="command">ndb_restore</strong></span>, which can
          normally be found in the MySQL <code class="filename">bin</code>
          directory. This program reads the files created as a result of
          the backup and inserts the stored information into the
          database.
        </p><p>
          <span><strong class="command">ndb_restore</strong></span> must be executed once for each
          of the backup files that were created by the <code class="literal">START
          BACKUP</code> command used to create the backup (see
          <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup">Section 17.7.3.2, “Using The MySQL Cluster Management Client to Create a Backup”</a>).
          This is equal to the number of data nodes in the cluster at
          the time that the backup was created.
        </p><a class="indexterm" name="id2287159"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Before using <span><strong class="command">ndb_restore</strong></span>, it is
            recommended that the cluster be running in single user mode,
            unless you are restoring multiple data nodes in parallel.
            See <a href="mysql-cluster.html#mysql-cluster-single-user-mode" title="17.7.6. MySQL Cluster Single User Mode">Section 17.7.6, “MySQL Cluster Single User Mode”</a>, for
            more information about single user mode.
          </p></div><p>
          Typical options for this utility are shown here:
        </p><pre class="programlisting">ndb_restore [-c <em class="replaceable"><code>connectstring</code></em>] -n
<em class="replaceable"><code>node_id</code></em> [-m] -b <em class="replaceable"><code>backup_id</code></em> -r --backup_path=<em class="replaceable"><code>/path/to/backup/files</code></em>
</pre><p>
          The <code class="option">-c</code> option is used to specify a
          connectstring which tells <code class="literal">ndb_restore</code> where
          to locate the cluster management server. (See
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>, for information
          on connectstrings.) If this option is not used, then
          <span><strong class="command">ndb_restore</strong></span> attempts to connect to a
          management server on <code class="literal">localhost:1186</code>. This
          utility acts as a cluster API node, and so requires a free
          connection “<span class="quote">slot</span>” to connect to the cluster
          management server. This means that there must be at least one
          <code class="literal">[api]</code> or <code class="literal">[mysqld]</code>
          section that can be used by it in the cluster
          <code class="filename">config.ini</code> file. It is a good idea to
          keep at least one empty <code class="literal">[api]</code> or
          <code class="literal">[mysqld]</code> section in
          <code class="filename">config.ini</code> that is not being used for a
          MySQL server or other application for this reason (see
          <a href="mysql-cluster.html#mysql-cluster-api-definition" title="17.3.4.6. Defining SQL and Other API Nodes in a MySQL Cluster">Section 17.3.4.6, “Defining SQL and Other API Nodes in a MySQL Cluster”</a>).
        </p><p>
          You can verify that <span><strong class="command">ndb_restore</strong></span> is
          connected to the cluster by using the <span><strong class="command">SHOW</strong></span>
          command in the <span><strong class="command">ndb_mgm</strong></span> management client.
          You can also accomplish this from a system shell, as shown
          here:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "SHOW"</code></strong>
</pre><p>
          <code class="option">-n</code> is used to specify the node ID of the data
          node on which the backups were taken.
        </p><p>
          The first time you run the <span><strong class="command">ndb_restore</strong></span>
          restoration program, you also need to restore the metadata. In
          other words, you must re-create the database tables —
          this can be done by running it with the <code class="option">-m</code>
          option. Note that the cluster should have an empty database
          when starting to restore a backup. (In other words, you should
          start <span><strong class="command">ndbd</strong></span> with <code class="option">--initial</code>
          prior to performing the restore.)
        </p><p>
          The <code class="option">-b</code> option is used to specify the ID or
          sequence number of the backup, and is the same number shown by
          the management client in the <code class="literal">Backup
          <em class="replaceable"><code>backup_id</code></em> completed</code>
          message displayed upon completion of a backup. (See
          <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup">Section 17.7.3.2, “Using The MySQL Cluster Management Client to Create a Backup”</a>.)
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            When restoring cluster backups, you must be sure to restore
            all data nodes from backups having the same backup ID. Using
            files from different backups will at best result in
            restoring the cluster to an inconsistent state, and may fail
            altogether.
          </p></div><p>
          The path to the backup directory is required; this is supplied
          to <span><strong class="command">ndb_restore</strong></span> using the
          <code class="option">--backup_path</code> option, and must include the
          subdirectory corresponding to the ID backup of the backup to
          be restored. For example, if the data node's
          <code class="literal">DataDir</code> is
          <code class="filename">/var/lib/mysql-cluster</code>, then the backup
          directory is
          <code class="filename">/var/lib/mysql-cluster/BACKUP</code>, and the
          backup files for the backup with the ID 3 can be found in
          <code class="filename">/var/lib/mysql-cluster/BACKUP/BACKUP-3</code>.
          The path may be absolute or relative to the directory in which
          the <span><strong class="command">ndb_restore</strong></span> executable is located.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Previous to MySQL 5.0.38, the path to the backup directory
            was specified as shown here, with
            <code class="option">backup_path=</code> being optional:
          </p><pre class="programlisting">[backup_path=]<em class="replaceable"><code>/path/to/backup/files</code></em>
</pre><p>
            Beginning with MySQL 5.0.38, this syntax changed to
            <code class="option">--backup_path=<em class="replaceable"><code>/path/to/backup/files</code></em></code>,
            to conform more closely with options used by other MySQL
            programs; <code class="option">--backup_id</code> is required, and
            there is no short form for this option.
          </p></div><p>
          It is possible to restore a backup to a database with a
          different configuration than it was created from. For example,
          suppose that a backup with backup ID <code class="literal">12</code>,
          created in a cluster with two database nodes having the node
          IDs <code class="literal">2</code> and <code class="literal">3</code>, is to be
          restored to a cluster with four nodes. Then
          <span><strong class="command">ndb_restore</strong></span> must be run twice — once
          for each database node in the cluster where the backup was
          taken. However, <span><strong class="command">ndb_restore</strong></span> cannot always
          restore backups made from a cluster running one version of
          MySQL to a cluster running a different MySQL version. See
          <a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility" title="17.5.2. MySQL Cluster 5.0 Upgrade and Downgrade Compatibility">Section 17.5.2, “MySQL Cluster 5.0 Upgrade and Downgrade Compatibility”</a>,
          for more information.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            It is not possible to restore a backup made from a newer
            version of MySQL Cluster using an older version of
            <span><strong class="command">ndb_restore</strong></span>. You can restore a backup
            made from a newer version of MySQL to an older cluster, but
            you must use a copy of <span><strong class="command">ndb_restore</strong></span> from
            the newer MySQL Cluster version to do so.
          </p><p>
            For example, to restore a cluster backup taken from a
            cluster running MySQL 5.0.45 to a cluster running MySQL
            Cluster 5.0.41, you must use a copy of
            <span><strong class="command">ndb_restore</strong></span> from the 5.0.45 distribution.
          </p></div><p>
          For more rapid restoration, the data may be restored in
          parallel, provided that there is a sufficient number of
          cluster connections available. That is, when restoring to
          multiple nodes in parallel, you must have an
          <code class="literal">[api]</code> or <code class="literal">[mysqld]</code>
          section in the cluster <code class="filename">config.ini</code> file
          available for each concurrent <span><strong class="command">ndb_restore</strong></span>
          process. However, the data files must always be applied before
          the logs.
        </p><p>
          Most of the options available for this program are shown in
          the following table:
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Long Form</strong></span></td><td><span class="bold"><strong>Short Form</strong></span></td><td><span class="bold"><strong>Description</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td></tr><tr><td><code class="option">--backup-id</code></td><td><code class="option">-b</code></td><td>Backup sequence ID</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--backup_path</code> (added in MySQL 5.0.38; previously this
                  was <code class="option">backup_path</code> — see Note in
                  text)</td><td><span class="emphasis"><em>None</em></span></td><td>Path to backup files</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--character-sets-dir</code></td><td><span class="emphasis"><em>None</em></span></td><td>Specify the directory where character set information can be found</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--connect</code>, <code class="option">--connectstring</code>, or
                  <code class="option">--ndb-connectstring</code></td><td><code class="option">-c</code> or <code class="option">-C</code></td><td>Set the connectstring in
                  <code class="literal">[nodeid=<em class="replaceable"><code>node_id;][host=]</code></em><em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
                  format</td><td><code class="literal">localhost:1186</code></td></tr><tr><td><code class="option">--core-file</code></td><td><span class="emphasis"><em>None</em></span></td><td>Write a core file in the event of an error</td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="option">--debug</code></td><td><code class="option">-#</code></td><td>Output debug log</td><td><code class="literal">d:t:O,<code class="filename">/tmp/ndb_restore.trace</code></code></td></tr><tr><td><code class="option">--help</code> or <code class="option">--usage</code></td><td><code class="option">-?</code></td><td>Display help message with available options and current values, then
                  exit</td><td>[N/A]</td></tr><tr><td><code class="option">--ndb-mgmd-host</code></td><td><span class="emphasis"><em>None</em></span></td><td>Set the host and port in
                  <code class="literal"><em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
                  format for the management server to connect to; this
                  is the same as <code class="option">--connect</code>,
                  <code class="option">--connectstring</code>, or
                  <code class="option">--ndb-connectstring</code>, but without a
                  way to specify the <code class="literal">nodeid</code></td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--ndb-nodeid</code></td><td><span class="emphasis"><em>None</em></span></td><td>Specify a node ID for the <span><strong class="command">ndb_restore</strong></span> process</td><td><code class="literal">0</code></td></tr><tr><td><code class="option">--ndb-optimized-node-selection</code></td><td><span class="emphasis"><em>None</em></span></td><td>Optimize selection of nodes for transactions</td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="option">--ndb-shm</code></td><td><span class="emphasis"><em>None</em></span></td><td>Use shared memory connections when available</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--nodeid</code></td><td><code class="option">-n</code></td><td>Use backup files from node with the specified ID</td><td><code class="literal">0</code></td></tr><tr><td><code class="option">--parallelism</code></td><td><code class="option">-p</code></td><td>Set from 1 to 1024 parallel transactions to be used during the
                  restoration process</td><td><code class="literal">128</code></td></tr><tr><td><code class="option">--print</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print metadata, data, and log to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_data</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print data to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_log</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print log to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_meta</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print metadata to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--restore_data</code></td><td><code class="option">-r</code></td><td>Restore data and logs</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--restore_meta</code></td><td><code class="option">-m</code></td><td>Restore table metadata</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--version</code></td><td><code class="option">-V</code></td><td>Output version information and exit</td><td>[N/A]</td></tr></tbody></table></div><p>
          Beginning with MySQL 5.0.40, several additional options are
          available for use with the <code class="option">--print_data</code>
          option in generating data dumps, either to
          <code class="literal">stdout</code>, or to a file. These are similar to
          some of the options used with <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>,
          and are shown in the following table:

          </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Long Form</strong></span></td><td><span class="bold"><strong>Short Form</strong></span></td><td><span class="bold"><strong>Description</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td></tr><tr><td><a href="programs.html#option_mysqldump_tab"><code class="option">--tab</code></a></td><td><code class="option">-T</code></td><td>Creates dumpfiles, one per table, each named
                    <code class="filename"><em class="replaceable"><code>tbl_name</code></em>.txt</code>.
                    Takes as its argument the path to the directory
                    where the files should be saved (required; use
                    <code class="literal">.</code> for the current directory).</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-enclosed-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to enclose all column values</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-optionally-enclosed-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to enclose column values containing character data (such as
                    <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">CHAR</code></a>,
                    <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a>,
                    <a href="data-types.html#binary-varbinary" title="10.4.2. The BINARY and
        VARBINARY Types"><code class="literal">BINARY</code></a>,
                    <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">TEXT</code></a>, or
                    <a href="data-types.html#enum" title="10.4.4. The ENUM Type"><code class="literal">ENUM</code></a>)</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-terminated-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to separate column values</td><td><code class="literal">\t</code> (tab character)</td></tr><tr><td><code class="option">--hex</code></td><td><span class="emphasis"><em>None</em></span></td><td>Use hex format for binary values</td><td>[N/A]</td></tr><tr><td><code class="option">--lines-terminated-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to terminate each line</td><td><code class="literal">\n</code> (linefeed character)</td></tr><tr><td><code class="option">--append</code></td><td><span class="emphasis"><em>None</em></span></td><td>When used with <a href="programs.html#option_mysqldump_tab"><code class="option">--tab</code></a>, causes the data
                    to be appended to existing files of the same name</td><td>[N/A]</td></tr></tbody></table></div><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            If a table has no explicit primary key, then the output
            generated when using the <code class="option">--print</code> includes
            the table's hidden primary key.
          </p></div><p>
          Beginning with MySQL 5.0.40, it is possible to restore
          selected databases, or to restore selected tables from a given
          database using the syntax shown here:

</p><pre class="programlisting">ndb_restore <em class="replaceable"><code>other_options</code></em> <em class="replaceable"><code>db_name_1</code></em> [<em class="replaceable"><code>db_name_2</code></em>[, <em class="replaceable"><code>db_name_3</code></em>][, ...] | <em class="replaceable"><code>tbl_name_1</code></em>[, <em class="replaceable"><code>tbl_name_2</code></em>][, ...]]
</pre><p>

          In other words, you can specify either of the following to be
          restored:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                All tables from one or more databases
              </p></li><li><p>
                One or more tables from a single database
              </p></li></ul></div><p>
        </p><a class="indexterm" name="id2288530"></a><p><b>Error reporting. </b>
            <span><strong class="command">ndb_restore</strong></span> reports both temporary and
            permanent errors. In the case of temporary errors, it may
            able to recover from them. Beginning with MySQL 5.0.29, it
            reports <code class="literal">Restore successful, but encountered
            temporary error, please look at configuration</code> in
            such cases.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-select-all"></a>17.6.16. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from an NDB Table</h3></div></div></div><a class="indexterm" name="id2288579"></a><p>
          <span><strong class="command">ndb_select_all</strong></span> prints all rows from an
          <code class="literal">NDB</code> table to
          <code class="literal">stdout</code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_select_all -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em> [&gt; <em class="replaceable"><code>file_name</code></em>]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2288656"></a>

              <a class="indexterm" name="id2288669"></a>

              <code class="option">--lock=<em class="replaceable"><code>lock_type</code></em></code>,
              <code class="option">-l <em class="replaceable"><code>lock_type</code></em></code>
            </p><p>
              Employs a lock when reading the table. Possible values for
              <em class="replaceable"><code>lock_type</code></em> are:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <code class="literal">0</code>: Read lock
                </p></li><li><p>
                  <code class="literal">1</code>: Read lock with hold
                </p></li><li><p>
                  <code class="literal">2</code>: Exclusive read lock
                </p></li></ul></div><p>
              There is no default value for this option.
            </p></li><li><p>
              <a class="indexterm" name="id2288751"></a>

              <a class="indexterm" name="id2288763"></a>

              <code class="option">--order=<em class="replaceable"><code>index_name</code></em></code>,
              <code class="option">-o <em class="replaceable"><code>index_name</code></em></code>
            </p><p>
              Orders the output according to the index named
              <em class="replaceable"><code>index_name</code></em>. Note that this is
              the name of an index, not of a column, and that the index
              must have been explicitly named when created.
            </p></li><li><p>
              <a class="indexterm" name="id2288803"></a>

              <a class="indexterm" name="id2288815"></a>

              <code class="option">--descending</code>, <code class="option">-z</code>
            </p><p>
              Sorts the output in descending order. This option can be
              used only in conjunction with the <code class="option">-o</code>
              (<code class="option">--order</code>) option.
            </p></li><li><p>
              <a class="indexterm" name="id2288852"></a>

              <a class="indexterm" name="id2288865"></a>

              <code class="option">--header=FALSE</code>
            </p><p>
              Excludes column headers from the output.
            </p></li><li><p>
              <a class="indexterm" name="id2288891"></a>

              <a class="indexterm" name="id2288903"></a>

              <code class="option">--useHexFormat</code> <code class="option">-x</code>
            </p><p>
              Causes all numeric values to be displayed in hexadecimal
              format. This does not affect the output of numerals
              contained in strings or datetime values.
            </p></li><li><p>
              <a class="indexterm" name="id2288934"></a>

              <a class="indexterm" name="id2288946"></a>

              <code class="option">--delimiter=<em class="replaceable"><code>character</code></em></code>,
              <code class="option">-D <em class="replaceable"><code>character</code></em></code>
            </p><p>
              Causes the <em class="replaceable"><code>character</code></em> to be used
              as a column delimiter. Only table data columns are
              separated by this delimiter.
            </p><p>
              The default delimiter is the tab character.
            </p></li><li><p>
              <a class="indexterm" name="id2288989"></a>

              <a class="indexterm" name="id2289001"></a>

              <code class="option">--rowid</code>
            </p><p>
              Adds a <code class="literal">ROWID</code> column providing
              information about the fragments in which rows are stored.
            </p></li><li><p>
              <a class="indexterm" name="id2289034"></a>

              <a class="indexterm" name="id2289046"></a>

              <code class="option">--gci</code>
            </p><p>
              Adds a column to the output showing the global checkpoint
              at which each row was last updated. See
              <a href="mysql-cluster.html#mysql-cluster-glossary" title="17.12. MySQL Cluster Glossary">Section 17.12, “MySQL Cluster Glossary”</a>, and
              <a href="mysql-cluster.html#mysql-cluster-log-events" title="17.7.4.2. MySQL Cluster Log Events">Section 17.7.4.2, “MySQL Cluster Log Events”</a>, for more
              information about checkpoints.
            </p></li><li><p>
              <a class="indexterm" name="id2289089"></a>

              <a class="indexterm" name="id2289102"></a>

              <code class="option">--tupscan</code>, <code class="option">-t</code>
            </p><p>
              Scan the table in the order of the tuples.
            </p></li><li><p>
              <a class="indexterm" name="id2289131"></a>

              <a class="indexterm" name="id2289143"></a>

              <code class="option">--nodata</code>
            </p><p>
              Causes any table data to be omitted.
            </p></li></ul></div><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><p>
          Output from a MySQL <a href="sql-syntax.html#select" title="12.2.8. SELECT Syntax"><code class="literal">SELECT</code></a>
          statement:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM ctest1.fish;</code></strong>
+----+-----------+
| id | name      |
+----+-----------+
|  3 | shark     |
|  6 | puffer    |
|  2 | tuna      |
|  4 | manta ray |
|  5 | grouper   |
|  1 | guppy     |
+----+-----------+
6 rows in set (0.04 sec)
</pre><p>
          Output from the equivalent invocation of
          <span><strong class="command">ndb_select_all</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_all -c localhost fish -d ctest1</code></strong>
id      name
3       [shark]
6       [puffer]
2       [tuna]
4       [manta ray]
5       [grouper]
1       [guppy]
6 rows returned

NDBT_ProgramExit: 0 - OK
</pre><p>
          Note that all string values are enclosed by square brackets
          (“<span class="quote"><code class="literal">[</code>...<code class="literal">]</code></span>”)
          in the output of <span><strong class="command">ndb_select_all</strong></span>. For a
          further example, consider the table created and populated as
          shown here:
        </p><pre class="programlisting">CREATE TABLE dogs (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(25) NOT NULL,
    breed VARCHAR(50) NOT NULL,
    PRIMARY KEY pk (id),
    KEY ix (name)
)
ENGINE=NDBCLUSTER;

INSERT INTO dogs VALUES
    ('', 'Lassie', 'collie'),
    ('', 'Scooby-Doo', 'Great Dane'),
    ('', 'Rin-Tin-Tin', 'Alsatian'),
    ('', 'Rosscoe', 'Mutt');
</pre><p>
          This demonstrates the use of several additional
          <span><strong class="command">ndb_select_all</strong></span> options:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_all -d ctest1 dogs -o ix -z --gci</code></strong>
GCI     id name           breed
834461  2  [Scooby-Doo]   [Great Dane]
834878  4  [Rosscoe]      [Mutt]
834463  3  [Rin-Tin-Tin]  [Alsatian]
835657  1  [Lassie]       [Collie]
4 rows returned

NDBT_ProgramExit: 0 - OK
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-select-count"></a>17.6.17. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</h3></div></div></div><a class="indexterm" name="id2289292"></a><p>
          <span><strong class="command">ndb_select_count</strong></span> prints the number of rows
          in one or more <code class="literal">NDB</code> tables. With a
          single table, the result is equivalent to that obtained by
          using the MySQL statement <code class="literal">SELECT COUNT(*) FROM
          <em class="replaceable"><code>tbl_name</code></em></code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_select_count [-c <em class="replaceable"><code>connect_string</code></em>] -d<em class="replaceable"><code>db_name</code></em> <em class="replaceable"><code>tbl_name</code></em>[, <em class="replaceable"><code>tbl_name2</code></em>[, ...]]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>: None that
          are specific to this application. However, you can obtain row
          counts from multiple tables in the same database by listing
          the table names separated by spaces when invoking this
          command, as shown under <span class="bold"><strong>Sample
          Output</strong></span>.
        </p><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_count -c localhost -d ctest1 fish dogs</code></strong>
6 records in table fish
4 records in table dogs

NDBT_ProgramExit: 0 - OK
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-show-tables"></a>17.6.18. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</h3></div></div></div><a class="indexterm" name="id2289408"></a><p>
          <span><strong class="command">ndb_show_tables</strong></span> displays a list of all
          <code class="literal">NDB</code> database objects in the
          cluster. By default, this includes not only both user-created
          tables and <code class="literal">NDB</code> system tables, but
          <code class="literal">NDB</code>-specific indexes, and
          internal triggers, as well.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_show_tables [-c <em class="replaceable"><code>connect_string</code></em>]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_ndb_show_tables_loops"></a>
              <a class="indexterm" name="id2289488"></a>

              <a class="indexterm" name="id2289500"></a>

              <code class="option">--loops</code>, <code class="option">-l</code>
            </p><p>
              Specifies the number of times the utility should execute.
              This is 1 when this option is not specified, but if you do
              use the option, you must supply an integer argument for
              it.
            </p></li><li><p><a name="option_ndb_show_tables_parsable"></a>
              <a class="indexterm" name="id2289533"></a>

              <a class="indexterm" name="id2289546"></a>

              <code class="option">--parsable</code>, <code class="option">-p</code>
            </p><p>
              Using this option causes the output to be in a format
              suitable for use with
              <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
              INFILE</code></a>.
            </p></li><li><p><a name="option_ndb_show_tables_type"></a>
              <a class="indexterm" name="id2289585"></a>

              <a class="indexterm" name="id2289597"></a>

              <code class="option">--type</code>, <code class="option">-t</code>
            </p><p>
              Can be used to restrict the output to one type of object,
              specified by an integer type code as shown here:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="bold"><strong>1</strong></span>: System table
                </p></li><li><p>
                  <span class="bold"><strong>2</strong></span>: User-created table
                </p></li><li><p>
                  <span class="bold"><strong>3</strong></span>: Unique hash index
                </p></li></ul></div><p>
              Any other value causes all
              <code class="literal">NDB</code> database objects to be
              listed (the default).
            </p></li><li><p><a name="option_ndb_show_tables_unqualified"></a>
              <a class="indexterm" name="id2289682"></a>

              <a class="indexterm" name="id2289694"></a>

              <code class="option">--unqualified</code>, <code class="option">-u</code>
            </p><p>
              If specified, this causes unqualified object names to be
              displayed.
            </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Only user-created Cluster tables may be accessed from MySQL;
            system tables such as <code class="literal">SYSTAB_0</code> are not
            visible to <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>. However, you can
            examine the contents of system tables using
            <code class="literal">NDB</code> API applications such as
            <span><strong class="command">ndb_select_all</strong></span> (see
            <a href="mysql-cluster.html#mysql-cluster-programs-ndb-select-all" title="17.6.16. ndb_select_all — Print Rows from an NDB Table">Section 17.6.16, “<span><strong class="command">ndb_select_all</strong></span> — Print Rows from an NDB Table”</a>).
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-size-pl"></a>17.6.19. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</h3></div></div></div><a class="indexterm" name="id2289774"></a><p>
          This is a Perl script that can be used to estimate the amount
          of space that would be required by a MySQL database if it were
          converted to use the <code class="literal">NDBCLUSTER</code>
          storage engine. Unlike the other utilities discussed in this
          section, it does not require access to a MySQL Cluster (in
          fact, there is no reason for it to do so). However, it does
          need to access the MySQL server on which the database to be
          tested resides.
        </p><p>
          <span class="bold"><strong>Requirements</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              A running MySQL server. The server instance does not have
              to provide support for MySQL Cluster.
            </p></li><li><p>
              A working installation of Perl.
            </p></li><li><p>
              The <code class="literal">DBI</code> and
              <code class="literal">HTML::Template</code> modules, both of which
              can be obtained from CPAN if they are not already part of
              your Perl installation. (Many Linux and other operating
              system distributions provide their own packages for one or
              both of these libraries.)
            </p></li><li><p>
              The <code class="filename">ndb_size.tmpl</code> template file,
              which you should be able to find in the
              <code class="filename">share/mysql</code> directory of your MySQL
              installation. This file should be copied or moved into the
              same directory as <code class="filename">ndb_size.pl</code> —
              if it is not there already — before running the
              script.
            </p></li><li><p>
              A MySQL user account having the necessary privileges. If
              you do not wish to use an existing account, then creating
              one using <code class="literal">GRANT USAGE ON
              <em class="replaceable"><code>db_name</code></em>.*</code> —
              where <em class="replaceable"><code>db_name</code></em> is the name of
              the database to be examined — is sufficient for this
              purpose.
            </p></li></ul></div><p>
          <code class="filename">ndb_size.pl</code> and
          <code class="filename">ndb_size.tmpl</code> can also be found in the
          MySQL sources in <code class="filename">storage/ndb/tools</code>. If
          these files are not present in your MySQL installation, you
          can obtain them from the
          <a href="http://forge.mysql.com/projects/project.php?id=88" target="_top">MySQL
          Forge project page</a>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">perl ndb_size.pl <em class="replaceable"><code>db_name</code></em> <em class="replaceable"><code>hostname</code></em> <em class="replaceable"><code>username</code></em> <em class="replaceable"><code>password</code></em> &gt; <em class="replaceable"><code>file_name</code></em>.html
</pre><p><a name="option_ndb_size_pl_options"></a>
          The command shown connects to the MySQL server at
          <em class="replaceable"><code>hostname</code></em> using the account of the
          user <em class="replaceable"><code>username</code></em> having the password
          <em class="replaceable"><code>password</code></em>, analyzes all of the
          tables in database <em class="replaceable"><code>db_name</code></em>, and
          generates a report in HTML format which is directed to the
          file
          <code class="filename"><em class="replaceable"><code>file_name</code></em>.html</code>.
          (Without the redirection, the output is sent to
          <code class="literal">stdout</code>.) This figure shows a portion of the
          generated <code class="filename">ndb_size.html</code> output file, as
          viewed in a Web browser:
        </p><div class="mediaobject"><img src="images/ndb-size-pl-1.png" width="366" height="800" alt="Partial sample output from
            ndb_size.pl as viewed in a Web
            browser."></div><p>
          The output from this script includes:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              Minimum values for the <code class="literal">DataMemory</code>,
              <code class="literal">IndexMemory</code>,
              <code class="literal">MaxNoOfTables</code>,
              <code class="literal">MaxNoOfAttributes</code>,
              <code class="literal">MaxNoOfOrderedIndexes</code>,
              <code class="literal">MaxNoOfUniqueHashIndexes</code>, and
              <code class="literal">MaxNoOfTriggers</code> configuration
              parameters required to accommodate the tables analyzed.
            </p></li><li><p>
              Memory requirements for all of the tables, attributes,
              ordered indexes, and unique hash indexes defined in the
              database.
            </p></li><li><p>
              The <code class="literal">IndexMemory</code> and
              <code class="literal">DataMemory</code> required per table and table
              row.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-programs-ndb-waiter"></a>17.6.20. <span><strong class="command">ndb_waiter</strong></span> — Wait for MySQL Cluster to Reach a Given Status</h3></div></div></div><a class="indexterm" name="id2290132"></a><p>
          <span><strong class="command">ndb_waiter</strong></span> repeatedly (each 100
          milliseconds) prints out the status of all cluster data nodes
          until either the cluster reaches a given status or the
          <code class="option">--timeout</code> limit is exceeded, then exits. By
          default, it waits for the cluster to achieve
          <code class="literal">STARTED</code> status, in which all nodes have
          started and connected to the cluster. This can be overridden
          using the <code class="option">--no-contact</code> and
          <code class="option">--not-started</code> options (see
          <a href="mysql-cluster.html#mysql-cluster-programs-ndb-waiter-additional-options">Additional
          Options</a>).
        </p><p>
          The node states reported by this utility are as follows:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <code class="literal">NO_CONTACT</code>: The node cannot be
              contacted.
            </p></li><li><p>
              <code class="literal">UNKNOWN</code>: The node can be contacted, but
              its status is not yet known. Usually, this means that the
              node has received a <code class="literal">START</code> or
              <code class="literal">RESTART</code> command from the management
              server, but has not yet acted on it.
            </p></li><li><p>
              <code class="literal">NOT_STARTED</code>: The node has stopped, but
              remains in contact with the cluster. This is seen when
              restarting the node using the management client's
              <code class="literal">RESTART</code> command.
            </p></li><li><p>
              <code class="literal">STARTING</code>: The node's
              <span><strong class="command">ndbd</strong></span> process has started, but the node
              has not yet joined the cluster.
            </p></li><li><p>
              <code class="literal">STARTED</code>: The node is operational, and
              has joined the cluster.
            </p></li><li><p>
              <code class="literal">SHUTTING_DOWN</code>: The node is shutting
              down.
            </p></li><li><p>
              <code class="literal">SINGLE USER MODE</code>: This is shown for all
              cluster data nodes when the cluster is in single user
              mode.
            </p></li></ul></div><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_waiter [-c <em class="replaceable"><code>connect_string</code></em>]
</pre><p><a name="mysql-cluster-programs-ndb-waiter-additional-options"></a>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2290338"></a>

              <a class="indexterm" name="id2290350"></a>

              <code class="option">--no-contact</code>, <code class="option">-n</code>
            </p><p>
              Instead of waiting for the <code class="literal">STARTED</code>
              state, <span><strong class="command">ndb_waiter</strong></span> continues running
              until the cluster reaches <code class="literal">NO_CONTACT</code>
              status before exiting.
            </p></li><li><p>
              <a class="indexterm" name="id2290398"></a>

              <a class="indexterm" name="id2290410"></a>

              <code class="option">--not-started</code>
            </p><p>
              Instead of waiting for the <code class="literal">STARTED</code>
              state, <span><strong class="command">ndb_waiter</strong></span> continues running
              until the cluster reaches <code class="literal">NOT_STARTED</code>
              status before exiting.
            </p></li><li><p>
              <a class="indexterm" name="id2290455"></a>

              <a class="indexterm" name="id2290468"></a>

              <code class="option">--timeout=<em class="replaceable"><code>seconds</code></em></code>,
              <code class="option">-t <em class="replaceable"><code>seconds</code></em></code>
            </p><p>
              Time to wait. The program exits if the desired state is
              not achieved within this number of seconds. The default is
              120 seconds (1200 reporting cycles).
            </p></li></ul></div><p><b>Sample Output. </b>
            Shown here is the output from <span><strong class="command">ndb_waiter</strong></span>
            when run against a 4-node cluster in which two nodes have
            been shut down and then started again manually. Duplicate
            reports (indicated by “<span class="quote"><code class="literal">...</code></span>”)
            are omitted.
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_waiter -c localhost</code></strong>

Connecting to mgmsrv at (localhost)
State node 1 STARTED
State node 2 NO_CONTACT
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 UNKNOWN
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 UNKNOWN
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 STARTING
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTED
State node 3 STARTED
State node 4 STARTING
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTED
State node 3 STARTED
State node 4 STARTED
Waiting for cluster enter state STARTED

NDBT_ProgramExit: 0 - OK
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            If no connectstring is specified, then
            <span><strong class="command">ndb_waiter</strong></span> tries to connect to a
            management on <code class="literal">localhost</code>, and reports
            <code class="literal">Connecting to mgmsrv at (null)</code>.
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-program-options-common"></a>17.6.21. Options Common to MySQL Cluster Programs</h3></div></div></div><a class="indexterm" name="id2290588"></a><a class="indexterm" name="id2290600"></a><a class="indexterm" name="id2290609"></a><a class="indexterm" name="id2290618"></a><a class="indexterm" name="id2290631"></a><a class="indexterm" name="id2290643"></a><p>
      All MySQL Cluster programs (except for <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>)
      take the options described in this section. Users of earlier MySQL
      Cluster versions should note that some of these options have been
      changed to make them consistent with one another as well as with
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>. You can use the <code class="option">--help</code>
      option with any MySQL Cluster program to view a list of the
      options which it supports.
    </p><p>
      The options in the following list are common to all MySQL Cluster
      executables.
    </p><p>
      For options specific to individual
      <code class="literal">NDB</code> programs, see
      <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>.
    </p><p>
      See <a href="mysql-cluster.html#mysql-cluster-program-options-mysqld" title="17.4.2. mysqld Command Options for MySQL Cluster">Section 17.4.2, “<span><strong class="command">mysqld</strong></span> Command Options for MySQL Cluster”</a>, for
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> options relating to MySQL Cluster.
    </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2290719"></a><a class="indexterm" name="id2290732"></a><a class="indexterm" name="id2290744"></a><p><a name="option_ndb_common_help"></a>
          <code class="option">--help</code> <code class="option">--usage</code>,
          <code class="option">-?</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--help</code></td></tr></tbody></table></div><p>
          Prints a short list with descriptions of the available command
          options.
        </p></li><li><a class="indexterm" name="id2290811"></a><a class="indexterm" name="id2290824"></a><p><a name="option_ndb_common_character-sets-dir"></a>
          <code class="option">--character-sets-dir=<em class="replaceable"><code>name</code></em></code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--character-sets-dir=name</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">filename</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal"></code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Tells the program where to find character set information.
        </p></li><li><a class="indexterm" name="id2290921"></a><a class="indexterm" name="id2290930"></a><p><a name="option_ndb_common_connect-string"></a>
          <code class="option">--connect-string=<em class="replaceable"><code>connect_string</code></em></code>,
          <code class="option">-c <em class="replaceable"><code>connect_string</code></em></code>
        </p><p>
          <em class="replaceable"><code>connect_string</code></em> sets the
          connectstring to the management server as a command option.

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd --connect-string="nodeid=2;host=ndb_mgmd.mysql.com:1186"</code></strong>
</pre><p>

          For more information, see
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="17.3.4.2. The MySQL Cluster Connectstring">Section 17.3.4.2, “The MySQL Cluster Connectstring”</a>.
        </p></li><li><a class="indexterm" name="id2290984"></a><p><a name="option_ndb_common_core-file"></a>
          <code class="option">--core-file</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--core-file</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Write a core file if the program dies. The name and location
          of the core file are system-dependent. (For MySQL Cluster
          programs nodes running on Linux, the default location is the
          program's working directory — for a data node, this
          is the node's <code class="literal">DataDir</code>.) For some
          systems, there may be restrictions or limitations; for
          example, it might be necessary to execute <span><strong class="command">ulimit -c
          unlimited</strong></span> before starting the server. Consult your
          system documentation for detailed information.
        </p><p>
          If MySQL Cluster was built using the <code class="option">--debug</code>
          option for <span><strong class="command">configure</strong></span>, then
          <code class="option">--core-file</code> is enabled by default. For
          regular builds, <code class="option">--core-file</code> is disabled by
          default.
        </p></li><li><a class="indexterm" name="id2291117"></a><p><a name="option_ndb_common_debug"></a>
          <code class="option">--debug[=<em class="replaceable"><code>options</code></em>]</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--debug=options</code></td></tr></tbody></table></div><p>
          This option can be used only for versions compiled with
          debugging enabled. It is used to enable output from debug
          calls in the same manner as for the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>
          process.
        </p></li><li><a class="indexterm" name="id2291185"></a><a class="indexterm" name="id2291194"></a><p><a name="option_ndb_common_execute"></a>
          <code class="option">--execute=<code class="literal">command</code></code>,
          <code class="option">-e <code class="literal">command</code></code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--execute=name</code></td></tr></tbody></table></div><p>
          Can be used to send a command to a Cluster executable from the
          system shell. For example, either of the following:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "SHOW"</code></strong>
</pre><p>
          or
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm --execute="SHOW"</code></strong>
</pre><p>
          is equivalent to
        </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
</pre><p>
          This is analogous to how the <code class="option">--execute</code> or
          <code class="option">-e</code> option works with the
          <a href="programs.html#mysql" title="4.5.1. mysql — The MySQL Command-Line Tool"><span><strong class="command">mysql</strong></span></a> command-line client. See
          <a href="programs.html#command-line-options" title="4.2.3.1. Using Options on the Command Line">Section 4.2.3.1, “Using Options on the Command Line”</a>.
        </p></li><li><a class="indexterm" name="id2291328"></a><p><a name="option_ndb_common_mgmd-host"></a>
          <code class="option">--ndb-mgmd-host=<em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
        </p><p>
          Can be used to set the host and port number of the management
          server to connect to.
        </p></li><li><a class="indexterm" name="id2291361"></a><p><a name="option_ndb_common_nodeid"></a>
          <code class="option">--ndb-nodeid=<em class="replaceable"><code>#</code></em></code>
        </p><p>
          Sets this node's MySQL Cluster node ID. <span class="emphasis"><em>The
          range of permitted values depends on the type of the node
          (data, management, or API) and the version of the MySQL
          Cluster software which is running on it</em></span>. See
          <a href="mysql-cluster.html#mysql-cluster-limitations-limits" title="17.10.2. Limits and Differences of MySQL Cluster from Standard MySQL Limits">Section 17.10.2, “Limits and Differences of MySQL Cluster from Standard MySQL Limits”</a>, for more
          information.
        </p></li><li><a class="indexterm" name="id2291398"></a><p><a name="option_ndb_common_ndb-optimized-node-selection"></a>
          <code class="option">--ndb-optimized-node-selection</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--ndb-optimized-node-selection</code></td></tr><tr><td><span class="bold"><strong>Permitted Values </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Optimize selection of nodes for transactions. Enabled by
          default.
        </p></li><li><a class="indexterm" name="id2291492"></a><a class="indexterm" name="id2291501"></a><p><a name="option_ndb_common_version"></a>
          <code class="option">--version</code>, <code class="option">-V</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">-V</code></td></tr></tbody></table></div><p>
          Prints the MySQL Cluster version number of the executable. The
          version number is relevant because not all versions can be
          used together, and the MySQL Cluster startup process verifies
          that the versions of the binaries being used can co-exist in
          the same cluster. This is also important when performing an
          online (rolling) software upgrade or downgrade of MySQL
          Cluster. (See
          <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="17.5.1. Performing a Rolling Restart of a MySQL Cluster">Section 17.5.1, “Performing a Rolling Restart of a MySQL Cluster”</a>).
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-program-options-tables"></a>17.6.22. Summary Tables of NDB Program Options</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-common-table">17.6.22.1. Common Options for MySQL Cluster Programs</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndbd">17.6.22.2. Program Options for <span><strong class="command">ndbd</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-mgmd">17.6.22.3. Program Options for <span><strong class="command">ndb_mgmd</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-mgm">17.6.22.4. Program Options for <span><strong class="command">ndb_mgm</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-config">17.6.22.5. Program Options for <span><strong class="command">ndb_config</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-error-reporter">17.6.22.6. Program Options for <span><strong class="command">ndb_error_reporter</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-restore">17.6.22.7. Program Options for <span><strong class="command">ndb_restore</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-show-tables">17.6.22.8. Program Options for <span><strong class="command">ndb_show_tables</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-program-options-ndb-size-pl">17.6.22.9. Program Options for <span><strong class="command">ndb_size.pl</strong></span></a></span></dt></dl></div><p>
      The next few sections contain summary tables providing basic
      information about command-line options used with MySQL Cluster
      programs.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-common-table"></a>17.6.22.1. Common Options for MySQL Cluster Programs</h4></div></div></div><div class="table"><a name="id2291589"></a><p class="title"><b>Table 17.9. <span>ndb_common</span> Option Reference</b></p><table summary="ndb_common Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_ndb_common_character-sets-dir">--character-sets-dir=name</a></td><td>Directory where character sets are</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_connect-string">--ndb-connectstring=name</a></td><td>Set connect string for connecting to ndb_mgmd. Syntax:  [nodeid=&lt;id&gt;;][host=]&lt;hostname&gt;[:&lt;port&gt;].  Overrides specifying entries in NDB_CONNECTSTRING and my.cnf</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_core-file">--core-file</a></td><td>Write core on errors (defaults to TRUE in debug builds)</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_debug">--debug=options</a></td><td>Enable output from debug calls. Can be used only for versions  compiled with debugging enabled</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_execute">--execute=name</a></td><td>Execute command and exit</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_help">--help</a></td><td>Display help message and exit</td><td> </td><td> </td><td> </td></tr><tr><td>--ndb-mgmd-host=name</td><td>Set host and port for connecting to ndb_mgmd. Syntax:  &lt;hostname&gt;[:&lt;port&gt;]. Overrides specifying entries in  NDB_CONNECTSTRING and my.cnf</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_ndb-optimized-node-selection">--ndb-optimized-node-selection</a></td><td>Select nodes for transactions in a more optimal way</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_nodeid">--ndb-nodeid=#</a></td><td>Set node id for this node</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_common_version">-V</a></td><td>Output version information and exit</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For options specific to individual MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndbd"></a>17.6.22.2. Program Options for <span><strong class="command">ndbd</strong></span></h4></div></div></div><a class="indexterm" name="id2291796"></a><a class="indexterm" name="id2291809"></a><a class="indexterm" name="id2291821"></a><a class="indexterm" name="id2291834"></a><div class="table"><a name="id2291846"></a><p class="title"><b>Table 17.10. <span>ndbd</span> Option Reference</b></p><table summary="ndbd Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_ndbd_bind-address">--bind-address=name</a></td><td>Local bind address</td><td>5.0.29</td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_daemon">--daemon</a></td><td>Start ndbd as daemon (default); override with --nodaemon</td><td> </td><td> </td><td> </td></tr><tr><td>--foreground</td><td>Run ndbd in foreground, provided for debugging purposes (implies  --nodaemon)</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_initial">--initial</a></td><td>Perform initial start of ndbd, including cleaning the file system.  Consult the documentation before using this option</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_initial-start">--initial-start</a></td><td>Perform partial initial start (requires --nowait-nodes)</td><td>5.0.21</td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_nodaemon">--nodaemon</a></td><td>Do not start ndbd as daemon; provided for testing purposes</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_nostart">--nostart</a></td><td>Don't start ndbd immediately; ndbd waits for command to start  from ndb_mgmd</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndbd_nowait-nodes">--nowait-nodes=list</a></td><td>Nodes that will not be waited for during start (comma-deparated  list of node IDs)</td><td>5.0.21</td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndbd</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndbd" title="17.6.2. ndbd — The MySQL Cluster Data Node Daemon">Section 17.6.2, “<span><strong class="command">ndbd</strong></span> — The MySQL Cluster Data Node Daemon”</a>. For options
        common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-mgmd"></a>17.6.22.3. Program Options for <span><strong class="command">ndb_mgmd</strong></span></h4></div></div></div><a class="indexterm" name="id2292038"></a><a class="indexterm" name="id2292050"></a><a class="indexterm" name="id2292063"></a><a class="indexterm" name="id2292075"></a><div class="table"><a name="id2292088"></a><p class="title"><b>Table 17.11. <span>ndb_mgmd</span> Option Reference</b></p><table summary="ndb_mgmd Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_ndb_mgmd_config-file">-c</a></td><td>Specify the cluster configuration file; in NDB-6.4.0 and later,  needs --reload or --initial to override configuration cache if  present</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_mgmd_daemon">--daemon</a></td><td>Run ndb_mgmd in daemon mode (default)</td><td> </td><td> </td><td> </td></tr><tr><td>--interactive</td><td>Run ndb_mgmd in interactive mode (not officially supported in  production; for testing purposes only)</td><td> </td><td> </td><td> </td></tr><tr><td>--mycnf</td><td>Read cluster configuration data from the my.cnf file</td><td> </td><td> </td><td> </td></tr><tr><td>--no-nodeid-checks</td><td>Do not provide any node id checks</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_mgmd_nodaemon">--nodaemon</a></td><td>Do not run ndb_mgmd as a daemon</td><td> </td><td> </td><td> </td></tr><tr><td><a href="mysql-cluster.html#option_ndb_mgmd_print-full-config">--print-full-config</a></td><td>Print full configuration and exit</td><td>5.0.10</td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_mgmd</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgmd" title="17.6.3. ndb_mgmd — The MySQL Cluster Management Server Daemon">Section 17.6.3, “<span><strong class="command">ndb_mgmd</strong></span> — The MySQL Cluster Management Server Daemon”</a>. For options
        common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-mgm"></a>17.6.22.4. Program Options for <span><strong class="command">ndb_mgm</strong></span></h4></div></div></div><a class="indexterm" name="id2292256"></a><a class="indexterm" name="id2292269"></a><a class="indexterm" name="id2292281"></a><a class="indexterm" name="id2292294"></a><div class="table"><a name="id2292306"></a><p class="title"><b>Table 17.12. <span>ndb_mgm</span> Option Reference</b></p><table summary="ndb_mgm Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_ndb_mgm_try-reconnect">--try-reconnect=#</a></td><td>Specify number of tries for connecting to ndb_mgmd (0 = infinite)</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_mgm</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-mgm" title="17.6.4. ndb_mgm — The MySQL Cluster Management Client">Section 17.6.4, “<span><strong class="command">ndb_mgm</strong></span> — The MySQL Cluster Management Client”</a>. For options
        common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-config"></a>17.6.22.5. Program Options for <span><strong class="command">ndb_config</strong></span></h4></div></div></div><a class="indexterm" name="id2292407"></a><a class="indexterm" name="id2292420"></a><a class="indexterm" name="id2292432"></a><a class="indexterm" name="id2292445"></a><div class="table"><a name="id2292454"></a><p class="title"><b>Table 17.13. <span>ndb_config</span> Option Reference</b></p><table summary="ndb_config Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td>--connections</td><td>Print connection information only</td><td> </td><td> </td><td> </td></tr><tr><td>--fields=string</td><td>Field separator</td><td> </td><td> </td><td> </td></tr><tr><td>--host=name</td><td>Specify host</td><td> </td><td> </td><td> </td></tr><tr><td>--mycnf</td><td>Read configuration data from my.cnf file</td><td> </td><td> </td><td> </td></tr><tr><td>--nodeid</td><td>Get configuration of node with this ID</td><td> </td><td> </td><td> </td></tr><tr><td>--nodes</td><td>Print node information only</td><td> </td><td> </td><td> </td></tr><tr><td> </td><td>Short form for --ndb-connectstring</td><td>5.0.33</td><td> </td><td> </td></tr><tr><td>--config-file=path</td><td>Set the path to config.ini file</td><td> </td><td> </td><td> </td></tr><tr><td>--query=string</td><td>One or more query options (attributes)</td><td> </td><td> </td><td> </td></tr><tr><td>--rows=string</td><td>Row separator</td><td> </td><td> </td><td> </td></tr><tr><td>--type=name</td><td>Specify node type</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_config</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-config" title="17.6.5. ndb_config — Extract MySQL Cluster Configuration Information">Section 17.6.5, “<span><strong class="command">ndb_config</strong></span> — Extract MySQL Cluster Configuration Information”</a>. For options
        common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-error-reporter"></a>17.6.22.6. Program Options for <span><strong class="command">ndb_error_reporter</strong></span></h4></div></div></div><a class="indexterm" name="id2292643"></a><a class="indexterm" name="id2292655"></a><a class="indexterm" name="id2292668"></a><a class="indexterm" name="id2292680"></a><div class="table"><a name="id2292689"></a><p class="title"><b>Table 17.14. <span>ndb_error_reporter</span> Option Reference</b></p><table summary="ndb_error_reporter Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_ndb_error_reporter_fs">--fs</a></td><td>Include file system data in error report; can use a large amount  of disk space</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about
        <span><strong class="command">ndb_error_reporter</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-error-reporter" title="17.6.11. ndb_error_reporter — NDB Error-Reporting Utility">Section 17.6.11, “<span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility”</a>. For
        options common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-restore"></a>17.6.22.7. Program Options for <span><strong class="command">ndb_restore</strong></span></h4></div></div></div><a class="indexterm" name="id2292791"></a><a class="indexterm" name="id2292803"></a><a class="indexterm" name="id2292816"></a><a class="indexterm" name="id2292828"></a><div class="table"><a name="id2292837"></a><p class="title"><b>Table 17.15. <span>ndb_restore</span> Option Reference</b></p><table summary="ndb_restore Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td>--append</td><td>Append data to a tab-delimited file</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--backup_path=path</td><td>Path to backup files directory</td><td> </td><td> </td><td> </td></tr><tr><td>--backupid=#</td><td>Restore from the backup with the given ID</td><td> </td><td> </td><td> </td></tr><tr><td>--connect</td><td>Same as connectstring</td><td> </td><td> </td><td> </td></tr><tr><td>--restore_data</td><td>Restore table data and logs into NDB Cluster using the NDB API</td><td> </td><td> </td><td> </td></tr><tr><td>--dont_ignore_systab_0</td><td>Do not ignore system table during restore. Experimental only; not  for production use</td><td> </td><td> </td><td> </td></tr><tr><td>--fields-enclosed-by=char</td><td>Fields are enclosed with the indicated character</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--fields-optionally-enclosed-by</td><td>Fields are optionally enclosed with the indicated character</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--fields-terminated-by=char</td><td>Fields are terminated by the indicated character</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--hex</td><td>Print binary types in hexadecimal format</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--lines-terminated-by=char</td><td>Lines are terminated by the indicated character</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--restore_meta</td><td>Restore metadata to NDB Cluster using the NDB API</td><td> </td><td> </td><td> </td></tr><tr><td>--ndb-nodegroup-map=map</td><td>Nodegroup map for NDBCLUSTER storage engine. Syntax: list of  (source_nodegroup, destination_nodegroup)</td><td> </td><td> </td><td> </td></tr><tr><td>--no-restore-disk-objects</td><td>Do not restore Disk Data objects such as tablespaces and log file  groups</td><td> </td><td> </td><td> </td></tr><tr><td>--nodeid=#</td><td>Back up files from node with this ID</td><td> </td><td> </td><td> </td></tr><tr><td>--parallelism=#</td><td>Number of parallel transactions during restoration of data</td><td> </td><td> </td><td> </td></tr><tr><td>--preserve-trailing-spaces</td><td>Allow preservation of tailing spaces (including padding) when CHAR  is promoted to VARCHAR or BINARY is promoted to VARBINARY</td><td> </td><td> </td><td> </td></tr><tr><td>--print</td><td>Print metadata, data and log to stdout (equivalent to --print_meta  --print_data --print_log)</td><td> </td><td> </td><td> </td></tr><tr><td>--print_data</td><td>Print data to stdout</td><td> </td><td> </td><td> </td></tr><tr><td>--print_log</td><td>Print to stdout</td><td> </td><td> </td><td> </td></tr><tr><td>--print_metadata</td><td>Print metadata to stdout</td><td> </td><td> </td><td> </td></tr><tr><td>--promote-attributes</td><td>Allow attributes to be promoted when restoring data from backup</td><td> </td><td> </td><td> </td></tr><tr><td>--restore_epoch</td><td>Restore epoch info into the status table. Convenient on a MySQL  Cluster replication slave for starting replication. The row in  mysql.ndb_apply_status with id 0 will be updated/inserted.</td><td> </td><td> </td><td> </td></tr><tr><td>--tab=path</td><td>Creates tab separated a .txt file for each table in the given path</td><td>5.0.40</td><td> </td><td> </td></tr><tr><td>--verbose=#</td><td>Control level of verbosity in output</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_restore</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-restore" title="17.6.15. ndb_restore — Restore a MySQL Cluster Backup">Section 17.6.15, “<span><strong class="command">ndb_restore</strong></span> — Restore a MySQL Cluster Backup”</a>. For
        options common to all NDB programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-show-tables"></a>17.6.22.8. Program Options for <span><strong class="command">ndb_show_tables</strong></span></h4></div></div></div><a class="indexterm" name="id2293171"></a><a class="indexterm" name="id2293183"></a><a class="indexterm" name="id2293196"></a><a class="indexterm" name="id2293208"></a><div class="table"><a name="id2293217"></a><p class="title"><b>Table 17.16. <span>ndb_show_tables</span> Option Reference</b></p><table summary="ndb_show_tables Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td>--database=string</td><td>Specifies the database in which the table is found</td><td> </td><td> </td><td> </td></tr><tr><td>--loops=#</td><td>Number of times to repeat output</td><td> </td><td> </td><td> </td></tr><tr><td>--show-temp-status</td><td>Show table temporary flag</td><td> </td><td> </td><td> </td></tr><tr><td>--parsable</td><td>Return output suitable for MySQL LOAD DATA INFILE statement</td><td> </td><td> </td><td> </td></tr><tr><td>--type=#</td><td>Limit output to objects of this type</td><td> </td><td> </td><td> </td></tr><tr><td>--unqualified</td><td>Do not qualify table names</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_show_tables</strong></span>,
        see <a href="mysql-cluster.html#mysql-cluster-programs-ndb-show-tables" title="17.6.18. ndb_show_tables — Display List of NDB Tables">Section 17.6.18, “<span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables”</a>.
        For options common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-program-options-ndb-size-pl"></a>17.6.22.9. Program Options for <span><strong class="command">ndb_size.pl</strong></span></h4></div></div></div><a class="indexterm" name="id2293361"></a><a class="indexterm" name="id2293373"></a><a class="indexterm" name="id2293386"></a><a class="indexterm" name="id2293398"></a><div class="table"><a name="id2293407"></a><p class="title"><b>Table 17.17. <span>ndb_size_pl</span> Option Reference</b></p><table summary="ndb_size_pl Option Reference" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Format</th><th>Description</th><th>Introduction</th><th>Deprecated</th><th>Removed</th></tr></thead><tbody><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--database=dbname</a></td><td>The databae or databases to examine; accepts a comma-delimited  list; the default is ALL (use all databases found on the server)</td><td> </td><td> </td><td> </td></tr><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--excludedbs=db-list</a></td><td>Skip any databases in a comma-separated list of databases</td><td> </td><td> </td><td> </td></tr><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--excludetables=tbl-list</a></td><td>Skip any tables in a comma-separated list of tables</td><td> </td><td> </td><td> </td></tr><tr><td>--format=string</td><td>Set output format (text or HTML)</td><td> </td><td> </td><td> </td></tr><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--hostname[:port]</a></td><td>Specify host and optional port as host[:port]</td><td> </td><td> </td><td> </td></tr><tr><td>--loadqueries=file</td><td>Loads all queries from the file specified; does not connect to a  database</td><td> </td><td> </td><td> </td></tr><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--password=string</a></td><td>Specify a MySQL user password</td><td> </td><td> </td><td> </td></tr><tr><td>--savequeries=file</td><td>Saves all queries to the database into the file specified</td><td> </td><td> </td><td> </td></tr><tr><td><a href="http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-programs-ndb-size-pl.html#option_ndb_size_pl_options" target="_top">--user=string</a></td><td>Specify a MySQL user name</td><td> </td><td> </td><td> </td></tr></tbody></table></div><p>
        For more information about <span><strong class="command">ndb_size.pl</strong></span>, see
        <a href="mysql-cluster.html#mysql-cluster-programs-ndb-size-pl" title="17.6.19. ndb_size.pl — NDBCLUSTER Size Requirement Estimator">Section 17.6.19, “<span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator”</a>. For
        options common to all MySQL Cluster programs, see
        <a href="mysql-cluster.html#mysql-cluster-program-options-common" title="17.6.21. Options Common to MySQL Cluster Programs">Section 17.6.21, “Options Common to MySQL Cluster Programs”</a>.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-management"></a>17.7. Management of MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-start-phases">17.7.1. Summary of MySQL Cluster Start Phases</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-client-commands">17.7.2. Commands in the MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup">17.7.3. Online Backup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-event-reports">17.7.4. Event Reports Generated in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-ndb-messages">17.7.5. MySQL Cluster Log Messages</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-single-user-mode">17.7.6. MySQL Cluster Single User Mode</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sql-statements">17.7.7. Quick Reference: MySQL Cluster SQL Statements</a></span></dt></dl></div><a class="indexterm" name="id2293603"></a><a class="indexterm" name="id2293615"></a><p>
    Managing a MySQL Cluster involves a number of tasks, the first of
    which is to configure and start MySQL Cluster. This is covered in
    <a href="mysql-cluster.html#mysql-cluster-configuration" title="17.3. MySQL Cluster Configuration">Section 17.3, “MySQL Cluster Configuration”</a>, and
    <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>.
  </p><p>
    The following sections cover the management of a running MySQL
    Cluster.
  </p><p>
    For information about security issues relating to management and
    deployment of a MySQL Cluster, see
    <a href="mysql-cluster.html#mysql-cluster-security" title="17.8. MySQL Cluster Security Issues">Section 17.8, “MySQL Cluster Security Issues”</a>.
  </p><p>
    There are essentially two methods of actively managing a running
    MySQL Cluster. The first of these is through the use of commands
    entered into the management client whereby cluster status can be
    checked, log levels changed, backups started and stopped, and nodes
    stopped and started. The second method involves studying the
    contents of the cluster log
    <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>;
    this is usually found in the management server's
    <code class="literal">DataDir</code> directory, but this location can be
    overridden using the <code class="literal">LogDestination</code> option
    — see <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="17.3.4.4. Defining a MySQL Cluster Management Server">Section 17.3.4.4, “Defining a MySQL Cluster Management Server”</a>, for
    details. (Recall that <em class="replaceable"><code>node_id</code></em> represents
    the unique identifier of the node whose activity is being logged.)
    The cluster log contains event reports generated by
    <span><strong class="command">ndbd</strong></span>. It is also possible to send cluster log
    entries to a Unix system log.
  </p><p>
    In addition, some aspects of the cluster's operation can be
    monitored from an SQL node using the
    <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE NDB
    STATUS</code></a> statement. See <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax">Section 12.5.5.12, “<code class="literal">SHOW ENGINE</code> Syntax”</a>, for
    more information.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-start-phases"></a>17.7.1. Summary of MySQL Cluster Start Phases</h3></div></div></div><a class="indexterm" name="id2293721"></a><a class="indexterm" name="id2293733"></a><p>
      This section provides a simplified outline of the steps involved
      when MySQL Cluster data nodes are started. More complete
      information can be found in
      <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-start-phases.html" target="_top">MySQL Cluster Start Phases</a>.
    </p><p>
      These phases are the same as those reported in the output from the
      <code class="literal"><em class="replaceable"><code>node_id</code></em> STATUS</code>
      command in the management client. (See
      <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="17.7.2. Commands in the MySQL Cluster Management Client">Section 17.7.2, “Commands in the MySQL Cluster Management Client”</a>, for more
      information about this command.)
    </p><p><b>Start types. </b>
        There are several different startup types and modes, as shown
        here:

        </p><div class="itemizedlist"><ul type="disc"><li><p><b>Initial Start. </b>
                The cluster starts with a clean file system on all data
                nodes. This occurs either when the cluster started for
                the very first time, or when all data nodes are
                restarted using the <code class="option">--initial</code> option.

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                    Disk Data files are not removed when restarting a
                    node using <code class="option">--initial</code>.
                  </p></div><p>
              </p></li><li><p><b>System Restart. </b>
                The cluster starts and reads data stored in the data
                nodes. This occurs when the cluster has been shut down
                after having been in use, when it is desired for the
                cluster to resume operations from the point where it
                left off.
              </p></li><li><p><b>Node Restart. </b>
                This is the online restart of a cluster node while the
                cluster itself is running.
              </p></li><li><p><b>Initial Node Restart. </b>
                This is the same as a node restart, except that the node
                is reinitialized and started with a clean file system.
              </p></li></ul></div><p>
      </p><p><b>Setup and initialization (Phase -1). </b>
        Prior to startup, each data node (<span><strong class="command">ndbd</strong></span>
        process) must be initialized. Initialization consists of the
        following steps:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Obtain a node ID
            </p></li><li><p>
              Fetch configuration data
            </p></li><li><p>
              Allocate ports to be used for inter-node communications
            </p></li><li><p>
              Allocate memory according to settings obtained from the
              configuration file
            </p></li></ol></div><p>
      </p><p>
      When a data node or SQL node first connects to the management
      node, it reserves a cluster node ID. To make sure that no other
      node allocates the same node ID, this ID is retained until the
      node has managed to connect to the cluster and at least one
      <span><strong class="command">ndbd</strong></span> reports that this node is connected. This
      retention of the node ID is guarded by the connection between the
      node in question and <span><strong class="command">ndb_mgmd</strong></span>.
    </p><p>
      Normally, in the event of a problem with the node, the node
      disconnects from the management server, the socket used for the
      connection is closed, and the reserved node ID is freed. However,
      if a node is disconnected abruptly — for example, due to a
      hardware failure in one of the cluster hosts, or because of
      network issues — the normal closing of the socket by the
      operating system may not take place. In this case, the node ID
      continues to be reserved and not released until a TCP timeout
      occurs 10 or so minutes later.
    </p><a class="indexterm" name="id2293949"></a><p>
      To take care of this problem, you can use <code class="literal">PURGE STALE
      SESSIONS</code>. Running this statement forces all reserved
      node IDs to be checked; any that are not being used by nodes
      actually connected to the cluster are then freed.
    </p><p>
      Beginning with MySQL 5.1.11, timeout handling of node ID
      assignments is implemented. This performs the ID usage checks
      automatically after approximately 20 seconds, so that
      <code class="literal">PURGE STALE SESSIONS</code> should no longer be
      necessary in a normal Cluster start.
    </p><p>
      After each data node has been initialized, the cluster startup
      process can proceed. The stages which the cluster goes through
      during this process are listed here:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Phase 0. </b>
              The <code class="literal">NDBFS</code> and
              <code class="literal">NDBCNTR</code> blocks start (see
              <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-kernel-blocks.html" target="_top"><code class="literal">NDB</code> Kernel Blocks</a>). The
              cluster file system is cleared, if the cluster was started
              with the <code class="option">--initial</code> option.
            </p></li><li><p><b>Phase 1. </b>
              In this stage, all remaining
              <code class="literal">NDB</code> kernel blocks are
              started. Cluster connections are set up, inter-block
              communications are established, and Cluster heartbeats are
              started. In the case of a node restart, API node
              connections are also checked.

              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  When one or more nodes hang in Phase 1 while the
                  remaining node or nodes hang in Phase 2, this often
                  indicates network problems. One possible cause of such
                  issues is one or more cluster hosts having multiple
                  network interfaces. Another common source of problems
                  causing this condition is the blocking of TCP/IP ports
                  needed for communications between cluster nodes. In
                  the latter case, this is often due to a misconfigured
                  firewall.
                </p></div><p>
            </p></li><li><p><b>Phase 2. </b>
              The <code class="literal">NDBCNTR</code> kernel block checks the
              states of all existing nodes. The master node is chosen,
              and the cluster schema file is initialized.
            </p></li><li><p><b>Phase 3. </b>
              The <code class="literal">DBLQH</code> and <code class="literal">DBTC</code>
              kernel blocks set up communications between them. The
              startup type is determined; if this is a restart, the
              <code class="literal">DBDIH</code> block obtains permission to
              perform the restart.
            </p></li><li><p><b>Phase 4. </b>
              For an initial start or initial node restart, the redo log
              files are created. The number of these files is equal to
              <code class="literal">NoOfFragmentLogFiles</code>.
            </p><p>
            For a system restart:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                Read schema or schemas.
              </p></li><li><p>
                Read data from the local checkpoint.
              </p></li><li><p>
                Apply all redo information until the latest restorable
                global checkpoint has been reached.
              </p></li></ul></div><p>
            For a node restart, find the tail of the redo log.
          </p></li><li><p><b>Phase 5. </b>
              Most of the database-related portion of a data node start
              is performed during this phase. For an initial start or
              system restart, a local checkpoint is executed, followed
              by a global checkpoint. Periodic checks of memory usage
              begin during this phase, and any required node takeovers
              are performed.
            </p></li><li><p><b>Phase 6. </b>
              In this phase, node groups are defined and set up.
            </p></li><li><p><b>Phase 7. </b>
              The arbitrator node is selected and begins to function.
              The next backup ID is set, as is the backup disk write
              speed. Nodes reaching this start phase are marked as
              <code class="literal">Started</code>. It is now possible for API
              nodes (including SQL nodes) to connect to the cluster.
              connect.
            </p></li><li><p><b>Phase 8. </b>
              If this is a system restart, all indexes are rebuilt (by
              <code class="literal">DBDIH</code>).
            </p></li><li><p><b>Phase 9. </b>
              The node internal startup variables are reset.
            </p></li><li><p><b>Phase 100 (<span class="emphasis"><em>OBSOLETE</em></span>). </b>
              Formerly, it was at this point during a node restart or
              initial node restart that API nodes could connect to the
              node and begin to receive events. Currently, this phase is
              empty.
            </p></li><li><p><b>Phase 101. </b>
              At this point in a node restart or initial node restart,
              event delivery is handed over to the node joining the
              cluster. The newly joined node takes over responsibility
              for delivering its primary data to subscribers. This phase
              is also referred to as <em class="firstterm"><code class="literal">SUMA</code>
              handover phase</em>.
            </p></li></ul></div><p>
    </p><p>
      After this process is completed for an initial start or system
      restart, transaction handling is enabled. For a node restart or
      initial node restart, completion of the startup process means that
      the node may now act as a transaction coordinator.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-mgm-client-commands"></a>17.7.2. Commands in the MySQL Cluster Management Client</h3></div></div></div><a class="indexterm" name="id2294313"></a><a class="indexterm" name="id2294325"></a><a class="indexterm" name="id2294338"></a><p>
      In addition to the central configuration file, a cluster may also
      be controlled through a command-line interface available through
      the management client <span><strong class="command">ndb_mgm</strong></span>. This is the
      primary administrative interface to a running cluster.
    </p><p>
      Commands for the event logs are given in
      <a href="mysql-cluster.html#mysql-cluster-event-reports" title="17.7.4. Event Reports Generated in MySQL Cluster">Section 17.7.4, “Event Reports Generated in MySQL Cluster”</a>; commands for
      creating backups and restoring from them are provided in
      <a href="mysql-cluster.html#mysql-cluster-backup" title="17.7.3. Online Backup of MySQL Cluster">Section 17.7.3, “Online Backup of MySQL Cluster”</a>.
    </p><p>
      The management client has the following basic commands. In the
      listing that follows, <em class="replaceable"><code>node_id</code></em> denotes
      either a database node ID or the keyword <code class="literal">ALL</code>,
      which indicates that the command should be applied to all of the
      cluster's data nodes.
    </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2294394"></a><a class="indexterm" name="id2294407"></a><p>
          <code class="literal">HELP</code>
        </p><p>
          Displays information on all available commands.
        </p></li><li><a class="indexterm" name="id2294434"></a><a class="indexterm" name="id2294446"></a><p>
          <code class="literal">SHOW</code>
        </p><p>
          Displays information on the cluster's status.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            In a cluster where multiple management nodes are in use,
            this command displays information only for data nodes that
            are actually connected to the current management server.
          </p></div></li><li><a class="indexterm" name="id2294482"></a><a class="indexterm" name="id2294494"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> START</code>
        </p><p>
          Brings online the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or all data nodes).
        </p><p>
          Beginning with MySQL 5.0.19, this command can also be used to
          individual management nodes online.

          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <code class="literal">ALL START</code> continues to affect data
              nodes only.
            </p></div><p>
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            To use this command to bring a data node online, the data
            node must have been started using <span><strong class="command">ndbd
            --nostart</strong></span> or <span><strong class="command">ndbd -n</strong></span>.
          </p></div></li><li><a class="indexterm" name="id2294563"></a><a class="indexterm" name="id2294575"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> STOP</code>
        </p><p>
          Stops the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or all data nodes).
        </p><p>
          Beginning with MySQL 5.0.19, this command can also be used to
          stop individual management nodes.

          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <code class="literal">ALL STOP</code> continues to affect data nodes
              only.
            </p></div><p>
        </p><p>
          A node affected by this command disconnects from the cluster,
          and its associated <span><strong class="command">ndbd</strong></span> or
          <span><strong class="command">ndb_mgmd</strong></span> process terminates.
        </p></li><li><a class="indexterm" name="id2294640"></a><a class="indexterm" name="id2294652"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> RESTART [-n] [-i]
          [-a]</code>
        </p><p>
          Restarts the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or all data nodes).
        </p><p>
          Using the <code class="option">-i</code> option with
          <code class="literal">RESTART</code> causes the data node to perform an
          initial restart; that is, the node's file system is deleted
          and recreated. The effect is the same as that obtained from
          stopping the data node process and then starting it again
          using <span><strong class="command">ndbd --initial</strong></span> from the system shell.
        </p><p>
          Using the <code class="option">-n</code> option causes the data node
          process to be restarted, but the data node is not actually
          brought online until the appropriate <code class="literal">START</code>
          command is issued. The effect of this option is the same as
          that obtained from stopping the data node and then starting it
          again using <code class="literal">ndbd --nostart</code> or <code class="literal">ndbd
          -n</code> from the system shell.
        </p><p>
          Using the <code class="option">-a</code> causes all current transactions
          relying on this node to be aborted. No GCP check is done when
          the node rejoins the cluster.
        </p></li><li><a class="indexterm" name="id2294740"></a><a class="indexterm" name="id2294752"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> STATUS</code>
        </p><p>
          Displays status information for the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or for all data nodes).
        </p></li><li><a class="indexterm" name="id2294784"></a><a class="indexterm" name="id2294796"></a><a class="indexterm" name="id2294805"></a><a class="indexterm" name="id2294818"></a><p>
          <code class="literal">ENTER SINGLE USER MODE
          <em class="replaceable"><code>node_id</code></em></code>
        </p><p>
          Enters single user mode, whereby only the MySQL server
          identified by the node ID <em class="replaceable"><code>node_id</code></em>
          is allowed to access the database.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            Do not attempt to have data nodes join the cluster while it
            is running in single user mode. Doing so can cause
            subsequent multiple node failures. Beginning with MySQL
            5.0.29, it is no longer possible to add nodes while in
            single user mode. (See <a href="http://bugs.mysql.com/20395" target="_top">Bug#20395</a> for more information.)
          </p></div></li><li><a class="indexterm" name="id2294865"></a><a class="indexterm" name="id2294878"></a><p>
          <code class="literal">EXIT SINGLE USER MODE</code>
        </p><p>
          Exits single user mode, allowing all SQL nodes (that is, all
          running <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> processes) to access the
          database.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            It is possible to use <code class="literal">EXIT SINGLE USER
            MODE</code> even when not in single user mode, although
            the command has no effect in this case.
          </p></div></li><li><a class="indexterm" name="id2294924"></a><a class="indexterm" name="id2294937"></a><a class="indexterm" name="id2294946"></a><a class="indexterm" name="id2294958"></a><p>
          <code class="literal">QUIT</code>, <code class="literal">EXIT</code>
        </p><p>
          Terminates the management client.
        </p><p>
          This command does not affect any nodes connected to the
          cluster.
        </p></li><li><a class="indexterm" name="id2294993"></a><a class="indexterm" name="id2295005"></a><p>
          <code class="literal">SHUTDOWN</code>
        </p><p>
          Shuts down all cluster data nodes and management nodes. To
          exit the management client after this has been done, use
          <code class="literal">EXIT</code> or <code class="literal">QUIT</code>.
        </p><p>
          This command does <span class="emphasis"><em>not</em></span> shut down any SQL
          nodes or API nodes that are connected to the cluster.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-backup"></a>17.7.3. Online Backup of MySQL Cluster</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-concepts">17.7.3.1. MySQL Cluster Backup Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-using-management-client">17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-configuration">17.7.3.3. Configuration for MySQL Cluster Backups</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-troubleshooting">17.7.3.4. MySQL Cluster Backup Troubleshooting</a></span></dt></dl></div><a class="indexterm" name="id2295059"></a><a class="indexterm" name="id2295071"></a><p>
      This section describes how to create a backup and how to restore
      the database from a backup at a later time.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-backup-concepts"></a>17.7.3.1. MySQL Cluster Backup Concepts</h4></div></div></div><a class="indexterm" name="id2295096"></a><a class="indexterm" name="id2295109"></a><p>
        A backup is a snapshot of the database at a given time. The
        backup consists of three main parts:
      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Metadata. </b>
              The names and definitions of all database tables
            </p></li><li><p><b>Table records. </b>
              The data actually stored in the database tables at the
              time that the backup was made
            </p></li><li><p><b>Transaction log. </b>
              A sequential record telling how and when data was stored
              in the database
            </p></li></ul></div><p>
        Each of these parts is saved on all nodes participating in the
        backup. During backup, each node saves these three parts into
        three files on disk:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>.<em class="replaceable"><code>node_id</code></em>.ctl</code>
          </p><p>
            A control file containing control information and metadata.
            Each node saves the same table definitions (for all tables
            in the cluster) to its own version of this file.
          </p></li><li><p>
            <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>-0.<em class="replaceable"><code>node_id</code></em>.data</code>
          </p><p>
            A data file containing the table records, which are saved on
            a per-fragment basis. That is, different nodes save
            different fragments during the backup. The file saved by
            each node starts with a header that states the tables to
            which the records belong. Following the list of records
            there is a footer containing a checksum for all records.
          </p></li><li><p>
            <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>.<em class="replaceable"><code>node_id</code></em>.log</code>
          </p><p>
            A log file containing records of committed transactions.
            Only transactions on tables stored in the backup are stored
            in the log. Nodes involved in the backup save different
            records because different nodes host different database
            fragments.
          </p></li></ul></div><p>
        In the listing above, <em class="replaceable"><code>backup_id</code></em>
        stands for the backup identifier and
        <em class="replaceable"><code>node_id</code></em> is the unique identifier for
        the node creating the file.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-backup-using-management-client"></a>17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup</h4></div></div></div><a class="indexterm" name="id2295276"></a><a class="indexterm" name="id2295288"></a><p>
        Before starting a backup, make sure that the cluster is properly
        configured for performing one. (See
        <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="17.7.3.3. Configuration for MySQL Cluster Backups">Section 17.7.3.3, “Configuration for MySQL Cluster Backups”</a>.)
      </p><a class="indexterm" name="id2295310"></a><p>
        The <code class="literal">START BACKUP</code> command is used to create a
        backup:
      </p><pre class="programlisting">START BACKUP [<em class="replaceable"><code>backup_id</code></em>] [<em class="replaceable"><code>wait_option</code></em>]

<em class="replaceable"><code>wait_option</code></em>:
WAIT {STARTED | COMPLETED} | NOWAIT
</pre><p>
        Successive backups are automatically identified sequentially, so
        the <em class="replaceable"><code>backup_id</code></em>, an integer greater
        than or equal to 1, is optional; if it is omitted, the next
        available value is used. If an existing
        <em class="replaceable"><code>backup_id</code></em> value is used, the backup
        fails with the error <span class="errortext">Backup failed: file already
        exists</span>. If used, the
        <em class="replaceable"><code>backup_id</code></em> must follow <code class="literal">START
        BACKUP</code> immediately, before any other options are used.
      </p><p>
        The maximum supported value for
        <em class="replaceable"><code>backup_id</code></em> in MySQL 5.0
        is 2147483648 (2<sup>31</sup>). (<a href="http://bugs.mysql.com/43042" target="_top">Bug#43042</a>)
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If you start a backup using <span><strong class="command">ndb_mgm -e "START
          BACKUP"</strong></span>, the <em class="replaceable"><code>backup_id</code></em> is
          required.
        </p></div><p>
        The <em class="replaceable"><code>wait_option</code></em> can be used to
        determine when control is returned to the management client
        after a <code class="literal">START BACKUP</code> command is issued, as
        shown in the following list:
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2295428"></a><a class="indexterm" name="id2295441"></a><p>
            If <code class="literal">NOWAIT</code> is specified, the management
            client displays a prompt immediately, as seen here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP NOWAIT</code></strong>
ndb_mgm&gt;
</pre><p>

            In this case, the management client can be used even while
            it prints progress information from the backup process.
          </p></li><li><a class="indexterm" name="id2295476"></a><a class="indexterm" name="id2295488"></a><p>
            With <code class="literal">WAIT STARTED</code> the management client
            waits until the backup has started before returning control
            to the user, as shown here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP WAIT STARTED</code></strong>
Waiting for started, this may take several minutes
Node 2: Backup 3 started from node 1
ndb_mgm&gt;
</pre><p>
          </p></li><li><a class="indexterm" name="id2295525"></a><a class="indexterm" name="id2295537"></a><p>
            <strong class="userinput"><code>WAIT COMPLETED</code></strong> causes the management
            client to wait until the backup process is complete before
            returning control to the user.
          </p></li></ul></div><p>
        <code class="literal">WAIT COMPLETED</code> is the default.
      </p><p>
        The procedure for creating a backup consists of the following
        steps:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Start the management client (<span><strong class="command">ndb_mgm</strong></span>),
              if it not running already.
            </p></li><li><p>
              Execute the <strong class="userinput"><code>START BACKUP</code></strong> command.
              This produces several lines of output indicating the
              progress of the backup, as shown here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP</code></strong>
Waiting for completed, this may take several minutes
Node 2: Backup 1 started from node 1
Node 2: Backup 1 started from node 1 completed
 StartGCP: 177 StopGCP: 180
 #Records: 7362 #LogRecords: 0
 Data: 453648 bytes Log: 0 bytes
ndb_mgm&gt;
</pre><p>
            </p></li><li><a class="indexterm" name="id2295622"></a><a class="indexterm" name="id2295635"></a><p>
              When the backup has started the management client displays
              this message:

</p><pre class="programlisting">Backup <em class="replaceable"><code>backup_id</code></em> started from node <em class="replaceable"><code>node_id</code></em>
</pre><p>

              <em class="replaceable"><code>backup_id</code></em> is the unique
              identifier for this particular backup. This identifier is
              saved in the cluster log, if it has not been configured
              otherwise. <em class="replaceable"><code>node_id</code></em> is the
              identifier of the management server that is coordinating
              the backup with the data nodes. At this point in the
              backup process the cluster has received and processed the
              backup request. It does not mean that the backup has
              finished. An example of this statement is shown here:

</p><pre class="programlisting">	
Node 2: Backup 1 started from node 1
</pre><p>
            </p></li><li><p>
              The management client indicates with a message like this
              one that the backup has started:

</p><pre class="programlisting">Backup <em class="replaceable"><code>backup_id</code></em> started from node <em class="replaceable"><code>node_id</code></em> completed
</pre><p>

              As is the case for the notification that the backup has
              started, <em class="replaceable"><code>backup_id</code></em> is the
              unique identifier for this particular backup, and
              <em class="replaceable"><code>node_id</code></em> is the node ID of the
              management server that is coordinating the backup with the
              data nodes. This output is accompanied by additional
              information including relevant global checkpoints, the
              number of records backed up, and the size of the data, as
              shown here:

</p><pre class="programlisting">	
Node 2: Backup 1 started from node 1 completed
 StartGCP: 177 StopGCP: 180
 #Records: 7362 #LogRecords: 0
 Data: 453648 bytes Log: 0 bytes
</pre><p>
            </p></li></ol></div><p>
      </p><p>
        It is also possible to perform a backup from the system shell by
        invoking <span><strong class="command">ndb_mgm</strong></span> with the <code class="option">-e</code>
        or <code class="option">--execute</code> option, as shown in this example:
      </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "START BACKUP 6 WAIT COMPLETED"</code></strong>
</pre><p>
        When using <code class="literal">START BACKUP</code> in this way, you must
        specify the backup ID.
      </p><p>
        Cluster backups are created by default in the
        <code class="filename">BACKUP</code> subdirectory of the
        <code class="literal">DataDir</code> on each data node. This can be
        overridden for one or more data nodes individually, or for all
        cluster data nodes in the <code class="filename">config.ini</code> file
        using the <code class="literal">BackupDataDir</code> configuration
        parameter as discussed in
        <a href="mysql-cluster.html#mysql-cluster-identifying-data-nodes">Identifying
        Data Nodes</a>. The backup files created for a backup with a
        given <em class="replaceable"><code>backup_id</code></em> are stored in a
        subdirectory named
        <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em></code>
        in the backup directory.
      </p><p>
        To abort a backup that is already in progress:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Start the management client.
          </p></li><li><p>
            Execute this command:
          </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ABORT BACKUP <em class="replaceable"><code>backup_id</code></em></code></strong>
</pre><p>
            The number <em class="replaceable"><code>backup_id</code></em> is the
            identifier of the backup that was included in the response
            of the management client when the backup was started (in the
            message <code class="literal">Backup <em class="replaceable"><code>backup_id</code></em>
            started from node
            <em class="replaceable"><code>management_node_id</code></em></code>).
          </p></li><li><p>
            The management client will acknowledge the abort request
            with <code class="literal">Abort of backup
            <em class="replaceable"><code>backup_id</code></em> ordered</code>.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              At this point, the management client has not yet received
              a response from the cluster data nodes to this request,
              and the backup has not yet actually been aborted.
            </p></div></li><li><p>
            After the backup has been aborted, the management client
            will report this fact in a manner similar to what is shown
            here:
          </p><pre class="programlisting">Node 1: Backup 3 started from 5 has been aborted. Error: 1321 - Backup aborted by user request: Permanent error: User defined error
Node 3: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
Node 2: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
Node 4: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
</pre><p>
            In this example, we have shown sample output for a cluster
            with 4 data nodes, where the sequence number of the backup
            to be aborted is <code class="literal">3</code>, and the management
            node to which the cluster management client is connected has
            the node ID <code class="literal">5</code>. The first node to complete
            its part in aborting the backup reports that the reason for
            the abort was due to a request by the user. (The remaining
            nodes report that the backup was aborted due to an
            unspecified internal error.)
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              There is no guarantee that the cluster nodes respond to an
              <code class="literal">ABORT BACKUP</code> command in any particular
              order.
            </p></div><p>
            The <code class="literal">Backup <em class="replaceable"><code>backup_id</code></em>
            started from node
            <em class="replaceable"><code>management_node_id</code></em> has been
            aborted</code> messages mean that the backup has been
            terminated and that all files relating to this backup have
            been removed from the cluster file system.
          </p></li></ol></div><p>
        It is also possible to abort a backup in progress from a system
        shell using this command:
      </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "ABORT BACKUP <em class="replaceable"><code>backup_id</code></em>"</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If there is no backup having the ID
          <em class="replaceable"><code>backup_id</code></em> running when an
          <code class="literal">ABORT BACKUP</code> is issued, the management
          client makes no response, nor is it indicated in the cluster
          log that an invalid abort command was sent.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-backup-configuration"></a>17.7.3.3. Configuration for MySQL Cluster Backups</h4></div></div></div><a class="indexterm" name="id2296014"></a><a class="indexterm" name="id2296026"></a><a class="indexterm" name="id2296039"></a><a class="indexterm" name="id2296051"></a><p>
        Five configuration parameters are essential for backup:
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2296072"></a><p>
            <code class="literal">BackupDataBufferSize</code>
          </p><p>
            The amount of memory used to buffer data before it is
            written to disk.
          </p></li><li><a class="indexterm" name="id2296097"></a><p>
            <code class="literal">BackupLogBufferSize</code>
          </p><p>
            The amount of memory used to buffer log records before these
            are written to disk.
          </p></li><li><a class="indexterm" name="id2296122"></a><p>
            <code class="literal">BackupMemory</code>
          </p><p>
            The total memory allocated in a database node for backups.
            This should be the sum of the memory allocated for the
            backup data buffer and the backup log buffer.
          </p></li><li><a class="indexterm" name="id2296148"></a><p>
            <code class="literal">BackupWriteSize</code>
          </p><p>
            The default size of blocks written to disk. This applies for
            both the backup data buffer and the backup log buffer.
          </p></li><li><a class="indexterm" name="id2296174"></a><p>
            <code class="literal">BackupMaxWriteSize</code>
          </p><p>
            The maximum size of blocks written to disk. This applies for
            both the backup data buffer and the backup log buffer.
          </p></li></ul></div><p>
        More detailed information about these parameters can be found in
        <a href="mysql-cluster.html#mysql-cluster-backup-parameters">Backup
        Parameters</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-backup-troubleshooting"></a>17.7.3.4. MySQL Cluster Backup Troubleshooting</h4></div></div></div><a class="indexterm" name="id2296218"></a><a class="indexterm" name="id2296230"></a><a class="indexterm" name="id2296243"></a><p>
        If an error code is returned when issuing a backup request, the
        most likely cause is insufficient memory or disk space. You
        should check that there is enough memory allocated for the
        backup.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          If you have set <code class="literal">BackupDataBufferSize</code> and
          <code class="literal">BackupLogBufferSize</code> and their sum is
          greater than 4MB, then you must also set
          <code class="literal">BackupMemory</code> as well. See
          <a href="mysql-cluster.html#ndbparam-ndbd-backupmemory"><code class="literal">BackupMemory</code></a>.
        </p></div><p>
        You should also make sure that there is sufficient space on the
        hard drive partition of the backup target.
      </p><p>
        <code class="literal">NDB</code> does not support repeatable
        reads, which can cause problems with the restoration process.
        Although the backup process is “<span class="quote">hot</span>”, restoring a
        MySQL Cluster from backup is not a 100% “<span class="quote">hot</span>”
        process. This is due to the fact that, for the duration of the
        restore process, running transactions get nonrepeatable reads
        from the restored data. This means that the state of the data is
        inconsistent while the restore is in progress.
      </p><p class="mnmas-kb"><b>MySQL Enterprise</b>
          MySQL Enterprise subscribers will find more information about
          Cluster backup in the Knowledge Base article,
          <a href="https://kb.mysql.com/view.php?id=5803" target="_top"> How Do I
          Backup my Cluster Database</a>. Access to the MySQL
          Knowledge Base collection of articles is one of the advantages
          of subscribing to MySQL Enterprise. For more information, see
          <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-event-reports"></a>17.7.4. Event Reports Generated in MySQL Cluster</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logging-management-commands">17.7.4.1. MySQL Cluster Logging Management Commands</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-log-events">17.7.4.2. MySQL Cluster Log Events</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-log-statistics">17.7.4.3. Using <code class="literal">CLUSTERLOG STATISTICS</code> in the MySQL Cluster
        Management Client</a></span></dt></dl></div><a class="indexterm" name="id2296358"></a><a class="indexterm" name="id2296370"></a><a class="indexterm" name="id2296379"></a><a class="indexterm" name="id2296388"></a><a class="indexterm" name="id2296397"></a><a class="indexterm" name="id2296410"></a><p>
      In this section, we discuss the types of event logs provided by
      MySQL Cluster, and the types of events that are logged.
    </p><p>
      MySQL Cluster provides two types of event log:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The <em class="firstterm">cluster log</em>, which includes events
          generated by all cluster nodes. The cluster log is the log
          recommended for most uses because it provides logging
          information for an entire cluster in a single location.
        </p><p>
          By default, the cluster log is saved to a file named
          <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>,
          (where <em class="replaceable"><code>node_id</code></em> is the node ID of
          the management server) in the same directory where the
          <span><strong class="command">ndb_mgm</strong></span> binary resides.
        </p><p>
          Cluster logging information can also be sent to
          <code class="literal">stdout</code> or a <code class="literal">syslog</code>
          facility in addition to or instead of being saved to a file,
          as determined by the values set for the
          <code class="literal">DataDir</code> and
          <code class="literal">LogDestination</code> configuration parameters.
          See <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="17.3.4.4. Defining a MySQL Cluster Management Server">Section 17.3.4.4, “Defining a MySQL Cluster Management Server”</a>, for more
          information about these parameters.
        </p></li><li><p>
          <em class="firstterm">Node logs</em> are local to each node.
        </p><p>
          Output generated by node event logging is written to the file
          <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
          (where <em class="replaceable"><code>node_id</code></em> is the node's node
          ID) in the node's <code class="literal">DataDir</code>. Node event logs
          are generated for both management nodes and data nodes.
        </p><p>
          Node logs are intended to be used only during application
          development, or for debugging application code.
        </p></li></ul></div><p>
      Both types of event logs can be set to log different subsets of
      events.
    </p><p>
      Each reportable event can be distinguished according to three
      different criteria:
    </p><a class="indexterm" name="id2296552"></a><a class="indexterm" name="id2296564"></a><div class="itemizedlist"><ul type="disc"><li><p>
          <span class="emphasis"><em>Category</em></span>: This can be any one of the
          following values: <code class="literal">STARTUP</code>,
          <code class="literal">SHUTDOWN</code>, <code class="literal">STATISTICS</code>,
          <code class="literal">CHECKPOINT</code>, <code class="literal">NODERESTART</code>,
          <code class="literal">CONNECTION</code>, <code class="literal">ERROR</code>, or
          <code class="literal">INFO</code>.
        </p></li><li><p>
          <span class="emphasis"><em>Priority</em></span>: This is represented by one of
          the numbers from 1 to 15 inclusive, where 1 indicates
          “<span class="quote">most important</span>” and 15 “<span class="quote">least
          important.</span>”
        </p></li><li><p>
          <span class="emphasis"><em>Severity Level</em></span>: This can be any one of
          the following values: <code class="literal">ALERT</code>,
          <code class="literal">CRITICAL</code>, <code class="literal">ERROR</code>,
          <code class="literal">WARNING</code>, <code class="literal">INFO</code>, or
          <code class="literal">DEBUG</code>.
        </p></li></ul></div><p>
      Both the cluster log and the node log can be filtered on these
      properties.
    </p><p>
      The format used in the cluster log is as shown here:
    </p><pre class="programlisting">2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Data usage is 2%(60 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Index usage is 1%(24 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Data usage is 2%(76 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Index usage is 1%(24 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Data usage is 2%(58 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Index usage is 1%(25 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Data usage is 2%(74 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Index usage is 1%(25 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 4: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 1: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 1: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 2: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 2: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 3: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 3: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 4: Node 9: API version 5.1.15
2007-01-26 19:59:22 [MgmSrvr] ALERT    -- Node 2: Node 7 Disconnected
2007-01-26 19:59:22 [MgmSrvr] ALERT    -- Node 2: Node 7 Disconnected
</pre><p>
      Each line in the cluster log contains the following information:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          A timestamp in
          <code class="literal"><em class="replaceable"><code>YYYY</code></em>-<em class="replaceable"><code>MM</code></em>-<em class="replaceable"><code>DD</code></em>
          <em class="replaceable"><code>HH</code></em>:<em class="replaceable"><code>MM</code></em>:<em class="replaceable"><code>SS</code></em></code>
          format.
        </p></li><li><p>
          The type of node which is performing the logging. In the
          cluster log, this is always <code class="literal">[MgmSrvr]</code>.
        </p></li><li><p>
          The severity of the event.
        </p></li><li><p>
          The ID of the node reporting the event.
        </p></li><li><p>
          A description of the event. The most common types of events to
          appear in the log are connections and disconnections between
          different nodes in the cluster, and when checkpoints occur. In
          some cases, the description may contain status information.
        </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-logging-management-commands"></a>17.7.4.1. MySQL Cluster Logging Management Commands</h4></div></div></div><a class="indexterm" name="id2296824"></a><a class="indexterm" name="id2296837"></a><a class="indexterm" name="id2296846"></a><a class="indexterm" name="id2296855"></a><a class="indexterm" name="id2296867"></a><a class="indexterm" name="id2296876"></a><p>
        The following management commands are related to the cluster
        log:
      </p><a class="indexterm" name="id2296893"></a><a class="indexterm" name="id2296905"></a><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">CLUSTERLOG ON</code>
          </p><p>
            Turns the cluster log on.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG OFF</code>
          </p><p>
            Turns the cluster log off.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG INFO</code>
          </p><p>
            Provides information about cluster log settings.
          </p></li><li><p>
            <code class="literal"><em class="replaceable"><code>node_id</code></em> CLUSTERLOG
            <em class="replaceable"><code>category</code></em>=<em class="replaceable"><code>threshold</code></em></code>
          </p><p>
            Logs <em class="replaceable"><code>category</code></em> events with
            priority less than or equal to
            <em class="replaceable"><code>threshold</code></em> in the cluster log.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG FILTER
            <em class="replaceable"><code>severity_level</code></em></code>
          </p><p>
            Toggles cluster logging of events of the specified
            <em class="replaceable"><code>severity_level</code></em>.
          </p></li></ul></div><p>
        The following table describes the default setting (for all data
        nodes) of the cluster log category threshold. If an event has a
        priority with a value lower than or equal to the priority
        threshold, it is reported in the cluster log.
      </p><a class="indexterm" name="id2297025"></a><a class="indexterm" name="id2297038"></a><p>
        Note that events are reported per data node, and that the
        threshold can be set to different values on different nodes.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Category</strong></span></td><td><span class="bold"><strong>Default threshold (All data nodes)</strong></span></td></tr><tr><td><code class="literal">STARTUP</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">SHUTDOWN</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">STATISTICS</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">CHECKPOINT</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">NODERESTART</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">CONNECTION</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">ERROR</code></td><td><span class="bold"><strong>15</strong></span></td></tr><tr><td><code class="literal">INFO</code></td><td><span class="bold"><strong>7</strong></span></td></tr></tbody></table></div><p>
        The <code class="literal">STATISTICS</code> category can provide a great
        deal of useful data. See
        <a href="mysql-cluster.html#mysql-cluster-log-statistics" title="17.7.4.3. Using CLUSTERLOG STATISTICS in the MySQL Cluster
        Management Client">Section 17.7.4.3, “Using <code class="literal">CLUSTERLOG STATISTICS</code> in the MySQL Cluster
        Management Client”</a>, for more
        information.
      </p><p>
        Thresholds are used to filter events within each category. For
        example, a <code class="literal">STARTUP</code> event with a priority of 3
        is not logged unless the threshold for
        <code class="literal">STARTUP</code> is set to 3 or higher. Only events
        with priority 3 or lower are sent if the threshold is 3.
      </p><a class="indexterm" name="id2297253"></a><a class="indexterm" name="id2297265"></a><p>
        The following table shows the event severity levels.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          These correspond to Unix <code class="literal">syslog</code> levels,
          except for <code class="literal">LOG_EMERG</code> and
          <code class="literal">LOG_NOTICE</code>, which are not used or mapped.
        </p></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>1</strong></span></td><td><code class="literal">ALERT</code></td><td>A condition that should be corrected immediately, such as a corrupted
                system database</td></tr><tr><td><span class="bold"><strong>2</strong></span></td><td><code class="literal">CRITICAL</code></td><td>Critical conditions, such as device errors or insufficient resources</td></tr><tr><td><span class="bold"><strong>3</strong></span></td><td><code class="literal">ERROR</code></td><td>Conditions that should be corrected, such as configuration errors</td></tr><tr><td><span class="bold"><strong>4</strong></span></td><td><code class="literal">WARNING</code></td><td>Conditions that are not errors, but that might require special handling</td></tr><tr><td><span class="bold"><strong>5</strong></span></td><td><code class="literal">INFO</code></td><td>Informational messages</td></tr><tr><td><span class="bold"><strong>6</strong></span></td><td><code class="literal">DEBUG</code></td><td>Debugging messages used for <code class="literal">NDBCLUSTER</code>
                development</td></tr></tbody></table></div><p>
        Event severity levels can be turned on or off (using
        <code class="literal">CLUSTERLOG FILTER</code> — see above). If a
        severity level is turned on, then all events with a priority
        less than or equal to the category thresholds are logged. If the
        severity level is turned off then no events belonging to that
        severity level are logged.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Cluster log levels are set on a per
          <span><strong class="command">ndb_mgmd</strong></span>, per subscriber basis. This means
          that, in a MySQL Cluster with multiple management servers,
          using a <code class="literal">CLUSTERLOG</code> command in an instance
          of <span><strong class="command">ndb_mgm</strong></span> connected to one management
          server affects only logs generated by that management server
          but not by any of the others. This also means that, should one
          of the management servers be restarted, only logs generated by
          that management server are affected by the resetting of log
          levels caused by the restart.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-log-events"></a>17.7.4.2. MySQL Cluster Log Events</h4></div></div></div><a class="indexterm" name="id2297516"></a><a class="indexterm" name="id2297529"></a><p>
        An event report reported in the event logs has the following
        format:
      </p><pre class="programlisting"><em class="replaceable"><code>datetime</code></em> [<em class="replaceable"><code>string</code></em>] <em class="replaceable"><code>severity</code></em> -- <em class="replaceable"><code>message</code></em>
</pre><p>
        For example:
      </p><pre class="programlisting">09:19:30 2005-07-24 [NDB] INFO -- Node 4 Start phase 4 completed
</pre><p>
        This section discusses all reportable events, ordered by
        category and severity level within each category.
      </p><p>
        In the event descriptions, GCP and LCP mean “<span class="quote">Global
        Checkpoint</span>” and “<span class="quote">Local Checkpoint</span>”,
        respectively.
      </p><a class="indexterm" name="id2297586"></a><a class="indexterm" name="id2297598"></a><a class="indexterm" name="id2297608"></a><a class="indexterm" name="id2297620"></a><p>
        <span class="bold"><strong><code class="literal">CONNECTION</code>
        Events</strong></span>
      </p><p>
        These events are associated with connections between Cluster
        nodes.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>data nodes connected</td><td>8</td><td><code class="literal">INFO</code></td><td>Data nodes connected</td></tr><tr><td>data nodes disconnected</td><td>8</td><td><code class="literal">INFO</code></td><td>Data nodes disconnected</td></tr><tr><td>Communication closed</td><td>8</td><td><code class="literal">INFO</code></td><td>SQL node or data node connection closed</td></tr><tr><td>Communication opened</td><td>8</td><td><code class="literal">INFO</code></td><td>SQL node or data node connection opened</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">CHECKPOINT</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2297800"></a><a class="indexterm" name="id2297812"></a><p>
        The logging messages shown here are associated with checkpoints.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>LCP stopped in calc keep GCI</td><td>0</td><td><code class="literal">ALERT</code></td><td>LCP stopped</td></tr><tr><td>Local checkpoint fragment completed</td><td>11</td><td><code class="literal">INFO</code></td><td>LCP on a fragment has been completed</td></tr><tr><td>Global checkpoint completed</td><td>10</td><td><code class="literal">INFO</code></td><td>GCP finished</td></tr><tr><td>Global checkpoint started</td><td>9</td><td><code class="literal">INFO</code></td><td>Start of GCP: REDO log is written to disk</td></tr><tr><td>Local checkpoint completed</td><td>8</td><td><code class="literal">INFO</code></td><td>LCP completed normally</td></tr><tr><td>Local checkpoint started</td><td>7</td><td><code class="literal">INFO</code></td><td>Start of LCP: data written to disk</td></tr><tr><td>Report undo log blocked</td><td>7</td><td><code class="literal">INFO</code></td><td>UNDO logging blocked; buffer near overflow</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">STARTUP</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2298040"></a><a class="indexterm" name="id2298052"></a><p>
        The following events are generated in response to the startup of
        a node or of the cluster and of its success or failure. They
        also provide information relating to the progress of the startup
        process, including information concerning logging activities.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Internal start signal received STTORRY</td><td>15</td><td><code class="literal">INFO</code></td><td>Blocks received after completion of restart</td></tr><tr><td>Undo records executed</td><td>15</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>New REDO log started</td><td>10</td><td><code class="literal">INFO</code></td><td>GCI keep <em class="replaceable"><code>X</code></em>, newest restorable GCI
                <em class="replaceable"><code>Y</code></em></td></tr><tr><td>New log started</td><td>10</td><td><code class="literal">INFO</code></td><td>Log part <em class="replaceable"><code>X</code></em>, start MB
                <em class="replaceable"><code>Y</code></em>, stop MB
                <em class="replaceable"><code>Z</code></em></td></tr><tr><td>Node has been refused for inclusion in the cluster</td><td>8</td><td><code class="literal">INFO</code></td><td>Node cannot be included in cluster due to misconfiguration, inability to
                establish communication, or other problem</td></tr><tr><td>data node neighbors</td><td>8</td><td><code class="literal">INFO</code></td><td>Shows neighboring data nodes</td></tr><tr><td>data node start phase <em class="replaceable"><code>X</code></em> completed</td><td>4</td><td><code class="literal">INFO</code></td><td>A data node start phase has been completed</td></tr><tr><td>Node has been successfully included into the cluster</td><td>3</td><td><code class="literal">INFO</code></td><td>Displays the node, managing node, and dynamic ID</td></tr><tr><td>data node start phases initiated</td><td>1</td><td><code class="literal">INFO</code></td><td>NDB Cluster nodes starting</td></tr><tr><td>data node all start phases completed</td><td>1</td><td><code class="literal">INFO</code></td><td>NDB Cluster nodes started</td></tr><tr><td>data node shutdown initiated</td><td>1</td><td><code class="literal">INFO</code></td><td>Shutdown of data node has commenced</td></tr><tr><td>data node shutdown aborted</td><td>1</td><td><code class="literal">INFO</code></td><td>Unable to shut down data node normally</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">NODERESTART</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2298402"></a><a class="indexterm" name="id2298414"></a><p>
        The following events are generated when restarting a node and
        relate to the success or failure of the node restart process.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Node failure phase completed</td><td>8</td><td><code class="literal">ALERT</code></td><td>Reports completion of node failure phases</td></tr><tr><td>Node has failed, node state was <em class="replaceable"><code>X</code></em></td><td>8</td><td><code class="literal">ALERT</code></td><td>Reports that a node has failed</td></tr><tr><td>Report arbitrator results</td><td>2</td><td><code class="literal">ALERT</code></td><td>There are eight different possible results for arbitration attempts:

                <div class="itemizedlist"><ul type="disc"><li><p>
                      Arbitration check failed — less than 1/2
                      nodes left
                    </p></li><li><p>
                      Arbitration check succeeded — node group
                      majority
                    </p></li><li><p>
                      Arbitration check failed — missing node
                      group
                    </p></li><li><p>
                      Network partitioning — arbitration required
                    </p></li><li><p>
                      Arbitration succeeded — affirmative response
                      from node <em class="replaceable"><code>X</code></em>
                    </p></li><li><p>
                      Arbitration failed - negative response from node
                      <em class="replaceable"><code>X</code></em>
                    </p></li><li><p>
                      Network partitioning - no arbitrator available
                    </p></li><li><p>
                      Network partitioning - no arbitrator configured
                    </p></li></ul></div></td></tr><tr><td>Completed copying a fragment</td><td>10</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying of dictionary information</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying distribution information</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Starting to copy fragments</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying all fragments</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>GCP takeover started</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>GCP takeover completed</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>LCP takeover started</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>LCP takeover completed (state = <em class="replaceable"><code>X</code></em>)</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Report whether an arbitrator is found or not</td><td>6</td><td><code class="literal">INFO</code></td><td>There are seven different possible outcomes when seeking an arbitrator:

                <div class="itemizedlist"><ul type="disc"><li><p>
                      Management server restarts arbitration thread
                      [state=<em class="replaceable"><code>X</code></em>]
                    </p></li><li><p>
                      Prepare arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Receive arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Started arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      - process failure
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      - process exit
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      &lt;error msg&gt;
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li></ul></div></td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">STATISTICS</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2298929"></a><a class="indexterm" name="id2298942"></a><p>
        The following events are of a statistical nature. They provide
        information such as numbers of transactions and other
        operations, amount of data sent or received by individual nodes,
        and memory usage.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Report job scheduling statistics</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean internal job scheduling statistics</td></tr><tr><td>Sent number of bytes</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean number of bytes sent to node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Received # of bytes</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean number of bytes received from node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Report transaction statistics</td><td>8</td><td><code class="literal">INFO</code></td><td>Numbers of: transactions, commits, reads, simple reads, writes,
                concurrent operations, attribute information, and aborts</td></tr><tr><td>Report operations</td><td>8</td><td><code class="literal">INFO</code></td><td>Number of operations</td></tr><tr><td>Report table create</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Memory usage</td><td>5</td><td><code class="literal">INFO</code></td><td>Data and index memory usage (80%, 90%, and 100%)</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">ERROR</code> Events</strong></span>
      </p><a class="indexterm" name="id2299174"></a><a class="indexterm" name="id2299187"></a><p>
        These events relate to Cluster errors and warnings. The presence
        of one or more of these generally indicates that a major
        malfunction or failure has occurred.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Dead due to missed heartbeat</td><td>8</td><td><code class="literal">ALERT</code></td><td>Node <em class="replaceable"><code>X</code></em> declared “<span class="quote">dead</span>” due to
                missed heartbeat</td></tr><tr><td>Transporter errors</td><td>2</td><td>ERROR</td><td> </td></tr><tr><td>Transporter warnings</td><td>8</td><td><code class="literal">WARNING</code></td><td> </td></tr><tr><td>Missed heartbeats</td><td>8</td><td><code class="literal">WARNING</code></td><td>Node <em class="replaceable"><code>X</code></em> missed heartbeat
                #<em class="replaceable"><code>Y</code></em></td></tr><tr><td>General warning events</td><td>2</td><td><code class="literal">WARNING</code></td><td> </td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">INFO</code> Events</strong></span>
      </p><a class="indexterm" name="id2299380"></a><a class="indexterm" name="id2299392"></a><p>
        These events provide general information about the state of the
        cluster and activities associated with Cluster maintenance, such
        as logging and heartbeat transmission.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Sent heartbeat</td><td>12</td><td><code class="literal">INFO</code></td><td>Heartbeat sent to node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Create log bytes</td><td>11</td><td><code class="literal">INFO</code></td><td>Log part, log file, MB</td></tr><tr><td>General information events</td><td>2</td><td><code class="literal">INFO</code></td><td> </td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-log-statistics"></a>17.7.4.3. Using <code class="literal">CLUSTERLOG STATISTICS</code> in the MySQL Cluster
        Management Client</h4></div></div></div><a class="indexterm" name="id2299541"></a><a class="indexterm" name="id2299554"></a><a class="indexterm" name="id2299563"></a><a class="indexterm" name="id2299575"></a><a class="indexterm" name="id2299588"></a><a class="indexterm" name="id2299600"></a><p>
        The <code class="literal">NDB</code> management client's
        <code class="literal">CLUSTERLOG STATISTICS</code> command can provide a
        number of useful statistics in its output. Counters providing
        information about the state of the cluster are updated at
        5-second reporting intervals by the transaction coordinator (TC)
        and the local query handler (LQH), and written to the cluster
        log.
      </p><p><b>Transaction coordinator statistics. </b>
          Each transaction has one transaction coordinator, which is
          chosen by one of the following methods:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                In a round-robin fashion
              </p></li><li><p>
                By communication proximity
              </p></li></ul></div><p>

          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              You can determine which TC selection method is used for
              transactions started from a given SQL node using the
              <a href="mysql-cluster.html#sysvar_ndb_optimized_node_selection"><code class="literal">ndb_optimized_node_selection</code></a>
              system variable. For more information, see
              <a href="mysql-cluster.html#mysql-cluster-system-variables" title="17.4.3. MySQL Cluster System Variables">Section 17.4.3, “MySQL Cluster System Variables”</a>.
            </p></div><p>

          All operations within the same transaction use the same
          transaction coordinator, which reports the following
          statistics:

          </p><div class="itemizedlist"><ul type="disc"><li><p><b><code class="literal">Trans count</code>. </b>
                  This is the number transactions started in the last
                  interval using this TC as the transaction coordinator.
                  Any of these transactions may have committed, have
                  been aborted, or remain uncommitted at the end of the
                  reporting interval.

                  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                      Transactions do not migrate between TCs.
                    </p></div><p>
                </p></li><li><p><b><code class="literal">Commit count</code>. </b>
                  This is the number of transactions using this TC as
                  the transaction coordinator that were committed in the
                  last reporting interval. Because some transactions
                  committed in this reporting interval may have started
                  in a previous reporting interval, it is possible for
                  <code class="literal">Commit count</code> to be greater than
                  <code class="literal">Trans count</code>.
                </p></li><li><p><b><code class="literal">Read count</code>. </b>
                  This is the number of primary key read operations
                  using this TC as the transaction coordinator that were
                  started in the last reporting interval, including
                  simple reads. This count also includes reads performed
                  as part of unique index operations. A unique index
                  read operation generates 2 primary key read operations
                  — 1 for the hidden unique index table, and 1 for
                  the table on which the read takes place.
                </p></li><li><p><b><code class="literal">Simple read count</code>. </b>
                  This is the number of simple read operations using
                  this TC as the transaction coordinator that were
                  started in the last reporting interval. This is a
                  subset of <code class="literal">Read count</code>. Because the
                  value of <code class="literal">Simple read count</code> is
                  incremented at a different point in time from
                  <code class="literal">Read count</code>, it can lag behind
                  <code class="literal">Read count</code> slightly, so it is
                  conceivable that <code class="literal">Simple read count</code>
                  is not equal to <code class="literal">Read count</code> for a
                  given reporting interval, even if all reads made
                  during that time were in fact simple reads.
                </p></li><li><p><b><code class="literal">Write count</code>. </b>
                  This is the number of primary key write operations
                  using this TC as the transaction coordinator that were
                  started in the last reporting interval. This includes
                  all inserts, updates, writes and deletes, as well as
                  writes performed as part of unique index operations.

                  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                      A unique index update operation can generate
                      multiple PK read and write operations on the index
                      table and on the base table.
                    </p></div><p>
                </p></li><li><p><b><code class="literal">AttrInfoCount</code>. </b>
                  This is the number of 32-bit data words received in
                  the last reporting interval for primary key operations
                  using this TC as the transaction coordinator. For
                  reads, this is proportional to the number of columns
                  requested. For inserts and updates, this is
                  proportional to the number of columns written, and the
                  size of their data. For delete operations, this is
                  usually zero. Unique index operations generate
                  multiple PK operations and so increase this count.
                  However, data words sent to describe the PK operation
                  itself, and the key information sent, are
                  <span class="emphasis"><em>not</em></span> counted here. Attribute
                  information sent to describe columns to read for
                  scans, or to describe ScanFilters, is also not counted
                  in <code class="literal">AttrInfoCount</code>.
                </p></li><li><p><b><code class="literal">Concurrent Operations</code>. </b>
                  This is the number of primary key or scan operations
                  using this TC as the transaction coordinator that were
                  started during the last reporting interval but that
                  were not completed. Operations increment this counter
                  when they are started and decrement it when they are
                  completed; this occurs after the transaction commits.
                  Dirty reads and writes — as well as failed
                  operations — decrement this counter. The maximum
                  value that <code class="literal">Concurrent Operations</code>
                  can have is the maximum number of operations that a TC
                  block can support; currently, this is <code class="literal">(2 *
                  MaxNoOfConcurrentOperations) + 16 +
                  MaxNoOfConcurrentTransactions</code>. (For more
                  information about these configuration parameters, see
                  the <em class="citetitle">Transaction Parameters</em>
                  section of
                  <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="17.3.4.5. Defining MySQL Cluster Data Nodes">Section 17.3.4.5, “Defining MySQL Cluster Data Nodes”</a>.)
                </p></li><li><p><b><code class="literal">Abort count</code>. </b>
                  This is the number of transactions using this TC as
                  the transaction coordinator that were aborted during
                  the last reporting interval. Because some transactions
                  that were aborted in the last reporting interval may
                  have started in a previous reporting interval,
                  <code class="literal">Abort count</code> can sometimes be
                  greater than <code class="literal">Trans count</code>.
                </p></li><li><p><b><code class="literal">Scans</code>. </b>
                  This is the number of table scans using this TC as the
                  transaction coordinator that were started during the
                  last reporting interval. This does not include range
                  scans (that is, ordered index scans).
                </p></li><li><p><b><code class="literal">Range scans</code>. </b>
                  This is the number of ordered index scans using this
                  TC as the transaction coordinator that were started in
                  the last reporting interval.
                </p></li></ul></div><p>
        </p><p><b>Local query handler statistics (<code class="literal">Operations</code>). </b>
          There is 1 cluster event per local query handler block (that
          is, 1 per data node process). Operations are recorded in the
          LQH where the data they are operating on resides.

          


          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              A single transaction may operate on data stored in
              multiple LQH blocks.
            </p></div><p>

          The <code class="literal">Operations</code> statistic provides the
          number of local operations performed by this LQH block in the
          last reporting interval, and includes all types of read and
          write operations (insert, update, write, and delete
          operations). This also includes operations used to replicate
          writes — for example, in a 2-replica cluster, the write
          to the primary replica is recorded in the primary LQH, and the
          write to the backup will be recorded in the backup LQH. Unique
          key operations may result in multiple local operations;
          however, this does <span class="emphasis"><em>not</em></span> include local
          operations generated as a result of a table scan or ordered
          index scan, which are not counted.
        </p><p><b>Process scheduler statistics. </b>
          In addition to the statistics reported by the transaction
          coordinator and local query handler, each
          <span><strong class="command">ndbd</strong></span> process has a scheduler which also
          provides useful metrics relating to the performance of a MySQL
          Cluster. This scheduler runs in an infinite loop; during each
          loop the scheduler performs the following tasks:

          <a class="indexterm" name="id2300076"></a>

          </p><div class="orderedlist"><ol type="1"><li><p>
                Read any incoming messages from sockets into a job
                buffer.
              </p></li><li><p>
                Check whether there are any timed messages to be
                executed; if so, put these into the job buffer as well.
              </p></li><li><p>
                Execute (in a loop) any messages in the job buffer.
              </p></li><li><p>
                Send any distributed messages that were generated by
                executing the messages in the job buffer.
              </p></li><li><p>
                Wait for any new incoming messages.
              </p></li></ol></div><p>

          Process scheduler statistics include the following:

          </p><div class="itemizedlist"><ul type="disc"><li><p><b><code class="literal">Mean Loop Counter</code>. </b>
                  This is the number of loops executed in the third step
                  from the preceding list. This statistic increases in
                  size as the utilization of the TCP/IP buffer improves.
                  You can use this to monitor changes in performance as
                  you add new data node processes.
                </p></li><li><p><b><code class="literal">Mean send size</code> and <code class="literal">Mean receive
                  size</code>. </b>
                  These statistics allow you to gauge the efficiency of,
                  respectively writes and reads between nodes. The
                  values are given in bytes. Higher values mean a lower
                  cost per byte sent or received; the maximum value is
                  64K.
                </p></li></ul></div><p>
        </p><p>
        To cause all cluster log statistics to be logged, you can use
        the following command in the <code class="literal">NDB</code>
        management client:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ALL CLUSTERLOG STATISTICS=15</code></strong>
</pre><p>

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Setting the threshold for <code class="literal">STATISTICS</code> to
            15 causes the cluster log to become very verbose, and to
            grow quite rapidly in size, in direct proportion to the
            number of cluster nodes and the amount of activity in the
            MySQL Cluster.
          </p></div><p>

        For more information about MySQL Cluster management client
        commands relating to logging and reporting, see
        <a href="mysql-cluster.html#mysql-cluster-logging-management-commands" title="17.7.4.1. MySQL Cluster Logging Management Commands">Section 17.7.4.1, “MySQL Cluster Logging Management Commands”</a>.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-logs-ndb-messages"></a>17.7.5. MySQL Cluster Log Messages</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-cluster-log">17.7.5.1. MySQL Cluster — Messages in the Cluster Log</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-transporter-errors">17.7.5.2. MySQL Cluster — <code class="literal">NDB</code> Transporter
        Errors</a></span></dt></dl></div><p>
      This section contains information about the messages written to
      the cluster log in response to different cluster log events. It
      provides additional, more specific information on
      <code class="literal">NDB</code> transporter errors.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-logs-cluster-log"></a>17.7.5.1. MySQL Cluster — Messages in the Cluster Log</h4></div></div></div><p>
        The following table lists the most common
        <code class="literal">NDB</code> cluster log messages. For
        information about the cluster log, log events, and event types,
        see <a href="mysql-cluster.html#mysql-cluster-event-reports" title="17.7.4. Event Reports Generated in MySQL Cluster">Section 17.7.4, “Event Reports Generated in MySQL Cluster”</a>. These log
        messages also correspond to log event types in the MGM API; see
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-logevent-type.html" target="_top">The <code class="literal">Ndb_logevent_type</code> Type</a>, for related information of
        interest to Cluster API developers.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em>
                    Connected</code>
                  </p>

                <p><b>Description. </b>
                    The data node having node ID
                    <em class="replaceable"><code>node_id</code></em> has connected to
                    the management server (node
                    <em class="replaceable"><code>mgm_node_id</code></em>).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">Connected</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em>
                    Disconnected</code>
                  </p>

                <p><b>Description. </b>
                    The data node having node ID
                    <em class="replaceable"><code>data_node_id</code></em> has
                    disconnected from the management server (node
                    <em class="replaceable"><code>mgm_node_id</code></em>).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">Disconnected</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>data_node_id</code></em>:
                    Communication to Node
                    <em class="replaceable"><code>api_node_id</code></em>
                    closed</code>
                  </p>

                <p><b>Description. </b>
                    The API node or SQL node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> is no longer
                    communicating with data node
                    <em class="replaceable"><code>data_node_id</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CommunicationClosed</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>data_node_id</code></em>:
                    Communication to Node
                    <em class="replaceable"><code>api_node_id</code></em>
                    opened</code>
                  </p>

                <p><b>Description. </b>
                    The API node or SQL node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> is now
                    communicating with data node
                    <em class="replaceable"><code>data_node_id</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CommunicationOpened</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>api_node_id</code></em>: API
                    <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The API node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> has connected
                    to management node
                    <em class="replaceable"><code>mgm_node_id</code></em> using
                    <code class="literal">NDB</code> API version
                    <em class="replaceable"><code>version</code></em> (generally the
                    same as the MySQL version number).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ConnectedApiVersion</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Global checkpoint <em class="replaceable"><code>gci</code></em>
                    started</code>
                  </p>

                <p><b>Description. </b>
                    A global checkpoint with the ID
                    <em class="replaceable"><code>gci</code></em> has been started;
                    node <em class="replaceable"><code>node_id</code></em> is the
                    master responsible for this global checkpoint.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GlobalCheckpointStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Global checkpoint <em class="replaceable"><code>gci</code></em>
                    completed</code>
                  </p>

                <p><b>Description. </b>
                    The global checkpoint having the ID
                    <em class="replaceable"><code>gci</code></em> has been completed;
                    node <em class="replaceable"><code>node_id</code></em> was the
                    master responsible for this global checkpoint.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GlobalCheckpointCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    10
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local checkpoint <em class="replaceable"><code>lcp</code></em>
                    started. Keep GCI =
                    <em class="replaceable"><code>current_gci</code></em> oldest
                    restorable GCI =
                    <em class="replaceable"><code>old_gci</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The local checkpoint having sequence ID
                    <em class="replaceable"><code>lcp</code></em> has been started on
                    node <em class="replaceable"><code>node_id</code></em>. The most
                    recent GCI that can be used has the index
                    <em class="replaceable"><code>current_gci</code></em>, and the
                    oldest GCI from which the cluster can be restored
                    has the index <em class="replaceable"><code>old_gci</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LocalCheckpointStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local checkpoint <em class="replaceable"><code>lcp</code></em>
                    completed</code>
                  </p>

                <p><b>Description. </b>
                    The local checkpoint having sequence ID
                    <em class="replaceable"><code>lcp</code></em> on node
                    <em class="replaceable"><code>node_id</code></em> has been
                    completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LocalCheckpointCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local Checkpoint stopped in
                    CALCULATED_KEEP_GCI</code>
                  </p>

                <p><b>Description. </b>
                    The node was unable to determine the most recent
                    usable GCI.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCPStoppedInCalcKeepGci</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    0
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table ID = <em class="replaceable"><code>table_id</code></em>,
                    fragment <em class="replaceable"><code>ID = fragment_id</code></em>
                    has completed LCP on Node
                    <em class="replaceable"><code>node_id</code></em> maxGciStarted:
                    <em class="replaceable"><code>started_gci</code></em>
                    maxGciCompleted:
                    <em class="replaceable"><code>completed_gci</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A table fragment has been checkpointed to disk on
                    node <em class="replaceable"><code>node_id</code></em>. The GCI in
                    progress has the index
                    <em class="replaceable"><code>started_gci</code></em>, and the most
                    recent GCI to have been completed has the index
                    <em class="replaceable"><code>completed_gci</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCPFragmentCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    11
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    ACC Blocked <em class="replaceable"><code>num_1</code></em> and TUP
                    Blocked <em class="replaceable"><code>num_2</code></em> times last
                    second</code>
                  </p>

                <p><b>Description. </b>
                    Undo logging is blocked because the log buffer is
                    close to overflowing.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">UndoLogBlocked</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Start initiated
                    <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Data node <em class="replaceable"><code>node_id</code></em>,
                    running <code class="literal">NDB</code> version
                    <em class="replaceable"><code>version</code></em>, is beginning its
                    startup process.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStartStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Started <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Data node <em class="replaceable"><code>node_id</code></em>,
                    running <code class="literal">NDB</code> version
                    <em class="replaceable"><code>version</code></em>, has started
                    successfully.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStartCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    STTORRY received after restart finished</code>
                  </p>

                <p><b>Description. </b>
                    The node has received a signal indicating that a
                    cluster restart has completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">STTORRYRecieved</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    15
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Start phase <em class="replaceable"><code>phase</code></em>
                    completed
                    (<em class="replaceable"><code>type</code></em>)</code>
                  </p>

                <p><b>Description. </b>
                    The node has completed start phase
                    <em class="replaceable"><code>phase</code></em> of a
                    <em class="replaceable"><code>type</code></em> start. For a listing
                    of start phases, see
                    <a href="mysql-cluster.html#mysql-cluster-start-phases" title="17.7.1. Summary of MySQL Cluster Start Phases">Section 17.7.1, “Summary of MySQL Cluster Start Phases”</a>.
                    (<em class="replaceable"><code>type</code></em> is one of
                    <code class="literal">initial</code>,
                    <a href="optimization.html#jointype_system"><code class="literal">system</code></a>,
                    <code class="literal">node</code>, <code class="literal">initial
                    node</code>, or
                    <code class="literal">&lt;Unknown&gt;</code>.)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartPhaseCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    CM_REGCONF president =
                    <em class="replaceable"><code>president_id</code></em>, own Node =
                    <em class="replaceable"><code>own_id</code></em>, our dynamic id =
                    <em class="replaceable"><code>dynamic_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Node <em class="replaceable"><code>president_id</code></em> has
                    been selected as “<span class="quote">president</span>”.
                    <em class="replaceable"><code>own_id</code></em> and
                    <em class="replaceable"><code>dynamic_id</code></em> should always
                    be the same as the ID
                    (<em class="replaceable"><code>node_id</code></em>) of the
                    reporting node.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CM_REGCONF</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    3
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    CM_REGREF from Node
                    <em class="replaceable"><code>president_id</code></em> to our Node
                    <em class="replaceable"><code>node_id</code></em>. Cause =
                    <em class="replaceable"><code>cause</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The reporting node (ID
                    <em class="replaceable"><code>node_id</code></em>) was unable to
                    accept node <em class="replaceable"><code>president_id</code></em>
                    as president. The <em class="replaceable"><code>cause</code></em>
                    of the problem is given as one of
                    <code class="literal">Busy</code>, <code class="literal">Election with wait
                    = false</code>, <code class="literal">Not president</code>,
                    <code class="literal">Election without selecting new
                    candidate</code>, or <code class="literal">No such
                    cause</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CM_REGREF</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>: We
                    are Node <em class="replaceable"><code>own_id</code></em> with
                    dynamic ID <em class="replaceable"><code>dynamic_id</code></em>,
                    our left neighbour is Node
                    <em class="replaceable"><code>id_1</code></em>, our right is Node
                    <em class="replaceable"><code>id_2</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The node has discovered its neighboring nodes in the
                    cluster (node <em class="replaceable"><code>id_1</code></em> and
                    node <em class="replaceable"><code>id_2</code></em>).
                    <em class="replaceable"><code>node_id</code></em>,
                    <em class="replaceable"><code>own_id</code></em>, and
                    <em class="replaceable"><code>dynamic_id</code></em> should always
                    be the same; if they are not, this indicates a
                    serious misconfiguration of the cluster nodes.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">FIND_NEIGHBOURS</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    <em class="replaceable"><code>type</code></em> shutdown
                    initiated</code>
                  </p>

                <p><b>Description. </b>
                    The node has received a shutdown signal. The
                    <em class="replaceable"><code>type</code></em> of shutdown is
                    either <code class="literal">Cluster</code> or
                    <code class="literal">Node</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node shutdown completed </code>[<code class="literal">,
                    <em class="replaceable"><code>action</code></em></code>]
                    [<code class="literal">Initiated by signal
                    <em class="replaceable"><code>signal</code></em>.</code>]
                  </p>

                <p><b>Description. </b>
                    The node has been shut down. This report may include
                    an <em class="replaceable"><code>action</code></em>, which if
                    present is one of <code class="literal">restarting</code>,
                    <code class="literal">no start</code>, or
                    <code class="literal">initial</code>. The report may also
                    include a reference to an
                    <code class="literal">NDB</code> Protocol
                    <em class="replaceable"><code>signal</code></em>; for possible
                    signals, refer to
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndb-protocol-operations-signals.html" target="_top">Operations and Signals</a>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Forced node shutdown completed </code>[<code class="literal">,
                    action</code>]<code class="literal">.</code>
                    [<code class="literal">Occured during startphase
                    <em class="replaceable"><code>start_phase</code></em>.</code>]
                    [<code class="literal"> Initiated by
                    <em class="replaceable"><code>signal</code></em>.</code>]
                    [<code class="literal">Caused by error
                    <em class="replaceable"><code>error_code</code></em>:
                    '<em class="replaceable"><code>error_message</code></em>(<em class="replaceable"><code>error_classification</code></em>).
                    <em class="replaceable"><code>error_status</code></em>'.</code>
                    [<code class="literal">(extra info
                    <em class="replaceable"><code>extra_code</code></em>)</code>]]
                  </p>

                <p><b>Description. </b>
                    The node has been forcibly shut down. The
                    <em class="replaceable"><code>action</code></em> (one of
                    <code class="literal">restarting</code>, <code class="literal">no
                    start</code>, or <code class="literal">initial</code>)
                    subsequently being taken, if any, is also reported.
                    If the shutdown occurred while the node was
                    starting, the report includes the
                    <em class="replaceable"><code>start_phase</code></em> during which
                    the node failed. If this was a result of a
                    <em class="replaceable"><code>signal</code></em> sent to the node,
                    this information is also provided (see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndb-protocol-operations-signals.html" target="_top">Operations and Signals</a>,
                    for more information). If the error causing the
                    failure is known, this is also included; for more
                    information about <code class="literal">NDB</code>
                    error messages and classifications, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-errors.html" target="_top">MySQL Cluster API Errors</a>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopForced</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node shutdown aborted</code>
                  </p>

                <p><b>Description. </b>
                    The node shutdown process was aborted by the user.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopAborted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    StartLog: [GCI Keep:
                    <em class="replaceable"><code>keep_pos</code></em> LastCompleted:
                    <em class="replaceable"><code>last_pos</code></em>
                    NewestRestorable:
                    <em class="replaceable"><code>restore_pos</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This reports global checkpoints referenced during a
                    node start. The redo log prior to
                    <em class="replaceable"><code>keep_pos</code></em> is dropped.
                    <em class="replaceable"><code>last_pos</code></em> is the last
                    global checkpoint in which data node the
                    participated; <em class="replaceable"><code>restore_pos</code></em>
                    is the global checkpoint which is actually used to
                    restore all data nodes.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartREDOLog</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <em class="replaceable"><code>startup_message</code></em>
                    [<span class="emphasis"><em>Listed separately; see below.</em></span>]
                  </p>

                <p><b>Description. </b>
                    There are a number of possible startup messages that
                    can be logged under different circumstances.

                    

                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartReport</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copy of dictionary
                    information</code>
                  </p>

                <p><b>Description. </b>
                    Copying of data dictionary information to the
                    restarted node has been completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyDict</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copy of distribution
                    information</code>
                  </p>

                <p><b>Description. </b>
                    Copying of data distribution information to the
                    restarted node has been completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyDistr</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart starting to copy the fragments to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Copy of fragments to starting data node
                    <em class="replaceable"><code>node_id</code></em> has begun
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragsStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table ID = <em class="replaceable"><code>table_id</code></em>,
                    fragment ID = <em class="replaceable"><code>fragment_id</code></em>
                    have been copied to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Fragment <em class="replaceable"><code>fragment_id</code></em> from
                    table <em class="replaceable"><code>table_id</code></em> has been
                    copied to data node
                    <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragDone</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    10
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copying the fragments to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Copying of all table fragments to restarting data
                    node <em class="replaceable"><code>node_id</code></em> has been
                    completed
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragsCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    Any of the following:

                    </p><div class="orderedlist"><ol type="1"><li><p>
                          <code class="literal">Node
                          <em class="replaceable"><code>node_id</code></em>: Node
                          <em class="replaceable"><code>node1_id</code></em> completed
                          failure of Node
                          <em class="replaceable"><code>node2_id</code></em></code>
                        </p></li><li><p>
                          <code class="literal">All nodes completed failure of Node
                          <em class="replaceable"><code>node_id</code></em></code>
                        </p></li><li><p>
                          <code class="literal">Node failure of
                          <em class="replaceable"><code>node_id</code></em><em class="replaceable"><code>block</code></em>
                          completed</code>
                        </p></li></ol></div><p>
                  </p>

                <p><b>Description. </b>
                    One of the following (each corresponding to the
                    same-numbered message listed above):

                    </p><div class="orderedlist"><ol type="1"><li><p>
                          Data node <em class="replaceable"><code>node1_id</code></em>
                          has detected the failure of data node
                          <em class="replaceable"><code>node2_id</code></em>
                        </p></li><li><p>
                          All (remaining) data nodes have detected the
                          failure of data node
                          <em class="replaceable"><code>node_id</code></em>
                        </p></li><li><p>
                          The failure of data node
                          <em class="replaceable"><code>node_id</code></em> has been
                          detected in the
                          <em class="replaceable"><code>block</code></em><code class="literal">NDB</code>
                          kernel block, where block is 1 of
                          <code class="literal">DBTC</code>,
                          <code class="literal">DBDICT</code>,
                          <code class="literal">DBDIH</code>, or
                          <code class="literal">DBLQH</code>; for more
                          information, see
                          <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-kernel-blocks.html" target="_top"><code class="literal">NDB</code> Kernel Blocks</a>
                        </p></li></ol></div><p>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NodeFailCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em> has failed.
                    The Node state at failure was
                    <em class="replaceable"><code>state_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A data node has failed. Its state at the time of
                    failure is described by an arbitration state code
                    <em class="replaceable"><code>state_code</code></em>: possible
                    state code values can be found in the file
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NODE_FAILREP</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">President restarts arbitration thread
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Prepare arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Receive arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Started arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> - process failure
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> - process exit
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> -
                    <em class="replaceable"><code>error_message</code></em>
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This is a report on the current state and progress
                    of arbitration in the cluster.
                    <em class="replaceable"><code>node_id</code></em> is the node ID of
                    the management node or SQL node selected as the
                    arbitrator. <em class="replaceable"><code>state_code</code></em> is
                    an arbitration state code, as found in
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                    When an error has occurred, an
                    <em class="replaceable"><code>error_message</code></em>, also
                    defined in <code class="filename">ArbitSignalData.hpp</code>,
                    is provided. <em class="replaceable"><code>ticket_id</code></em> is
                    a unique identifier handed out by the arbitrator
                    when it is selected to all the nodes that
                    participated in its selection; this is used to
                    insure that each node requesting arbitration was one
                    of the nodes that took part in the selection
                    process.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ArbitState</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    6
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Arbitration check lost - less than 1/2
                    nodes left</code> or <code class="literal">Arbitration check
                    won - all node groups and more than 1/2 nodes
                    left</code> or <code class="literal">Arbitration check won -
                    node group majority</code> or
                    <code class="literal">Arbitration check lost - missing node
                    group</code> or <code class="literal">Network partitioning -
                    arbitration required</code> or
                    <code class="literal">Arbitration won - positive reply from node
                    <em class="replaceable"><code>node_id</code></em></code> or
                    <code class="literal">Arbitration lost - negative reply from node
                    <em class="replaceable"><code>node_id</code></em></code> or
                    <code class="literal">Network partitioning - no arbitrator
                    available</code> or <code class="literal">Network partitioning
                    - no arbitrator configured</code> or
                    <code class="literal">Arbitration failure -
                    <em class="replaceable"><code>error_message</code></em>
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This message reports on the result of arbitration.
                    In the event of arbitration failure, an
                    <em class="replaceable"><code>error_message</code></em> and an
                    arbitration <em class="replaceable"><code>state_code</code></em>
                    are provided; definitions for both of these are
                    found in
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ArbitResult</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    2
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    GCP Take over started</code>
                  </p>

                <p><b>Description. </b>
                    This node is attempting to assume responsibility for
                    the next global checkpoint (that is, it is becoming
                    the master node)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GCP_TakeoverStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    GCP Take over completed</code>
                  </p>

                <p><b>Description. </b>
                    This node has become the master, and has assumed
                    responsibility for the next global checkpoint
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GCP_TakeoverCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    LCP Take over started</code>
                  </p>

                <p><b>Description. </b>
                    This node is attempting to assume responsibility for
                    the next set of local checkpoints (that is, it is
                    becoming the master node)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCP_TakeoverStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    LCP Take over completed</code>
                  </p>

                <p><b>Description. </b>
                    This node has become the master, and has assumed
                    responsibility for the next set of local checkpoints
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCP_TakeoverCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Trans. Count =
                    <em class="replaceable"><code>transactions</code></em>, Commit
                    Count = <em class="replaceable"><code>commits</code></em>, Read
                    Count = <em class="replaceable"><code>reads</code></em>, Simple
                    Read Count =
                    <em class="replaceable"><code>simple_reads</code></em>, Write Count
                    = <em class="replaceable"><code>writes</code></em>, AttrInfo Count
                    = <em class="replaceable"><code>AttrInfo_objects</code></em>,
                    Concurrent Operations =
                    <em class="replaceable"><code>concurrent_operations</code></em>,
                    Abort Count = <em class="replaceable"><code>aborts</code></em>,
                    Scans = <em class="replaceable"><code>scans</code></em>, Range
                    scans =
                    <em class="replaceable"><code>range_scans</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This report of transaction activity is given
                    approximately once every 10 seconds
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransReportCounters</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Operations=<em class="replaceable"><code>operations</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Number of operations performed by this node,
                    provided approximately once every 10 seconds
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">OperationReportCounters</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table with ID = <em class="replaceable"><code>table_id</code></em>
                    created</code>
                  </p>

                <p><b>Description. </b>
                    A table having the table ID shown has been created
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TableCreated</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Mean loop Counter in doJob last 8192 times =
                    <em class="replaceable"><code>count</code></em></code>
                  </p>

                <p><b>Description. </b></p></td><td><p><b>Event Name. </b>
                    <code class="literal">JobStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Mean send size to Node =
                    <em class="replaceable"><code>node_id</code></em> last 4096 sends =
                    <em class="replaceable"><code>bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    This node is sending an average of
                    <em class="replaceable"><code>bytes</code></em> bytes per send to
                    node <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SendBytesStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Mean receive size to Node =
                    <em class="replaceable"><code>node_id</code></em> last 4096 sends =
                    <em class="replaceable"><code>bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    This node is receiving an average of
                    <em class="replaceable"><code>bytes</code></em> of data each time
                    it receives data from node
                    <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ReceiveBytesStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Data usage is
                    <em class="replaceable"><code>data_memory_percentage</code></em>%
                    (<em class="replaceable"><code>data_pages_used</code></em> 32K
                    pages of total
                    <em class="replaceable"><code>data_pages_total</code></em>)</code>
                    / <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Index usage is
                    <em class="replaceable"><code>index_memory_percentage</code></em>%
                    (<em class="replaceable"><code>index_pages_used</code></em> 8K
                    pages of total
                    <em class="replaceable"><code>index_pages_total</code></em>)
                    </code>
                  </p>

                <p><b>Description. </b>
                    This report is generated when a <code class="literal">DUMP
                    1000</code> command is issued in the cluster
                    management client; for more information, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-commands-1000-1999.html#ndb-internals-dump-command-1000" target="_top"><code class="literal">DUMP 1000</code></a>,
                    in <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals.html" target="_top">MySQL Cluster Internals</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">MemoryUsage</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    5
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Transporter to node
                    <em class="replaceable"><code>node2_id</code></em> reported error
                    <em class="replaceable"><code>error_code</code></em>:
                    <em class="replaceable"><code>error_message</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A transporter error occurred while communicating
                    with node <em class="replaceable"><code>node2_id</code></em>; for a
                    listing of transporter error codes and messages, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-transporter-errors.html" target="_top"><code class="literal">NDB</code> Transporter Errors</a>, in
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals.html" target="_top">MySQL Cluster Internals</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransporterError</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    2
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ERROR</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Transporter to node
                    <em class="replaceable"><code>node2_id</code></em> reported error
                    <em class="replaceable"><code>error_code</code></em>:
                    <em class="replaceable"><code>error_message</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A warning of a potential transporter problem while
                    communicating with node
                    <em class="replaceable"><code>node2_id</code></em>; for a listing
                    of transporter error codes and messages, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-transporter-errors.html" target="_top"><code class="literal">NDB</code> Transporter Errors</a>, for more
                    information
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransporterWarning</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">WARNING</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node <em class="replaceable"><code>node2_id</code></em> missed
                    heartbeat
                    <em class="replaceable"><code>heartbeat_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This node missed a heartbeat from node
                    <em class="replaceable"><code>node2_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">MissedHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">WARNING</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node <em class="replaceable"><code>node2_id</code></em> declared
                    dead due to missed heartbeat</code>
                  </p>

                <p><b>Description. </b>
                    This node has missed at least 3 heartbeats from node
                    <em class="replaceable"><code>node2_id</code></em>, and so has
                    declared that node “<span class="quote">dead</span>”
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">DeadDueToHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node Sent Heartbeat to node =
                    <em class="replaceable"><code>node2_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This node has sent a heartbeat to node
                    <em class="replaceable"><code>node2_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SentHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    12
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Event buffer status:
                    used=<em class="replaceable"><code>bytes_used</code></em>
                    (<em class="replaceable"><code>percent_used</code></em>%)
                    alloc=<em class="replaceable"><code>bytes_allocated</code></em>
                    (<em class="replaceable"><code>percent_available</code></em>%)
                    max=<em class="replaceable"><code>bytes_available</code></em>
                    apply_gci=<em class="replaceable"><code>latest_restorable_GCI</code></em>
                    latest_gci=<em class="replaceable"><code>latest_GCI</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This report is seen during heavy event buffer usage,
                    for example, when many updates are being applied in
                    a relatively short period of time; the report shows
                    the number of bytes and the percentage of event
                    buffer memory used, the bytes allocated and
                    percentage still available, and the latest and
                    latest restorable global checkpoints
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">EventBufferStatus</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Entering single user mode</code>, <code class="literal">Node
                    <em class="replaceable"><code>node_id</code></em>: Entered single
                    user mode Node
                    <em class="replaceable"><code>API_node_id</code></em> has exclusive
                    access</code>, <code class="literal">Node
                    <em class="replaceable"><code>node_id</code></em>: Entering single
                    user mode</code>
                  </p>

                <p><b>Description. </b>
                    These reports are written to the cluster log when
                    entering and exiting single user mode;
                    <em class="replaceable"><code>API_node_id</code></em> is the node
                    ID of the API or SQL having exclusive access to the
                    cluster (fro mroe information, see
                    <a href="mysql-cluster.html#mysql-cluster-single-user-mode" title="17.7.6. MySQL Cluster Single User Mode">Section 17.7.6, “MySQL Cluster Single User Mode”</a>);
                    the message <code class="literal">Unknown single user report
                    <em class="replaceable"><code>API_node_id</code></em></code>
                    indicates an error has taken place and should never
                    be seen in normal operation
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SingleUser</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from node
                    <em class="replaceable"><code>mgm_node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A backup has been started using the management node
                    having <em class="replaceable"><code>mgm_node_id</code></em>; this
                    message is also displayed in the cluster management
                    client when the <code class="literal">START BACKUP</code>
                    command is issued; for more information, see
                    <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup">Section 17.7.3.2, “Using The MySQL Cluster Management Client to Create a Backup”</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from node <em class="replaceable"><code>mgm_node_id</code></em>
                    completed. StartGCP:
                    <em class="replaceable"><code>start_gcp</code></em> StopGCP:
                    <em class="replaceable"><code>stop_gcp</code></em> #Records:
                    <em class="replaceable"><code>records</code></em> #LogRecords:
                    <em class="replaceable"><code>log_records</code></em> Data:
                    <em class="replaceable"><code>data_bytes</code></em> bytes Log:
                    <em class="replaceable"><code>log_bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    The backup having the ID
                    <em class="replaceable"><code>backup_id</code></em> has been
                    completed; for more information, see
                    <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="17.7.3.2. Using The MySQL Cluster Management Client to Create a Backup">Section 17.7.3.2, “Using The MySQL Cluster Management Client to Create a Backup”</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup request from
                    <em class="replaceable"><code>mgm_node_id</code></em> failed to
                    start. Error:
                    <em class="replaceable"><code>error_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The backup failed to start; for error codes, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/mgm-errors.html" target="_top">MGM<code class="literal"></code> API Errors</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupFailedToStart</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from <em class="replaceable"><code>mgm_node_id</code></em> has been
                    aborted. Error:
                    <em class="replaceable"><code>error_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The backup was terminated after starting, possibly
                    due to user intervention
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupAborted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndb-transporter-errors"></a>17.7.5.2. MySQL Cluster — <code class="literal">NDB</code> Transporter
        Errors</h4></div></div></div><p>
        This section lists error codes, names, and messages that are
        written to the cluster log in the event of transporter errors.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Error Code</th><th>Error Name</th><th>Error Text</th></tr></thead><tbody><tr><td><span class="errorcode">0x00</span></td><td><span class="errorname">TE_NO_ERROR</span></td><td><span class="errortext">No error</span></td></tr><tr><td><span class="errorcode">0x01</span></td><td><span class="errorname">TE_ERROR_CLOSING_SOCKET</span></td><td><span class="errortext">Error found during closing of socket</span></td></tr><tr><td><span class="errorcode">0x02</span></td><td><span class="errorname">TE_ERROR_IN_SELECT_BEFORE_ACCEPT</span></td><td><span class="errortext">Error found before accept. The transporter will
                retry</span></td></tr><tr><td><span class="errorcode">0x03</span></td><td><span class="errorname">TE_INVALID_MESSAGE_LENGTH</span></td><td><span class="errortext">Error found in message (invalid message length)</span></td></tr><tr><td><span class="errorcode">0x04</span></td><td><span class="errorname">TE_INVALID_CHECKSUM</span></td><td><span class="errortext">Error found in message (checksum)</span></td></tr><tr><td><span class="errorcode">0x05</span></td><td><span class="errorname">TE_COULD_NOT_CREATE_SOCKET</span></td><td><span class="errortext">Error found while creating socket(can't create
                socket)</span></td></tr><tr><td><span class="errorcode">0x06</span></td><td><span class="errorname">TE_COULD_NOT_BIND_SOCKET</span></td><td><span class="errortext">Error found while binding server socket</span></td></tr><tr><td><span class="errorcode">0x07</span></td><td><span class="errorname">TE_LISTEN_FAILED</span></td><td><span class="errortext">Error found while listening to server socket</span></td></tr><tr><td><span class="errorcode">0x08</span></td><td><span class="errorname">TE_ACCEPT_RETURN_ERROR</span></td><td><span class="errortext">Error found during accept(accept return error)</span></td></tr><tr><td><span class="errorcode">0x0b</span></td><td><span class="errorname">TE_SHM_DISCONNECT</span></td><td><span class="errortext">The remote node has disconnected</span></td></tr><tr><td><span class="errorcode">0x0c</span></td><td><span class="errorname">TE_SHM_IPC_STAT</span></td><td><span class="errortext">Unable to check shm segment</span></td></tr><tr><td><span class="errorcode">0x0d</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_CREATE_SEGMENT</span></td><td><span class="errortext">Unable to create shm segment</span></td></tr><tr><td><span class="errorcode">0x0e</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_ATTACH_SEGMENT</span></td><td><span class="errortext">Unable to attach shm segment</span></td></tr><tr><td><span class="errorcode">0x0f</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_REMOVE_SEGMENT</span></td><td><span class="errortext">Unable to remove shm segment</span></td></tr><tr><td><span class="errorcode">0x10</span></td><td><span class="errorname">TE_TOO_SMALL_SIGID</span></td><td><span class="errortext">Sig ID too small</span></td></tr><tr><td><span class="errorcode">0x11</span></td><td><span class="errorname">TE_TOO_LARGE_SIGID</span></td><td><span class="errortext">Sig ID too large</span></td></tr><tr><td><span class="errorcode">0x12</span></td><td><span class="errorname">TE_WAIT_STACK_FULL</span></td><td><span class="errortext">Wait stack was full</span></td></tr><tr><td><span class="errorcode">0x13</span></td><td><span class="errorname">TE_RECEIVE_BUFFER_FULL</span></td><td><span class="errortext">Receive buffer was full</span></td></tr><tr><td><span class="errorcode">0x14</span></td><td><span class="errorname">TE_SIGNAL_LOST_SEND_BUFFER_FULL</span></td><td><span class="errortext">Send buffer was full,and trying to force send
                fails</span></td></tr><tr><td><span class="errorcode">0x15</span></td><td><span class="errorname">TE_SIGNAL_LOST</span></td><td><span class="errortext">Send failed for unknown reason(signal lost)</span></td></tr><tr><td><span class="errorcode">0x16</span></td><td><span class="errorname">TE_SEND_BUFFER_FULL</span></td><td><span class="errortext">The send buffer was full, but sleeping for a while
                solved</span></td></tr><tr><td><span class="errorcode">0x0017</span></td><td><span class="errorname">TE_SCI_LINK_ERROR</span></td><td><span class="errortext">There is no link from this node to the switch</span></td></tr><tr><td><span class="errorcode">0x18</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_START_SEQUENCE</span></td><td><span class="errortext">Could not start a sequence, because system resources are
                exumed or no sequence has been created</span></td></tr><tr><td><span class="errorcode">0x19</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_REMOVE_SEQUENCE</span></td><td><span class="errortext">Could not remove a sequence</span></td></tr><tr><td><span class="errorcode">0x1a</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_CREATE_SEQUENCE</span></td><td><span class="errortext">Could not create a sequence, because system resources are
                exempted. Must reboot</span></td></tr><tr><td><span class="errorcode">0x1b</span></td><td><span class="errorname">TE_SCI_UNRECOVERABLE_DATA_TFX_ERROR</span></td><td><span class="errortext">Tried to send data on redundant link but failed</span></td></tr><tr><td><span class="errorcode">0x1c</span></td><td><span class="errorname">TE_SCI_CANNOT_INIT_LOCALSEGMENT</span></td><td><span class="errortext">Cannot initialize local segment</span></td></tr><tr><td><span class="errorcode">0x1d</span></td><td><span class="errorname">TE_SCI_CANNOT_MAP_REMOTESEGMENT</span></td><td><span class="errortext">Cannot map remote segment</span></td></tr><tr><td><span class="errorcode">0x1e</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_UNMAP_SEGMENT</span></td><td><span class="errortext">Cannot free the resources used by this segment (step
                1)</span></td></tr><tr><td><span class="errorcode">0x1f</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_REMOVE_SEGMENT</span></td><td><span class="errortext">Cannot free the resources used by this segment (step
                2)</span></td></tr><tr><td><span class="errorcode">0x20</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_DISCONNECT_SEGMENT</span></td><td><span class="errortext">Cannot disconnect from a remote segment</span></td></tr><tr><td><span class="errorcode">0x21</span></td><td><span class="errorname">TE_SHM_IPC_PERMANENT</span></td><td><span class="errortext">Shm ipc Permanent error</span></td></tr><tr><td><span class="errorcode">0x22</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_CLOSE_CHANNEL</span></td><td><span class="errortext">Unable to close the sci channel and the resources
                allocated</span></td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-single-user-mode"></a>17.7.6. MySQL Cluster Single User Mode</h3></div></div></div><a class="indexterm" name="id2307598"></a><a class="indexterm" name="id2307611"></a><p>
      <em class="firstterm">Single user mode</em> allows the database
      administrator to restrict access to the database system to a
      single API node, such as a MySQL server (SQL node) or an instance
      of <span><strong class="command">ndb_restore</strong></span>. When entering single user mode,
      connections to all other API nodes are closed gracefully and all
      running transactions are aborted. No new transactions are
      permitted to start.
    </p><p>
      Once the cluster has entered single user mode, only the designated
      API node is granted access to the database.
    </p><p>
      You can use the <span><strong class="command">ALL STATUS</strong></span> command to see when
      the cluster has entered single user mode.
    </p><p>
      Example:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ENTER SINGLE USER MODE 5</code></strong>
</pre><p>
      After this command has executed and the cluster has entered single
      user mode, the API node whose node ID is <code class="literal">5</code>
      becomes the cluster's only permitted user.
    </p><p>
      The node specified in the preceding command must be an API node;
      attempting to specify any other type of node will be rejected.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        When the preceding command is invoked, all transactions running
        on the designated node are aborted, the connection is closed,
        and the server must be restarted.
      </p></div><p>
      The command <span><strong class="command">EXIT SINGLE USER MODE</strong></span> changes the
      state of the cluster's data nodes from single user mode to normal
      mode. API nodes — such as MySQL Servers — waiting for
      a connection (that is, waiting for the cluster to become ready and
      available), are again permitted to connect. The API node denoted
      as the single-user node continues to run (if still connected)
      during and after the state change.
    </p><p>
      Example:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>EXIT SINGLE USER MODE</code></strong>
</pre><a class="indexterm" name="id2307719"></a><p>
      There are two recommended ways to handle a node failure when
      running in single user mode:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Method 1:
        </p><div class="orderedlist"><ol type="1"><li><p>
              Finish all single user mode transactions
            </p></li><li><p>
              Issue the <span><strong class="command">EXIT SINGLE USER MODE</strong></span> command
            </p></li><li><p>
              Restart the cluster's data nodes
            </p></li></ol></div></li><li><p>
          Method 2:
        </p><p>
          Restart database nodes prior to entering single user mode.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-sql-statements"></a>17.7.7. Quick Reference: MySQL Cluster SQL Statements</h3></div></div></div><a class="indexterm" name="id2307801"></a><a class="indexterm" name="id2307813"></a><p>
      This section discusses several SQL statements that can prove
      useful in managing and monitoring a MySQL server that is connected
      to a MySQL Cluster, and in some cases provide information about
      the cluster itself.
    </p><div class="itemizedlist"><a class="indexterm" name="id2307830"></a><a class="indexterm" name="id2307842"></a><a class="indexterm" name="id2307851"></a><ul type="disc"><li><p>
          <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE NDB
          STATUS</code></a>,
          <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
          NDBCLUSTER STATUS</code></a>
        </p><p>
          The output of this statement contains information about the
          server's connection to the cluster, creation and usage of
          MySQL Cluster objects, and binary logging for MySQL Cluster
          replication.
        </p><p>
          See <a href="sql-syntax.html#show-engine" title="12.5.5.12. SHOW ENGINE Syntax">Section 12.5.5.12, “<code class="literal">SHOW ENGINE</code> Syntax”</a>, for a usage example and
          more detailed information.
        </p></li><li><a class="indexterm" name="id2307897"></a><p>
          <code class="literal">SHOW ENGINES [LIKE 'NDB%']</code>
        </p><p>
          This statement can be used to determine whether or not
          clustering support is enabled in the MySQL server, and if so,
          whether it is active.
        </p><p>
          See <a href="sql-syntax.html#show-engines" title="12.5.5.13. SHOW ENGINES Syntax">Section 12.5.5.13, “<code class="literal">SHOW ENGINES</code> Syntax”</a>, for more detailed
          information.
        </p></li><li><a class="indexterm" name="id2307935"></a><p>
          <code class="literal">SHOW VARIABLES LIKE 'NDB%'</code>
        </p><p>
          This statement provides a list of most server system variables
          relating to the <code class="literal">NDB</code> storage
          engine, and their values, as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'NDB%';</code></strong>
+-------------------------------------+-------+
| Variable_name                       | Value |
+-------------------------------------+-------+
| ndb_autoincrement_prefetch_sz       | 32    |
| ndb_cache_check_time                | 0     |
| ndb_extra_logging                   | 0     |
| ndb_force_send                      | ON    |
| ndb_index_stat_cache_entries        | 32    |
| ndb_index_stat_enable               | OFF   |
| ndb_index_stat_update_freq          | 20    |
| ndb_report_thresh_binlog_epoch_slip | 3     |
| ndb_report_thresh_binlog_mem_usage  | 10    |
| ndb_use_copying_alter_table         | OFF   |
| ndb_use_exact_count                 | ON    |
| ndb_use_transactions                | ON    |
+-------------------------------------+-------+
</pre><p>
        </p><p>
          See <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>, for more
          information.
        </p></li><li><a class="indexterm" name="id2307998"></a><p>
          <code class="literal">SHOW STATUS LIKE 'NDB%'</code>
        </p><p>
          This statement shows at a glance whether or not the MySQL
          server is acting as a cluster SQL node, and if so, it provides
          the MySQL server's cluster node ID, the host name and port for
          the cluster management server to which it is connected, and
          the number of data nodes in the cluster, as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'NDB%';</code></strong>
+--------------------------+---------------+
| Variable_name            | Value         |
+--------------------------+---------------+
| Ndb_cluster_node_id      | 10            |
| Ndb_config_from_host     | 192.168.0.103 |
| Ndb_config_from_port     | 1186          |
| Ndb_number_of_data_nodes | 4             |
+--------------------------+---------------+
</pre><p>

          If the MySQL server was built with clustering support, but it
          is not connected to a cluster, all rows in the output of this
          statement contain a zero or an empty string:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'NDB%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| Ndb_cluster_node_id      | 0     |
| Ndb_config_from_host     |       |
| Ndb_config_from_port     | 0     |
| Ndb_number_of_data_nodes | 0     |
+--------------------------+-------+
</pre><p>
        </p><p>
          See also <a href="sql-syntax.html#show-status" title="12.5.5.32. SHOW STATUS Syntax">Section 12.5.5.32, “<code class="literal">SHOW STATUS</code> Syntax”</a>.
        </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-security"></a>17.8. MySQL Cluster Security Issues</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-networking-issues">17.8.1. MySQL Cluster Security and Networking Issues</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges">17.8.2. MySQL Cluster and MySQL Privileges</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-security-procedures">17.8.3. MySQL Cluster and MySQL Security Procedures</a></span></dt></dl></div><a class="indexterm" name="id2308077"></a><p>
    This section discusses security considerations to take into account
    when setting up and running MySQL Cluster.
  </p><p>
    Topics to be covered in this chapter include the following:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        MySQL Cluster and network security issues
      </p></li><li><p>
        Configuration issues relating to running MySQL Cluster securely
      </p></li><li><p>
        MySQL Cluster and the MySQL privilege system
      </p></li><li><p>
        MySQL standard security procedures as applicable to MySQL
        Cluster
      </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-networking-issues"></a>17.8.1. MySQL Cluster Security and Networking Issues</h3></div></div></div><a class="indexterm" name="id2308138"></a><p>
      In this section, we discuss basic network security issues as they
      relate to MySQL Cluster. It is extremely important to remember
      that MySQL Cluster “<span class="quote">out of the box</span>” is not secure;
      you or your network administrator must take the proper steps to
      insure that your cluster cannot be compromised over the network.
    </p><a class="indexterm" name="id2308164"></a><p>
      Cluster communication protocols are inherently insecure, and no
      encryption or similar security measures are used in communications
      between nodes in the cluster. Because network speed and latency
      have a direct impact on the cluster's efficiency, it is also not
      advisable to employ SSL or other encryption to network connections
      between nodes, as such schemes will effectively slow
      communications.
    </p><p>
      It is also true that no authentication is used for controlling API
      node access to a MySQL Cluster. As with encryption, the overhead
      of imposing authentication requirements would have an adverse
      impact on Cluster performance.
    </p><p>
      In addition, there is no checking of the source IP address for
      either of the following when accessing the cluster:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            SQL or API nodes using “<span class="quote">free slots</span>” created by
            empty <code class="literal">[mysqld]</code> or
            <code class="literal">[api]</code> sections in the
            <code class="filename">config.ini</code> file
          </p><p>
            This means that, if there are any empty
            <code class="literal">[mysqld]</code> or <code class="literal">[api]</code>
            sections in the <code class="filename">config.ini</code> file, then
            any API nodes (including SQL nodes) that know the management
            server's host name (or IP address) and port can connect to
            the cluster and access its data without restriction. (See
            <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="17.8.2. MySQL Cluster and MySQL Privileges">Section 17.8.2, “MySQL Cluster and MySQL Privileges”</a>,
            for more information about this and related issues.)
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <a class="indexterm" name="id2308255"></a>

              <a class="indexterm" name="id2308271"></a>

              <a class="indexterm" name="id2308287"></a>

              You can exercise some control over SQL and API node access
              to the cluster by specifying a <code class="literal">HostName</code>
              parameter for all <code class="literal">[mysqld]</code> and
              <code class="literal">[api]</code> sections in the
              <code class="filename">config.ini</code> file. However, this also
              means that, should you wish to connect an API node to the
              cluster from a previously unused host, you need to add an
              <code class="literal">[api]</code> section containing its host name
              to the <code class="filename">config.ini</code> file.
            </p><p>
              More information is available
              <a href="mysql-cluster.html#ndbparam-api-hostname">elsewhere
              in this chapter</a> about the
              <code class="literal">HostName</code> parameter. Also see
              <a href="mysql-cluster.html#mysql-cluster-quick" title="17.3.3. Quick Test Setup of MySQL Cluster">Section 17.3.3, “Quick Test Setup of MySQL Cluster”</a>, for configuration
              examples using <code class="literal">HostName</code> with API nodes.
            </p></div></li><li><p>
            Any <span><strong class="command">ndb_mgm</strong></span> client
          </p><p>
            This means that any cluster management client that is given
            the management server's host name (or IP address) and port
            (if not the standard port) can connect to the cluster and
            execute any management client command. This includes
            commands such as <code class="literal">ALL STOP</code> and
            <code class="literal">SHUTDOWN</code>.
          </p></li></ul></div><p>
    </p><p>
      <a class="indexterm" name="id2308401"></a>

      <a class="indexterm" name="id2308417"></a>

      For these reasons, it is necessary to protect the cluster on the
      network level. The safest network configuration for Cluster is one
      which isolates connections between Cluster nodes from any other
      network communications. This can be accomplished by any of the
      following methods:

      </p><div class="orderedlist"><ol type="1"><li><p>
            Keeping Cluster nodes on a network that is physically
            separate from any public networks. This option is the most
            dependable; however, it is the most expensive to implement.
          </p><p>
            We show an example of a MySQL Cluster setup using such a
            physically segregated network here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-1.png" width="550" height="347" alt="MySQL Cluster on a private network
                protected with a hardware firewall"></div><p>

            This setup has two networks, one private (solid box) for the
            Cluster management servers and data nodes, and one public
            (dotted box) where the SQL nodes reside. (We show the
            management and data nodes connected using a gigabit switch
            since this provides the best performance.) Both networks are
            protected from the outside by a hardware firewall, sometimes
            also known as a <em class="firstterm">network-based
            firewall</em>.
          </p><p>
            This network setup is safest because no packets can reach
            the cluster's management or data nodes from outside the
            network — and none of the cluster's internal
            communications can reach the outside — without going
            through the SQL nodes, as long as the SQL nodes do not allow
            any packets to be forwarded. This means, of course, that all
            SQL nodes must be secured against hacking attempts.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              With regard to potential security vulnerabilities, an SQL
              node is no different from any other MySQL server. See
              <a href="server-administration.html#security-against-attack" title="5.3.2. Making MySQL Secure Against Attackers">Section 5.3.2, “Making MySQL Secure Against Attackers”</a>, for a
              description of techniques you can use to secure MySQL
              servers.
            </p></div></li><li><p>
            <a class="indexterm" name="id2308518"></a>

            <a class="indexterm" name="id2308534"></a>

            Using one or more software firewalls (also known as
            <em class="firstterm">host-based firewalls</em>) to control
            which packets pass through to the cluster from portions of
            the network that do not require access to it. In this type
            of setup, a software firewall must be installed on every
            host in the cluster which might otherwise be accessible from
            outside the local network.
          </p><p>
            The host-based option is the least expensive to implement,
            but relies purely on software to provide protection and so
            is the most difficult to keep secure.
          </p><p>
            This type of network setup for MySQL Cluster is illustrated
            here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-2.png" width="550" height="489" alt="MySQL Cluster deployed on a network
                using software firewalls to create public and private
                zones"></div><p>

            Using this type of network setup means that there are two
            zones of MySQL Cluster hosts. Each cluster host must be able
            to communicate with all of the other machines in the
            cluster, but only those hosting SQL nodes (dotted box) can
            be permitted to have any contact with the outside, while
            those in the zone containing the data nodes and management
            nodes (solid box) must be isolated from any machines that
            are not part of the cluster. Applications using the cluster
            and user of those applications must <span class="emphasis"><em>not</em></span>
            be permitted to have direct access to the management and
            data node hosts.
          </p><p>
            To accomplish this, you must set up software firewalls that
            limit the traffic to the type or types shown in the
            following table, according to the type of node that is
            running on each cluster host computer:

            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Type of Node to be Accessed</th><th>Traffic to Allow</th></tr></thead><tbody><tr><td>SQL or API node</td><td><div class="itemizedlist"><ul type="disc"><li><p>
                            It originates from the IP address of a
                            management or data node (using any TCP or
                            UDP port).
                          </p></li><li><p>
                            It originates from within the network in
                            which the cluster resides and is on the port
                            that your application is using.
                          </p></li></ul></div></td></tr><tr><td>Data node or Management node</td><td><div class="itemizedlist"><ul type="disc"><li><p>
                            It originates from the IP address of a
                            management or data node (using any TCP or
                            UDP port).
                          </p></li><li><p>
                            It originates from the IP address of an SQL
                            or API node.
                          </p></li></ul></div></td></tr></tbody></table></div><p>

            Any traffic other than that shown in the table for a given
            node type should be denied.
          </p><p>
            The specifics of configuring a firewall vary from firewall
            application to firewall application, and are beyond the
            scope of this Manual. <span><strong class="command">iptables</strong></span> is a very
            common and reliable firewall application, which is often
            used with <span><strong class="command">APF</strong></span> as a front end to make
            configuration easier. You can (and should) consult the
            documentation for the software firewall that you employ,
            should you choose to implement a MySQL Cluster network setup
            of this type, or of a “<span class="quote">mixed</span>” type as discussed
            under the next item.
          </p></li><li><p>
            <a class="indexterm" name="id2308724"></a>

            <a class="indexterm" name="id2308740"></a>

            It is also possible to employ a combination of the first two
            methods, using both hardware and software to secure the
            cluster — that is, using both network-based and
            host-based firewalls. This is between the first two schemes
            in terms of both security level and cost. This type of
            network setup keeps the cluster behind the hardware
            firewall, but allows incoming packets to travel beyond the
            router connecting all cluster hosts in order to reach the
            SQL nodes.
          </p><p>
            One possible network deployment of a MySQL Cluster using
            hardware and software firewalls in combination is shown
            here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-3.png" width="550" height="410" alt="Network setup for MySQL Cluster using
                a combination of hardware and software firewalls to
                provide protection"></div><p>

            In this case, you can set the rules in the hardware firewall
            to deny any external traffic except to SQL nodes and API
            nodes, and then allow traffic to them only on the ports
            required by your application.
          </p></li></ol></div><p>

      Whatever network configuration you use, remember that your
      objective from the viewpoint of keeping the cluster secure remains
      the same — to prevent any unessential traffic from reaching
      the cluster while ensuring the most efficient communication
      between the nodes in the cluster.
    </p><p>
      <a class="indexterm" name="id2308806"></a>

      <a class="indexterm" name="id2308822"></a>

      Because MySQL Cluster requires large numbers of ports to be open
      for communications between nodes, the recommended option is to use
      a segregated network. This represents the simplest way to prevent
      unwanted traffic from reaching the cluster.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a class="indexterm" name="id2308842"></a>

        <a class="indexterm" name="id2308858"></a>

        If you wish to administer a MySQL Cluster remotely (that is,
        from outside the local network), the recommended way to do this
        is to use <span><strong class="command">ssh</strong></span> or another secure login shell
        to access an SQL node host. From this host, you can then run the
        management client to access the management server safely, from
        within the Cluster's own local network.
      </p><p>
        Even though it is possible to do so in theory, it is
        <span class="emphasis"><em>not</em></span> recommended to use
        <span><strong class="command">ndb_mgm</strong></span> to manage a Cluster directly from
        outside the local network on which the Cluster is running. Since
        neither authentication nor encryption takes place between the
        management client and the management server, this represents an
        extremely insecure means of managing the cluster, and is almost
        certain to be compromised sooner or later.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-mysql-privileges"></a>17.8.2. MySQL Cluster and MySQL Privileges</h3></div></div></div><a class="indexterm" name="id2308908"></a><p>
      In this section, we discuss how the MySQL privilege system works
      in relation to MySQL Cluster and the implications of this for
      keeping a MySQL Cluster secure.
    </p><p>
      <a class="indexterm" name="id2308927"></a>

      Standard MySQL privileges apply to MySQL Cluster tables. This
      includes all MySQL privilege types
      (<a href="server-administration.html#priv_select"><code class="literal">SELECT</code></a> privilege,
      <a href="server-administration.html#priv_update"><code class="literal">UPDATE</code></a> privilege,
      <a href="server-administration.html#priv_delete"><code class="literal">DELETE</code></a> privilege, and so on)
      granted on the database, table, and column level. As with any
      other MySQL Server, user and privilege information is stored in
      the <code class="literal">mysql</code> system database. The SQL statements
      used to grant and revoke privileges on
      <code class="literal">NDB</code> tables, databases containing such
      tables, and columns within such tables are identical in all
      respects with the <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a> and
      <a href="sql-syntax.html#revoke" title="12.5.1.5. REVOKE Syntax"><code class="literal">REVOKE</code></a> statements used in
      connection with database objects involving any (other) MySQL
      storage engine. The same thing is true with respect to the
      <a href="sql-syntax.html#create-user" title="12.5.1.1. CREATE USER Syntax"><code class="literal">CREATE USER</code></a> and
      <a href="sql-syntax.html#drop-user" title="12.5.1.2. DROP USER Syntax"><code class="literal">DROP USER</code></a> statements.
    </p><p>
      <a class="indexterm" name="id2309011"></a>

      It is important to keep in mind that the MySQL grant tables use
      the <code class="literal">MyISAM</code> storage engine. Because of this,
      those tables are not duplicated or shared among MySQL servers
      acting as SQL nodes in a MySQL Cluster. By way of example, suppose
      that two SQL nodes <span class="bold"><strong>A</strong></span> and
      <span class="bold"><strong>B</strong></span> are connected to the same MySQL
      Cluster, which has an <code class="literal">NDB</code> table named
      <code class="literal">mytable</code> in a database named
      <code class="literal">mydb</code>, and that you execute an SQL statement on
      server <span class="bold"><strong>A</strong></span> that creates a new user
      <code class="literal">jon@localhost</code> and grants this user the
      <a href="server-administration.html#priv_select"><code class="literal">SELECT</code></a> privilege on that table:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>GRANT SELECT ON mydb.mytable</code></strong>
    -&gt;   <strong class="userinput"><code>TO jon@localhost IDENTIFIED BY 'mypass';</code></strong>
</pre><p>

      This user is <span class="emphasis"><em>not</em></span> created on server
      <span class="bold"><strong>B</strong></span>. In order for this to take
      place, the statement must also be run on server
      <span class="bold"><strong>B</strong></span>. Similarly, statements run on
      server <span class="bold"><strong>A</strong></span> and affecting the
      privileges of existing users on server
      <span class="bold"><strong>A</strong></span> do not affect users on server
      <span class="bold"><strong>B</strong></span> unless those statements are
      actually run on server <span class="bold"><strong>B</strong></span> as well.
    </p><p>
      In other words, <span class="emphasis"><em>changes in users and their privileges do
      not automatically propagate between SQL nodes</em></span>.
      Synchronization of privileges between SQL nodes must be done
      either manually or by scripting an application that periodically
      synchronizes the privilege tables on all SQL nodes in the cluster.
    </p><p>
      <a class="indexterm" name="id2309154"></a>

      <a class="indexterm" name="id2309166"></a>

      Conversely, because there is no way in MySQL to deny privileges
      (privileges can either be revoked or not granted in the first
      place, but not denied as such), there is no special protection for
      <code class="literal">NDB</code> tables on one SQL node from users
      that have privileges on another SQL node. The most far-reaching
      example of this is the MySQL <code class="literal">root</code> account,
      which can perform any action on any database object. In
      combination with empty <code class="literal">[mysqld]</code> or
      <code class="literal">[api]</code> sections of the
      <code class="filename">config.ini</code> file, this account can be
      especially dangerous. To understand why, consider the following
      scenario:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            The <code class="filename">config.ini</code> file contains at least
            one empty <code class="literal">[mysqld]</code> or
            <code class="literal">[api]</code> section. This means that the
            Cluster management server performs no checking of the host
            from which a MySQL Server (or other API node) accesses the
            MySQL Cluster.
          </p></li><li><p>
            There is no firewall, or the firewall fails to protect
            against access to the Cluster from hosts external to the
            network.
          </p></li><li><p>
            The host name or IP address of the Cluster's management
            server is known or can be determined from outside the
            network.
          </p></li></ul></div><p>

      If these conditions are true, then anyone, anywhere can start a
      MySQL Server with <code class="option">--ndbcluster
      --ndb-connectstring=<em class="replaceable"><code>management_host</code></em></code>
      and access the Cluster. Using the MySQL <code class="literal">root</code>
      account, this person can then perform the following actions:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Execute a <a href="sql-syntax.html#show-databases" title="12.5.5.11. SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a>
            statement to obtain a list of all databases that exist in
            the cluster
          </p></li><li><p>
            Execute a <code class="literal">SHOW TABLES FROM
            <em class="replaceable"><code>some_database</code></em></code> statement
            to obtain a list of all <code class="literal">NDB</code>
            tables in a given database
          </p></li><li><p>
            <a class="indexterm" name="id2309319"></a>

            <a class="indexterm" name="id2309332"></a>

            Run any legal MySQL statements on any of those tables, such
            as:

            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <code class="literal">SELECT * FROM
                  <em class="replaceable"><code>some_table</code></em></code> to
                  read all the data from any table
                </p></li><li><p>
                  <code class="literal">DELETE FROM
                  <em class="replaceable"><code>some_table</code></em></code> to
                  delete all the data from a table
                </p></li><li><p>
                  <code class="literal">DESCRIBE
                  <em class="replaceable"><code>some_table</code></em></code> or
                  <code class="literal">SHOW CREATE TABLE
                  <em class="replaceable"><code>some_table</code></em></code> to
                  determine the table schema
                </p></li><li><p>
                  <code class="literal">UPDATE <em class="replaceable"><code>some_table</code></em>
                  SET <em class="replaceable"><code>column1</code></em> =
                  <em class="replaceable"><code>any_value1</code></em></code> to
                  fill a table column with “<span class="quote">garbage</span>” data;
                  this could actually cause much greater damage than
                  simply deleting all the data
                </p><p>
                  Even more insidious variations might include
                  statements like these:

</p><pre class="programlisting">UPDATE <em class="replaceable"><code>some_table</code></em> SET <em class="replaceable"><code>an_int_column</code></em> = <em class="replaceable"><code>an_int_column</code></em> + 1
</pre><p>

                  or

</p><pre class="programlisting">UPDATE <em class="replaceable"><code>some_table</code></em> SET <em class="replaceable"><code>a_varchar_column</code></em> = REVERSE(<em class="replaceable"><code>a_varchar_column</code></em>)
</pre><p>

                  Such malicious statements are limited only by the
                  imagination of the attacker.
                </p></li></ul></div><p>

            The only tables that would be safe from this sort of mayhem
            would be those tables that were created using storage
            engines other than <code class="literal">NDB</code>, and so
            not visible to a “<span class="quote">rogue</span>” SQL node.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <a class="indexterm" name="id2309488"></a>

              <a class="indexterm" name="id2309500"></a>

              A user who can log in as <code class="literal">root</code> can also
              access the <code class="literal">INFORMATION_SCHEMA</code> database
              and its tables, and so obtain information about databases,
              tables, stored routines, scheduled events, and any other
              database objects for which metadata is stored in
              <code class="literal">INFORMATION_SCHEMA</code>.
            </p></div><p>
            It is also a very good idea to use different passwords for
            the <code class="literal">root</code> accounts on different cluster
            SQL nodes.
          </p></li></ul></div><p>
    </p><p>
      In sum, you cannot have a safe MySQL Cluster if it is directly
      accessible from outside your local network.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        <span class="emphasis"><em>Never leave the MySQL root account password
        empty</em></span>. This is just as true when running MySQL as a
        MySQL Cluster SQL node as it is when running it as a standalone
        (non-Cluster) MySQL Server, and should be done as part of the
        MySQL installation process before configuring the MySQL Server
        as an SQL node in a MySQL Cluster.
      </p></div><p>
      You should never convert the system tables in the
      <code class="literal">mysql</code> database to use the
      <code class="literal">NDB</code> storage engine. There are a
      number of reasons why you should not do this, but the most
      important reason is this: <span class="emphasis"><em>Many of the SQL statements
      that affect <code class="literal">mysql</code> tables storing information
      about user privileges, stored routines, scheduled events, and
      other database objects cease to function if these tables are
      changed to use any storage engine other than
      <code class="literal">MyISAM</code></em></span>. This is a consequence of
      various MySQL Server internals which are not expected to change in
      the foreseeable future.
    </p><p>
      If you need to synchronize <code class="literal">mysql</code> system tables
      between SQL nodes, you can use standard MySQL replication to do
      so, or employ a script to copy table entries between the MySQL
      servers.
    </p><p><b>Summary. </b>
        The two most important points to remember regarding the MySQL
        privilege system with regard to MySQL Cluster are:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Users and privileges established on one SQL node do not
              automatically exist or take effect on other SQL nodes in
              the cluster.
            </p><p>
              Conversely, removing a user or privilege on one SQL node
              in the cluster does not remove the user or privilege from
              any other SQL nodes.
            </p></li><li><p>
              Once a MySQL user is granted privileges on an
              <code class="literal">NDB</code> table from one SQL node
              in a MySQL Cluster, that user can “<span class="quote">see</span>” any
              data in that table regardless of the SQL node from which
              the data originated.
            </p></li></ol></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-mysql-security-procedures"></a>17.8.3. MySQL Cluster and MySQL Security Procedures</h3></div></div></div><a class="indexterm" name="id2309675"></a><a class="indexterm" name="id2309687"></a><p>
      In this section, we discuss MySQL standard security procedures as
      they apply to running MySQL Cluster.
    </p><p>
      In general, any standard procedure for running MySQL securely also
      applies to running a MySQL Server as part of a MySQL Cluster.
      First and foremost, you should always run a MySQL Server as the
      <code class="literal">mysql</code> system user; this is no different from
      running MySQL in a standard (non-Cluster) environment. The
      <code class="literal">mysql</code> system account should be uniquely and
      clearly defined. Fortunately, this is the default behavior for a
      new MySQL installation. You can verify that the
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process is running as the system user
      <code class="literal">mysql</code> by using the system command such as the
      one shown here:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ps aux | grep mysql</code></strong>
root     10467  0.0  0.1   3616  1380 pts/3    S    11:53   0:00 \
  /bin/sh ./mysqld_safe --ndbcluster --ndb-connectstring=localhost:1186
mysql    10512  0.2  2.5  58528 26636 pts/3    Sl   11:53   0:00 \
  /usr/local/mysql/libexec/mysqld --basedir=/usr/local/mysql \
  --datadir=/usr/local/mysql/var --user=mysql --ndbcluster \
  --ndb-connectstring=localhost:1186 --pid-file=/usr/local/mysql/var/mothra.pid \
  --log-error=/usr/local/mysql/var/mothra.err
jon      10579  0.0  0.0   2736   688 pts/0    S+   11:54   0:00 grep mysql
</pre><p>

      If the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process is running as any other
      user than <code class="literal">mysql</code>, you should immediately shut it
      down and restart it as the <code class="literal">mysql</code> user. If this
      user does not exist on the system, the <code class="literal">mysql</code>
      user account should be created, and this user should be part of
      the <code class="literal">mysql</code> user group; in this case, you should
      also make sure that the MySQL <code class="literal">DataDir</code> on this
      system is owned by the <code class="literal">mysql</code> user, and that the
      SQL node's <code class="filename">my.cnf</code> file includes
      <code class="literal">user=mysql</code> in the <code class="literal">[mysqld]</code>
      section. Alternatively, you can start the server with
      <code class="option">--user=mysql</code> on the command line, but it is
      preferable to use the <code class="filename">my.cnf</code> option, since
      you might forget to use the command-line option and so have
      <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> running as another user unintentionally.
      The <a href="programs.html#mysqld-safe" title="4.3.2. mysqld_safe — MySQL Server Startup Script"><span><strong class="command">mysqld_safe</strong></span></a> startup script forces MySQL to
      run as the <code class="literal">mysql</code> user.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Never run <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> as the system root user.
        Doing so means that potentially any file on the system can be
        read by MySQL, and thus — should MySQL be compromised
        — by an attacker.
      </p></div><p>
      <a class="indexterm" name="id2309864"></a>

      As mentioned in the previous section (see
      <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="17.8.2. MySQL Cluster and MySQL Privileges">Section 17.8.2, “MySQL Cluster and MySQL Privileges”</a>), you
      should always set a root password for the MySQL Server as soon as
      you have it running. You should also delete the anonymous user
      account that is installed by default. You can accomplish these
      tasks via the following statements:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql -u root</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE mysql.user</code></strong>
    -&gt;     <strong class="userinput"><code>SET Password=PASSWORD('<em class="replaceable"><code>secure_password</code></em>')</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE User='root';</code></strong>

mysql&gt; <strong class="userinput"><code>DELETE FROM mysql.user</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE User='';</code></strong>

mysql&gt; <strong class="userinput"><code>FLUSH PRIVILEGES;</code></strong>
</pre><p>

      Be very careful when executing the
      <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statement not to omit the
      <code class="literal">WHERE</code> clause, or you risk deleting
      <span class="emphasis"><em>all</em></span> MySQL users. Be sure to run the
      <a href="sql-syntax.html#flush" title="12.5.6.2. FLUSH Syntax"><code class="literal">FLUSH PRIVILEGES</code></a>
      statement as soon as you have modified the
      <code class="literal">mysql.user</code> table, so that the changes take
      immediate effect. Without
      <a href="sql-syntax.html#flush" title="12.5.6.2. FLUSH Syntax"><code class="literal">FLUSH PRIVILEGES</code></a>,
      the changes do not take effect until the next time that the server
      is restarted.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a class="indexterm" name="id2309979"></a>

        <a class="indexterm" name="id2309992"></a>

        Many of the MySQL Cluster utilities such as
        <span><strong class="command">ndb_show_tables</strong></span>, <span><strong class="command">ndb_desc</strong></span>,
        and <span><strong class="command">ndb_select_all</strong></span> also work without
        authentication and can reveal table names, schemas, and data. By
        default these are installed on Unix-style systems with the
        permissions <code class="literal">wxr-xr-x</code> (755), which means they
        can be executed by any user that can access the
        <code class="filename">mysql/bin</code> directory.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>, for more
        information about these utilities.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-interconnects"></a>17.9. Using High-Speed Interconnects with MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-sockets">17.9.1. Configuring MySQL Cluster to use SCI Sockets</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects-performance">17.9.2. MySQL Cluster Interconnects and Performance</a></span></dt></dl></div><a class="indexterm" name="id2310057"></a><a class="indexterm" name="id2310070"></a><p>
    Even before design of <code class="literal">NDBCLUSTER</code> began
    in 1996, it was evident that one of the major problems to be
    encountered in building parallel databases would be communication
    between the nodes in the network. For this reason,
    <code class="literal">NDBCLUSTER</code> was designed from the very
    beginning to allow for the use of a number of different data
    transport mechanisms. In this Manual, we use the term
    <em class="firstterm">transporter</em> for these.
  </p><p>
    The MySQL Cluster codebase includes support for four different
    transporters:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <span class="emphasis"><em>TCP/IP using 100 Mbps or gigabit Ethernet</em></span>,
        as discussed in <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="17.3.4.7. MySQL Cluster TCP/IP Connections">Section 17.3.4.7, “MySQL Cluster TCP/IP Connections”</a>.
      </p></li><li><p>
        <span class="emphasis"><em>Direct (machine-to-machine) TCP/IP</em></span>;
        although this transporter uses the same TCP/IP protocol as
        mentioned in the previous item, it requires setting up the
        hardware differently and is configured differently as well. For
        this reason, it is considered a separate transport mechanism for
        MySQL Cluster. See
        <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="17.3.4.8. MySQL Cluster TCP/IP Connections Using Direct Connections">Section 17.3.4.8, “MySQL Cluster TCP/IP Connections Using Direct Connections”</a>, for
        details.
      </p></li><li><p>
        <span class="emphasis"><em>Shared memory (SHM)</em></span>. For more information
        about SHM, see <a href="mysql-cluster.html#mysql-cluster-shm-definition" title="17.3.4.9. MySQL Cluster Shared-Memory Connections">Section 17.3.4.9, “MySQL Cluster Shared-Memory Connections”</a>.
      </p></li><li><p>
        <span class="emphasis"><em>Scalable Coherent Interface (SCI)</em></span>, as
        described in the next section of this chapter,
        <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="17.3.4.10. SCI Transport Connections in MySQL Cluster">Section 17.3.4.10, “SCI Transport Connections in MySQL Cluster”</a>.
      </p></li></ul></div><p>
    Most users today employ TCP/IP over Ethernet because it is
    ubiquitous. TCP/IP is also by far the best-tested transporter for
    use with MySQL Cluster.
  </p><p>
    We are working to make sure that communication with the
    <span><strong class="command">ndbd</strong></span> process is made in “<span class="quote">chunks</span>”
    that are as large as possible because this benefits all types of
    data transmission.
  </p><p>
    For users who desire it, it is also possible to use cluster
    interconnects to enhance performance even further. There are two
    ways to achieve this: Either a custom transporter can be designed to
    handle this case, or you can use socket implementations that bypass
    the TCP/IP stack to one extent or another. We have experimented with
    both of these techniques using the SCI (Scalable Coherent Interface)
    technology developed by
    <a href="http://www.dolphinics.com/" target="_top">Dolphin Interconnect
    Solutions</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-sci-sockets"></a>17.9.1. Configuring MySQL Cluster to use SCI Sockets</h3></div></div></div><a class="indexterm" name="id2310220"></a><a class="indexterm" name="id2310232"></a><a class="indexterm" name="id2310245"></a><p>
      It is possible employing Scalable Coherent Interface (SCI)
      technology to achieve a significant increase in connection speeds
      and throughput between MySQL Cluster data and SQL nodes. To use
      SCI, it is necessary to obtain and install Dolphin SCI network
      cards and to use the drivers and other software supplied by
      Dolphin. You can get information on obtaining these, from
      <a href="http://www.dolphinics.com/" target="_top">Dolphin Interconnect
      Solutions</a>. SCI SuperSocket or SCI Transporter support is
      available for 32-bit and 64-bit Linux, Solaris, and other
      platforms. See the Dolphin documentation referenced later in this
      section for more detailed information regarding platforms
      supported for SCI.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Prior to MySQL 5.0.66, there were issues with building MySQL
        Cluster with SCI support (see <a href="http://bugs.mysql.com/25470" target="_top">Bug#25470</a>), but these have been
        resolved due to work contributed by Dolphin. SCI Sockets are now
        correctly supported for MySQL Cluster hosts running recent
        versions of Linux using the <code class="literal">-max</code> builds, and
        versions of MySQL Cluster with SCI Transporter support can be
        built using either of <span><strong class="command">compile-amd64-max-sci</strong></span>
        or <span><strong class="command">compile-pentium64-max-sci</strong></span>. Both of these
        build scripts can be found in the <code class="filename">BUILD</code>
        directory of the MySQL Cluster source trees; it should not be
        difficult to adapt them for other platforms. Generally, all that
        is necessary is to compile MySQL Cluster with SCI Transporter
        support is to configure the MySQL Cluster build using
        <code class="option">--with-ndb-sci=/opt/DIS</code>.
      </p></div><p>
      Once you have acquired the required Dolphin hardware and software,
      you can obtain detailed information on how to adapt a MySQL
      Cluster configured for normal TCP/IP communication to use SCI from
      the <em class="citetitle">Dolphin Express for MySQL Installation and
      Reference Guide</em>, available for download at
      <a href="http://docsrva.mysql.com/public/DIS_install_guide_book.pdf" target="_top">http://docsrva.mysql.com/public/DIS_install_guide_book.pdf</a>
      (PDF file, 94 pages, 753 KB). This document provides instructions
      for installing the SCI hardware and software, as well as
      information concerning network topology and configuration.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-interconnects-performance"></a>17.9.2. MySQL Cluster Interconnects and Performance</h3></div></div></div><a class="indexterm" name="id2310351"></a><a class="indexterm" name="id2310363"></a><p>
      The <span><strong class="command">ndbd</strong></span> process has a number of simple
      constructs which are used to access the data in a MySQL Cluster.
      We have created a very simple benchmark to check the performance
      of each of these and the effects which various interconnects have
      on their performance.
    </p><p>
      There are four access methods:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Primary key access. </b>
            This is access of a record through its primary key. In the
            simplest case, only one record is accessed at a time, which
            means that the full cost of setting up a number of TCP/IP
            messages and a number of costs for context switching are
            borne by this single request. In the case where multiple
            primary key accesses are sent in one batch, those accesses
            share the cost of setting up the necessary TCP/IP messages
            and context switches. If the TCP/IP messages are for
            different destinations, additional TCP/IP messages need to
            be set up.
          </p></li><li><p><b>Unique key access. </b>
            Unique key accesses are similar to primary key accesses,
            except that a unique key access is executed as a read on an
            index table followed by a primary key access on the table.
            However, only one request is sent from the MySQL Server, and
            the read of the index table is handled by
            <span><strong class="command">ndbd</strong></span>. Such requests also benefit from
            batching.
          </p></li><li><p><b>Full table scan. </b>
            When no indexes exist for a lookup on a table, a full table
            scan is performed. This is sent as a single request to the
            <span><strong class="command">ndbd</strong></span> process, which then divides the
            table scan into a set of parallel scans on all cluster
            <span><strong class="command">ndbd</strong></span> processes. In future versions of
            MySQL Cluster, an SQL node will be able to filter some of
            these scans.
          </p></li><li><p>
          <span class="bold"><strong>Range scan using ordered
          index</strong></span>
        </p><p>
          When an ordered index is used, it performs a scan in the same
          manner as the full table scan, except that it scans only those
          records which are in the range used by the query transmitted
          by the MySQL server (SQL node). All partitions are scanned in
          parallel when all bound index attributes include all
          attributes in the partitioning key.
        </p></li></ul></div><p>
      With benchmarks developed internally by MySQL for testing simple
      and batched primary and unique key accesses, we have found that
      using SCI sockets improves performance by approximately 100% over
      TCP/IP, except in rare instances when communication performance is
      not an issue. This can occur when scan filters make up most of
      processing time or when very large batches of primary key accesses
      are achieved. In that case, the CPU processing in the
      <span><strong class="command">ndbd</strong></span> processes becomes a fairly large part of
      the overhead.
    </p><p>
      Using the SCI transporter instead of SCI Sockets is only of
      interest in communicating between <span><strong class="command">ndbd</strong></span>
      processes. Using the SCI transporter is also only of interest if a
      CPU can be dedicated to the <span><strong class="command">ndbd</strong></span> process
      because the SCI transporter ensures that this process will never
      go to sleep. It is also important to ensure that the
      <span><strong class="command">ndbd</strong></span> process priority is set in such a way that
      the process does not lose priority due to running for an extended
      period of time, as can be done by locking processes to CPUs in
      Linux 2.6. If such a configuration is possible, the
      <span><strong class="command">ndbd</strong></span> process will benefit by 10–70% as
      compared with using SCI sockets. (The larger figures will be seen
      when performing updates and probably on parallel scan operations
      as well.)
    </p><p>
      There are several other optimized socket implementations for
      computer clusters, including Myrinet, Gigabit Ethernet, Infiniband
      and the VIA interface. However, we have tested MySQL Cluster so
      far only with SCI sockets. See
      <a href="mysql-cluster.html#mysql-cluster-sci-sockets" title="17.9.1. Configuring MySQL Cluster to use SCI Sockets">Section 17.9.1, “Configuring MySQL Cluster to use SCI Sockets”</a>, for information on
      how to set up SCI sockets using ordinary TCP/IP for MySQL Cluster.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-limitations"></a>17.10. Known Limitations of MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-syntax">17.10.1. Noncompliance with SQL Syntax in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-limits">17.10.2. Limits and Differences of MySQL Cluster from Standard MySQL Limits</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-transactions">17.10.3. Limits Relating to Transaction Handling in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-error-handling">17.10.4. MySQL Cluster Error Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-database-objects">17.10.5. Limits Associated with Database Objects in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-unsupported">17.10.6. Unsupported or Missing Features in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-performance">17.10.7. Limitations Relating to Performance in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-exclusive-to-cluster">17.10.8. Issues Exclusive to MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes">17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-resolved">17.10.10. Previous MySQL Cluster Issues Resolved in MySQL 5.0</a></span></dt></dl></div><a class="indexterm" name="id2310553"></a><a class="indexterm" name="id2310562"></a><p>
    In the sections that follow, we discuss known limitations of MySQL
    Cluster in MySQL 5.0 releases as compared with the
    features available when using the <code class="literal">MyISAM</code> and
    <code class="literal">InnoDB</code> storage engines. Currently, there are no
    plans to address these in coming releases of MySQL 5.0;
    however, we will attempt to supply fixes for these issues in
    subsequent release series. If you check the “<span class="quote">Cluster</span>”
    category in the MySQL bugs database at
    <a href="http://bugs.mysql.com" target="_top">http://bugs.mysql.com</a>, you can find known bugs in the
    following categories under “<span class="quote">MySQL Server:</span>” in the MySQL
    bugs database at <a href="http://bugs.mysql.com" target="_top">http://bugs.mysql.com</a>, which we
    intend to correct in upcoming releases of MySQL Cluster:

    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Cluster
        </p></li><li><p>
          Cluster Direct API (NDBAPI)
        </p></li><li><p>
          Cluster Disk Data
        </p></li><li><p>
          Cluster Replication
        </p></li></ul></div><p>
  </p><p>
    This information is intended to be complete with respect to the
    conditions just set forth. You can report any discrepancies that you
    encounter to the MySQL bugs database using the instructions given in
    <a href="introduction.html#bug-reports" title="1.6. How to Report Bugs or Problems">Section 1.6, “How to Report Bugs or Problems”</a>. If we do not plan to fix the problem
    in MySQL 5.0, we will add it to the list.
  </p><p>
    See <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="17.10.10. Previous MySQL Cluster Issues Resolved in MySQL 5.0">Section 17.10.10, “Previous MySQL Cluster Issues Resolved in MySQL 5.0”</a> for a list
    of issues in MySQL Cluster in MySQL 4.1 that have been
    resolved in the current version.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-syntax"></a>17.10.1. Noncompliance with SQL Syntax in MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2310666"></a><p>
      Some SQL statements relating to certain MySQL features produce
      errors when used with <code class="literal">NDB</code> tables, as
      described in the following list:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Temporary tables. </b>
              Temporary tables are not supported. Trying either to
              create a temporary table that uses the
              <code class="literal">NDB</code> storage engine or to
              alter an existing temporary table to use
              <code class="literal">NDB</code> fails with the error
              <span class="errortext">Table storage engine 'ndbcluster' does not
              support the create option 'TEMPORARY'</span>.
            </p></li><li><p><b>Indexes and keys in <code class="literal">NDB</code> tables. </b>
              Keys and indexes on MySQL Cluster tables are subject to
              the following limitations:

              </p><div class="itemizedlist"><ul type="circle"><li><p><b>Column width. </b>
                      Attempting to create an index on an
                      <code class="literal">NDB</code> table column whose width is
                      greater than 3072 bytes succeeds, but only the
                      first 3072 bytes are actually used for the index.
                      In such cases, a warning <span class="errortext">Specified key
                      was too long; max key length is 3072
                      bytes</span> is issued, and a
                      <a href="sql-syntax.html#show-create-table" title="12.5.5.9. SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>
                      statement shows the length of the index as 3072.
                    </p></li><li><p><b><code class="literal">TEXT</code> and
                      <code class="literal">BLOB</code> columns. </b>
                      You cannot create indexes on
                      <code class="literal">NDB</code> table columns
                      that use any of the
                      <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">TEXT</code></a> or
                      <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> data types.
                    </p></li><li><p><b><code class="literal">FULLTEXT</code> indexes. </b>
                      The <code class="literal">NDB</code> storage
                      engine does not support
                      <code class="literal">FULLTEXT</code> indexes, which are
                      possible for <code class="literal">MyISAM</code> tables
                      only.
                    </p><p>
                    However, you can create indexes on
                    <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a> columns of
                    <code class="literal">NDB</code> tables.
                  </p></li><li><p><b>Prefixes. </b>
                      There are no prefix indexes; only entire columns
                      can be indexed. (The size of an
                      <code class="literal">NDB</code> column index is always the
                      same as the width of the column in bytes, up to
                      and including 3072 bytes, as described earlier in
                      this section. Also see
                      <a href="mysql-cluster.html#mysql-cluster-limitations-unsupported" title="17.10.6. Unsupported or Missing Features in MySQL Cluster">Section 17.10.6, “Unsupported or Missing Features in MySQL Cluster”</a>,
                      for additional information.)
                    </p></li><li><p><b><code class="literal">BIT</code> columns. </b>
                      A <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">BIT</code></a> column cannot
                      be a primary key, unique key, or index, nor can it
                      be part of a composite primary key, unique key, or
                      index.
                    </p></li><li><p><b><code class="literal">AUTO_INCREMENT</code> columns. </b>
                      Like other MySQL storage engines, the
                      <code class="literal">NDB</code> storage engine
                      can handle a maximum of one
                      <code class="literal">AUTO_INCREMENT</code> column per
                      table. However, in the case of a Cluster table
                      with no explicit primary key, an
                      <code class="literal">AUTO_INCREMENT</code> column is
                      automatically defined and used as a
                      “<span class="quote">hidden</span>” primary key. For this
                      reason, you cannot define a table that has an
                      explicit <code class="literal">AUTO_INCREMENT</code> column
                      unless that column is also declared using the
                      <code class="literal">PRIMARY KEY</code> option. Attempting
                      to create a table with an
                      <code class="literal">AUTO_INCREMENT</code> column that is
                      not the table's primary key, and using the
                      <code class="literal">NDB</code> storage engine,
                      fails with an error.
                    </p></li></ul></div><p>
            </p></li><li><p><b>MySQL Cluster and geometry data types. </b><a class="indexterm" name="id2311020"></a>
              Geometry datatypes (<code class="literal">WKT</code> and
              <code class="literal">WKB</code>) are supported in
              <code class="literal">NDB</code> tables in MySQL
              5.0. However, spatial indexes are not
              supported.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-limits"></a>17.10.2. Limits and Differences of MySQL Cluster from Standard MySQL Limits</h3></div></div></div><a class="indexterm" name="id2311070"></a><p>
      In this section, we list limits found in MySQL Cluster that either
      differ from limits found in, or that are not found in, standard
      MySQL.

      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2311090"></a><a class="indexterm" name="id2311103"></a><a class="indexterm" name="id2311115"></a><a class="indexterm" name="id2311128"></a><a class="indexterm" name="id2311140"></a><p><b>Memory usage and recovery. </b>
              Memory consumed when data is inserted into an
              <code class="literal">NDB</code> table is not
              automatically recovered when deleted, as it is with other
              storage engines. Instead, the following rules hold true:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    A <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statement on
                    an <code class="literal">NDB</code> table makes the
                    memory formerly used by the deleted rows available
                    for re-use by inserts on the same table only. This
                    memory cannot be used by other
                    <code class="literal">NDB</code> tables.
                  </p></li><li><p>
                    A <a href="sql-syntax.html#drop-table" title="12.1.17. DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or
                    <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> operation on
                    an <code class="literal">NDB</code> table frees the
                    memory that was used by this table for re-use by any
                    <code class="literal">NDB</code> table, either by
                    the same table or by another
                    <code class="literal">NDB</code> table.
                  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                      Recall that
                      <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> drops and
                      re-creates the table. See
                      <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax">Section 12.2.10, “<code class="literal">TRUNCATE</code> Syntax”</a>.
                    </p></div><p>
                    Memory freed by
                    <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> operations but
                    still allocated to a specific table can also be made
                    available for general re-use by performing a rolling
                    restart of the cluster. See
                    <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="17.5.1. Performing a Rolling Restart of a MySQL Cluster">Section 17.5.1, “Performing a Rolling Restart of a MySQL Cluster”</a>.
                  </p></li><li><p><b>Limits imposed by the cluster's configuration. </b><a class="indexterm" name="id2311294"></a>
                      A number of hard limits exist which are
                      configurable, but available main memory in the
                      cluster sets limits. See the complete list of
                      configuration parameters in
                      <a href="mysql-cluster.html#mysql-cluster-config-file" title="17.3.4. MySQL Cluster Configuration Files">Section 17.3.4, “MySQL Cluster Configuration Files”</a>. Most
                      configuration parameters can be upgraded online.
                      These hard limits include:

                      </p><div class="itemizedlist"><ul type="square"><li><p>
                            Database memory size and index memory size
                            (<code class="literal">DataMemory</code> and
                            <code class="literal">IndexMemory</code>,
                            respectively).
                          </p><p>
                            <code class="literal">DataMemory</code> is allocated
                            as 32KB pages. As each
                            <code class="literal">DataMemory</code> page is used,
                            it is assigned to a specific table; once
                            allocated, this memory cannot be freed
                            except by dropping the table.
                          </p><p>
                            See
                            <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="17.3.4.5. Defining MySQL Cluster Data Nodes">Section 17.3.4.5, “Defining MySQL Cluster Data Nodes”</a>,
                            for further information about
                            <code class="literal">DataMemory</code> and
                            <code class="literal">IndexMemory</code>.
                          </p></li><li><p>
                            The maximum number of operations that can be
                            performed per transaction is set using the
                            configuration parameters
                            <code class="literal">MaxNoOfConcurrentOperations</code>
                            and
                            <code class="literal">MaxNoOfLocalOperations</code>.
                          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                              Bulk loading,
                              <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE
                              TABLE</code></a>, and
                              <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
                              are handled as special cases by running
                              multiple transactions, and so are not
                              subject to this limitation.
                            </p></div></li><li><p>
                            Different limits related to tables and
                            indexes. For example, the maximum number of
                            ordered indexes in the cluster is determined
                            by <code class="literal">MaxNoOfOrderedIndexes</code>,
                            and the maximum number of ordered inexes per
                            table is 16.
                          </p></li></ul></div><p>
                    </p></li><li><p><b>Memory usage. </b>
                      All Cluster table rows are of fixed length. This
                      means (for example) that if a table has one or
                      more <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a> fields
                      containing only relatively small values, more
                      memory and disk space is required when using the
                      <code class="literal">NDB</code> storage engine
                      than would be the case for the same table and data
                      using the <code class="literal">MyISAM</code> engine. (In
                      other words, in the case of a
                      <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a> column, the
                      column requires the same amount of storage as a
                      <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">CHAR</code></a> column of the
                      same size.)
                    </p></li><li><p><b>Node and data object maximums. </b>
                      The following limits apply to numbers of cluster
                      nodes and metadata objects:

                      </p><div class="itemizedlist"><ul type="square"><li><p>
                            The maximum number of data nodes is 48.
                          </p><p>
                            A data node must have a node ID in the range
                            of 1‐49, inclusive. (Management and API
                            nodes may use any integer in the range of
                            1‐63 inclusive as a node ID.)
                          </p></li><li><p>
                            The total maximum number of nodes in a MySQL
                            Cluster is 63. This number includes all SQL
                            nodes (MySQL Servers), API nodes
                            (applications accessing the cluster other
                            than MySQL servers), data nodes, and
                            management servers.
                          </p></li><li><p>
                            The maximum number of metadata objects in
                            MySQL 5.0 Cluster is 20320.
                            This limit is hard-coded.
                          </p></li></ul></div><p>
                    </p></li></ul></div><p>
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-transactions"></a>17.10.3. Limits Relating to Transaction Handling in MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2311565"></a><p>
      A number of limitations exist in MySQL Cluster with regard to the
      handling of transactions. These include the following:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Transaction isolation level. </b>
              The <code class="literal">NDBCLUSTER</code> storage engine
              supports only the <a href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ
              COMMITTED</code></a> transaction isolation level.
              (<code class="literal">InnoDB</code>, for example, supports
              <a href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ COMMITTED</code></a>,
              <a href="sql-syntax.html#isolevel_read-uncommitted"><code class="literal">READ UNCOMMITTED</code></a>,
              <a href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>, and
              <a href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>.) See
              <a href="mysql-cluster.html#mysql-cluster-backup-troubleshooting" title="17.7.3.4. MySQL Cluster Backup Troubleshooting">Section 17.7.3.4, “MySQL Cluster Backup Troubleshooting”</a>,
              for information on how this can affect backing up and
              restoring Cluster databases.)

              </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                  If a <a href="sql-syntax.html#select" title="12.2.8. SELECT Syntax"><code class="literal">SELECT</code></a> from a
                  Cluster table includes a
                  <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> or
                  <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">TEXT</code></a> column, the
                  <a href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ COMMITTED</code></a>
                  transaction isolation level is converted to a read
                  with read lock. This is done to guarantee consistency,
                  due to the fact that parts of the values stored in
                  columns of these types are actually read from a
                  separate table.
                </p></div><p>
            </p></li><li><p><b>Rollbacks. </b>
              There are no partial transactions, and no partial
              rollbacks of transactions. A duplicate key or similar
              error aborts the entire transaction, and subsequent
              statements raise <span class="errortext">ERROR 1296 (HY000): Got error
              4350 'Transaction already aborted' from
              NDBCLUSTER</span>. In such cases, you must issue an
              explicit
              <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
              and retry the entire transaction.
            </p><p>
            This behavior differs from that of other transactional
            storage engines such as <code class="literal">InnoDB</code> that may
            roll back individual statements.
          </p></li><li><p><b>Transactions and memory usage. </b><a class="indexterm" name="id2311737"></a><a class="indexterm" name="id2311750"></a>
              As noted elsewhere in this chapter, MySQL Cluster does not
              handle large transactions well; it is better to perform a
              number of small transactions with a few operations each
              than to attempt a single large transaction containing a
              great many operations. Among other considerations, large
              transactions require very large amounts of memory. Because
              of this, the transactional behaviour of a number of MySQL
              statements is effected as described in the following list:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> is not
                    transactional when used on
                    <code class="literal">NDB</code> tables. If a
                    <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> fails to
                    empty the table, then it must be re-run until it is
                    successful.
                  </p></li><li><p>
                    <code class="literal">DELETE FROM</code> (even with no
                    <code class="literal">WHERE</code> clause)
                    <span class="emphasis"><em>is</em></span> transactional. For tables
                    containing a great many rows, you may find that
                    performance is improved by using several
                    <code class="literal">DELETE FROM ... LIMIT ...</code>
                    statements to “<span class="quote">chunk</span>” the delete
                    operation. If your objective is to empty the table,
                    then you may wish to use
                    <a href="sql-syntax.html#truncate" title="12.2.10. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> instead.
                  </p></li><li><p><b><code class="literal">LOAD DATA</code> statements. </b>
                      <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD
                      DATA INFILE</code></a> is not transactional when
                      used on <code class="literal">NDB</code> tables.

                      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                          When executing a
                          <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD
                          DATA INFILE</code></a> statement, the
                          <code class="literal">NDB</code> engine
                          performs commits at irregular intervals that
                          enable better utilization of the communication
                          network. It is not possible to know ahead of
                          time when such commits take place.
                        </p></div><p>

                      <code class="literal">LOAD DATA FROM MASTER</code> is not
                      supported in MySQL Cluster.
                    </p></li><li><p><b><code class="literal">ALTER TABLE</code> and transactions. </b>
                      When copying an <code class="literal">NDB</code>
                      table as part of an <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER
                      TABLE</code></a>, the creation of the copy is
                      nontransactional. (In any case, this operation is
                      rolled back when the copy is deleted.)
                    </p></li></ul></div><p>
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-error-handling"></a>17.10.4. MySQL Cluster Error Handling</h3></div></div></div><a class="indexterm" name="id2311953"></a><p>
      Starting, stopping, or restarting a node may give rise to
      temporary errors causing some transactions to fail. These include
      the following cases:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Temporary errors. </b>
              When first starting a node, it is possible that you may
              see Error 1204 <span class="errortext">Temporary failure, distribution
              changed</span> and similar temporary errors.
            </p></li><li><p><b>Errors due to node failure. </b>
              The stopping or failure of any data node can result in a
              number of different node failure errors. (However, there
              should be no aborted transactions when performing a
              planned shutdown of the cluster.)
            </p></li></ul></div><p>
    </p><p>
      In either of these cases, any errors that are generated must be
      handled within the application. This should be done by retrying
      the transaction.
    </p><p>
      See also <a href="mysql-cluster.html#mysql-cluster-limitations-limits" title="17.10.2. Limits and Differences of MySQL Cluster from Standard MySQL Limits">Section 17.10.2, “Limits and Differences of MySQL Cluster from Standard MySQL Limits”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-database-objects"></a>17.10.5. Limits Associated with Database Objects in MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2312030"></a><p>
      Some database objects such as tables and indexes have different
      limitations when using the <code class="literal">NDBCLUSTER</code>
      storage engine:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Identifiers. </b>
              Database names, table names and attribute names cannot be
              as long in <code class="literal">NDB</code> tables as when
              using other table handlers. Attribute names are truncated
              to 31 characters, and if not unique after truncation give
              rise to errors. Database names and table names can total a
              maximum of 122 characters. In other words, the maximum
              length for an <code class="literal">NDB</code> table name
              is 122 characters, less the number of characters in the
              name of the database of which that table is a part.
            </p></li><li><p><b>Table names containing special characters. </b>
              <code class="literal">NDB</code> tables whose names
              contain characters other than letters, numbers, dashes,
              and underscores and which are created on one SQL node may
              not be discovered correctly by other SQL nodes. (<a href="http://bugs.mysql.com/31470" target="_top">Bug#31470</a>)
            </p></li><li><p><b>Number of tables and other database objects. </b>
              The maximum number of tables in a Cluster database in
              MySQL 5.0 is limited to 1792. The maximum
              number of <span class="emphasis"><em>all</em></span>
              <code class="literal">NDBCLUSTER</code> database objects
              in a single MySQL Cluster — including databases,
              tables, and indexes — is limited to 20320.
            </p></li><li><p><b>Attributes per table. </b>
              The maximum number of attributes (that is, columns and
              indexes) per table is limited to 128.
            </p></li><li><p><b>Attributes per key. </b>
              The maximum number of attributes per key is 32.
            </p></li><li><p><b>Row size. </b>
              The maximum permitted size of any one row is 8KB. Note
              that each <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> or
              <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">TEXT</code></a> column contributes 256
              + 8 = 264 bytes towards this total.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-unsupported"></a>17.10.6. Unsupported or Missing Features in MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2312215"></a><p>
      A number of features supported by other storage engines are not
      supported for <code class="literal">NDB</code> tables. Trying to
      use any of these features in MySQL Cluster does not cause errors
      in or of itself; however, errors may occur in applications that
      expects the features to be supported or enforced:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Foreign key constraints. </b>
              The foreign key construct is ignored, just as it is in
              <code class="literal">MyISAM</code> tables.
            </p></li><li><p><b>Index prefixes. </b>
              Prefixes on indexes are not supported for
              <code class="literal">NDBCLUSTER</code> tables. If a prefix is used
              as part of an index specification in a statement such as
              <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
              <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, or
              <a href="sql-syntax.html#create-index" title="12.1.8. CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>, the prefix is
              ignored.
            </p></li><li><p><b><code class="literal">OPTIMIZE</code> operations. </b>
              <code class="literal">OPTIMIZE</code> operations are not supported.
            </p></li><li><p><b><code class="literal">LOAD TABLE ... FROM MASTER</code>. </b>
              <code class="literal">LOAD TABLE ... FROM MASTER</code> is not
              supported.
            </p></li><li><p><b>Savepoints and rollbacks. </b>
              Savepoints and rollbacks to savepoints are ignored as in
              <code class="literal">MyISAM</code>.
            </p></li><li><p><b>Durability of commits. </b>
              There are no durable commits on disk. Commits are
              replicated, but there is no guarantee that logs are
              flushed to disk on commit.
            </p></li><li><p><b>Replication. </b>
              Replication is not supported.
            </p></li></ul></div><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        See <a href="mysql-cluster.html#mysql-cluster-limitations-transactions" title="17.10.3. Limits Relating to Transaction Handling in MySQL Cluster">Section 17.10.3, “Limits Relating to Transaction Handling in MySQL Cluster”</a>,
        for more information relating to limitations on transaction
        handling in <code class="literal">NDB</code>.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-performance"></a>17.10.7. Limitations Relating to Performance in MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2312431"></a><p>
      The following performance issues are specific to or especially
      pronounced in MySQL Cluster:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Range scans. </b>
              There are query performance issues due to sequential
              access to the <code class="literal">NDB</code> storage
              engine; it is also relatively more expensive to do many
              range scans than it is with either
              <code class="literal">MyISAM</code> or <code class="literal">InnoDB</code>.
            </p></li><li><p><b>Reliability of <code class="literal">Records in range</code>. </b>
              The <code class="literal">Records in range</code> statistic is
              available but is not completely tested or officially
              supported. This may result in nonoptimal query plans in
              some cases. If necessary, you can employ <code class="literal">USE
              INDEX</code> or <code class="literal">FORCE INDEX</code> to alter
              the execution plan. See <a href="sql-syntax.html#index-hints" title="12.2.8.2. Index Hint Syntax">Section 12.2.8.2, “Index Hint Syntax”</a>, for
              more information on how to do this.
            </p></li><li><p><b>Unique hash indexes. </b>
              Unique hash indexes created with <code class="literal">USING
              HASH</code> cannot be used for accessing a table if
              <code class="literal">NULL</code> is given as part of the key.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-exclusive-to-cluster"></a>17.10.8. Issues Exclusive to MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2312564"></a><p>
      The following are limitations specific to the
      <code class="literal">NDBCLUSTER</code> storage engine:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Machine architecture. </b>
              The following issues relate to physical architecture of
              cluster hosts:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    All machines used in the cluster must have the same
                    architecture. That is, all machines hosting nodes
                    must be either big-endian or little-endian, and you
                    cannot use a mixture of both. For example, you
                    cannot have a management node running on a PowerPC
                    which directs a data node that is running on an x86
                    machine. This restriction does not apply to machines
                    simply running <a href="programs.html#mysql" title="4.5.1. mysql — The MySQL Command-Line Tool"><span><strong class="command">mysql</strong></span></a> or other
                    clients that may be accessing the cluster's SQL
                    nodes.
                  </p></li><li><p><b>Adding and dropping of data nodes. </b>
                      Online adding or dropping of data nodes is not
                      currently possible. In such cases, the entire
                      cluster must be restarted.
                    </p></li><li><p><b>Backup and restore between architectures. </b>
                      It is also not possible to perform a Cluster
                      backup and restore between different
                      architectures. For example, you cannot back up a
                      cluster running on a big-endian platform and then
                      restore from that backup to a cluster running on a
                      little-endian system. (<a href="http://bugs.mysql.com/19255" target="_top">Bug#19255</a>)
                    </p></li></ul></div><p>
            </p></li><li><p><b>Online schema changes. </b>
              It is not possible to make online schema changes such as
              those accomplished using <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER
              TABLE</code></a> or <a href="sql-syntax.html#create-index" title="12.1.8. CREATE INDEX Syntax"><code class="literal">CREATE
              INDEX</code></a>, as the <code class="literal">NDB Cluster</code>
              engine does not support autodiscovery of such changes.
              (However, you can import or create a table that uses a
              different storage engine, and then convert it to
              <code class="literal">NDB</code> using <code class="literal">ALTER
              TABLE <em class="replaceable"><code>tbl_name</code></em>
              ENGINE=NDBCLUSTER</code>. In such a case, you must
              issue a <a href="sql-syntax.html#flush" title="12.5.6.2. FLUSH Syntax"><code class="literal">FLUSH
              TABLES</code></a> statement to force the cluster to pick up
              the change.)
            </p></li><li><p><b>Binary logging. </b><a class="indexterm" name="id2312734"></a><a class="indexterm" name="id2312746"></a>
              MySQL Cluster has the following limitations or
              restrictions with regard to binary logging:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    <a href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> has no
                    effect on data operations; however, it is supported
                    for schema operations.
                  </p></li><li><p>
                    MySQL Cluster cannot produce a binlog for tables
                    having <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> columns
                    but no primary key.
                  </p></li><li><p>
                    Only the following schema operations are logged in a
                    cluster binlog which is <span class="emphasis"><em>not</em></span> on
                    the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> executing the
                    statement:

                    </p><div class="itemizedlist"><ul type="square"><li><p>
                          <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
                        </p></li><li><p>
                          <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
                        </p></li><li><p>
                          <a href="sql-syntax.html#drop-table" title="12.1.17. DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>
                        </p></li><li><p>
                          <a href="sql-syntax.html#create-database" title="12.1.6. CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>
                          /
                          <a href="sql-syntax.html#create-database" title="12.1.6. CREATE DATABASE Syntax"><code class="literal">CREATE
                          SCHEMA</code></a>
                        </p></li><li><p>
                          <a href="sql-syntax.html#drop-database" title="12.1.13. DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> /
                          <a href="sql-syntax.html#drop-database" title="12.1.13. DROP DATABASE Syntax"><code class="literal">DROP
                          SCHEMA</code></a>
                        </p></li></ul></div><p>
                  </p></li></ul></div><p>
            </p></li></ul></div><p>

      See also
      <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes">Section 17.10.9, “Limitations Relating to Multiple MySQL Cluster Nodes”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-multiple-nodes"></a>17.10.9. Limitations Relating to Multiple MySQL Cluster Nodes</h3></div></div></div><p><b>Multiple SQL nodes. </b><a class="indexterm" name="id2312923"></a>
        The following are issues relating to the use of multiple MySQL
        servers as MySQL Cluster SQL nodes, and are specific to the
        <code class="literal">NDBCLUSTER</code> storage engine:

        </p><div class="itemizedlist"><ul type="disc"><li><p><b>No distributed table locks. </b>
                A <a href="sql-syntax.html#lock-tables" title="12.4.5. LOCK TABLES and
      UNLOCK
      TABLES Syntax"><code class="literal">LOCK TABLES</code></a> works only
                for the SQL node on which the lock is issued; no other
                SQL node in the cluster “<span class="quote">sees</span>” this lock.
                This is also true for a lock issued by any statement
                that locks tables as part of its operations. (See next
                item for an example.)
              </p></li><li><p><b><code class="literal">ALTER TABLE</code> operations. </b>
                <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> is not fully
                locking when running multiple MySQL servers (SQL nodes).
                (As discussed in the previous item, MySQL Cluster does
                not support distributed table locks.)
              </p></li><li><p><b>Replication. </b>
                MySQL replication will not work correctly if updates are
                done on multiple MySQL servers. However, if the database
                partitioning scheme is done at the application level and
                no transactions take place across these partitions,
                replication can be made to work.
              </p></li><li><p><b>Database autodiscovery. </b>
                Autodiscovery of databases is not supported for multiple
                MySQL servers accessing the same MySQL Cluster. However,
                autodiscovery of tables is supported in such cases. What
                this means is that after a database named
                <em class="replaceable"><code>db_name</code></em> is created or
                imported using one MySQL server, you should issue a
                <code class="literal">CREATE DATABASE
                <em class="replaceable"><code>db_name</code></em></code> statement
                on each additional MySQL server that accesses the same
                MySQL Cluster. (As of MySQL 5.0.2, you may also use
                <code class="literal">CREATE SCHEMA
                <em class="replaceable"><code>db_name</code></em></code>.) Once this
                has been done for a given MySQL server, that server
                should be able to detect the database tables without
                error.
              </p></li><li><p><b>DDL operations. </b>
                DDL operations (such as <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax"><code class="literal">CREATE
                TABLE</code></a> or <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax"><code class="literal">ALTER
                TABLE</code></a>) are not safe from data node failures.
                If a data node fails while trying to perform one of
                these, the data dictionary is locked and no further DDL
                statements can be executed without restarting the
                cluster.
              </p></li></ul></div><p>
      </p><p><b>Multiple management nodes. </b><a class="indexterm" name="id2313095"></a>
        When using multiple management servers:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              You must give nodes explicit IDs in connectstrings because
              automatic allocation of node IDs does not work across
              multiple management servers.
            </p><p>
              In addition, all API nodes (including MySQL servers acting
              as SQL nodes), should list all management servers using
              the same order in their connectstrings.
            </p></li><li><p>
              You must take extreme care to have the same configurations
              for all management servers. No special checks for this are
              performed by the cluster.
            </p></li><li><p>
              Prior to MySQL 5.0.14, all data nodes had to be restarted
              after bringing up the cluster in order for the management
              nodes to be able to see one another.
            </p><p>
              (See <a href="http://bugs.mysql.com/12307" target="_top">Bug#12307</a> and <a href="http://bugs.mysql.com/13070" target="_top">Bug#13070</a> for more information.)
            </p></li></ul></div><p>
      </p><p><b>Multiple data node processes. </b>
        While it is possible to run multiple cluster processes
        concurrently on a single host, it is not always advisable to do
        so for reasons of performance and high availability, as well as
        other considerations. In particular, in MySQL 5.0,
        we do not support for production use any MySQL Cluster
        deployment in which more than one <span><strong class="command">ndbd</strong></span>
        process is run on a single physical machine.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            We may support multiple data nodes per host in a future
            MySQL release, following additional testing. However, in
            MySQL 5.0, such configurations can be
            considered experimental only.
          </p></div><p>
      </p><p><b>Multiple network addresses. </b>
        Multiple network addresses per data node are not supported. Use
        of these is liable to cause problems: In the event of a data
        node failure, an SQL node waits for confirmation that the data
        node went down but never receives it because another route to
        that data node remains open. This can effectively make the
        cluster inoperable.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            It is possible to use multiple network hardware
            <span class="emphasis"><em>interfaces</em></span> (such as Ethernet cards) for
            a single data node, but these must be bound to the same
            address. This also means that it not possible to use more
            than one <code class="literal">[tcp]</code> section per connection in
            the <code class="literal">config.ini</code> file. See
            <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="17.3.4.7. MySQL Cluster TCP/IP Connections">Section 17.3.4.7, “MySQL Cluster TCP/IP Connections”</a>, for more
            information.
          </p></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-resolved"></a>17.10.10. Previous MySQL Cluster Issues Resolved in MySQL 5.0</h3></div></div></div><a class="indexterm" name="id2313242"></a><p>
      The following Cluster limitations in MySQL 4.1 have been resolved
      in MySQL 5.0 as shown below:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Character set support. </b>
            The <code class="literal">NDBCLUSTER</code> storage engine
            supports all character sets and collations available in
            MySQL 5.0.
          </p></li><li><p><b>Character set directory. </b>
            Beginning with MySQL 5.0.21, it is possible to install MySQL
            with Cluster support to a nondefault location and change the
            search path for font description files using either the
            <a href="server-administration.html#option_mysqld_basedir"><code class="option">--basedir</code></a> or
            <a href="server-administration.html#option_mysqld_character-sets-dir"><code class="option">--character-sets-dir</code></a> options.
            (Previously, <span><strong class="command">ndbd</strong></span> in MySQL 5.0 searched
            only the default path — typically
            <code class="filename">/usr/local/mysql/share/mysql/charsets</code>
            — for character sets.)
          </p></li><li><p><b>Metadata objects. </b>
            Prior to MySQL 5.0.6, the maximum number of metadata objects
            possible was 1600. Beginning with MySQL 5.0.6, this limit is
            increased to 20320.
          </p></li><li><p><b>Query cache. </b>
            Unlike the case in MySQL 4.1, the Cluster storage engine in
            MySQL 5.0 supports MySQL's query cache. See
            <a href="optimization.html#query-cache" title="7.5.5. The MySQL Query Cache">Section 7.5.5, “The MySQL Query Cache”</a>.
          </p></li><li><p><b><code class="literal">IGNORE</code> and <code class="literal">REPLACE</code>
            functionality. </b><a class="indexterm" name="id2313377"></a>
            In MySQL 5.0.19 and earlier,
            <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT
            IGNORE</code></a>, <code class="literal">UPDATE IGNORE</code>, and
            <a href="sql-syntax.html#replace" title="12.2.7. REPLACE Syntax"><code class="literal">REPLACE</code></a> were supported only
            for primary keys, but not for unique keys. It was possible
            to work around this issue by removing the constraint, then
            dropping the unique index, performing any inserts, and then
            adding the unique index again.
          </p><p>
          This limitation was removed for
          <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT
          IGNORE</code></a> and <a href="sql-syntax.html#replace" title="12.2.7. REPLACE Syntax"><code class="literal">REPLACE</code></a> in
          MySQL 5.0.20. (See <a href="http://bugs.mysql.com/17431" target="_top">Bug#17431</a>.)
        </p></li><li><p><b><code class="literal">auto_increment_increment</code> and
            <code class="literal">auto_increment_offset</code>. </b>
            The
            <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
            and <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
            server system variables are supported for
            <code class="literal">NDBCLUSTER</code> tables beginning
            with MySQL 5.0.46.
          </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-roadmap"></a>17.11. MySQL Cluster Development Roadmap</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-5-0-changes">17.11.1. MySQL Cluster Changes in MySQL 5.0</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-5-1-roadmap">17.11.2. MySQL 5.1 Development Roadmap for MySQL Cluster</a></span></dt></dl></div><a class="indexterm" name="id2313495"></a><a class="indexterm" name="id2313504"></a><a class="indexterm" name="id2313513"></a><p>
    In this section, we discuss changes in the implementation of MySQL
    Cluster in MySQL 5.0 as compared to MySQL
    4.1. We will also discuss our roadmap for further
    improvements to MySQL Cluster as currently planned for MySQL
    5.1.
  </p><p>
    There are relatively few changes between the NDB Cluster storage
    engine implementations in MySQL 4.1 and in
    5.0, so the upgrade path should be relatively quick and
    painless.
  </p><p>
    All significantly new features being developed for MySQL Cluster are
    going into the MySQL Cluster NDB 6.x trees. For information on
    changes in the Cluster implementations in MySQL versions 5.1 and
    later, see <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster.html" target="_top">MySQL Cluster NDB 6.X/7.X</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-5-0-changes"></a>17.11.1. MySQL Cluster Changes in MySQL 5.0</h3></div></div></div><p>
      MySQL Cluster in MySQL 5.0 contains a number of features added
      since MySQL 4.1 that are likely to be of interest:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Condition pushdown. </b>
            Consider the following query:

</p><pre class="programlisting">SELECT * FROM t1 WHERE non_indexed_attribute = 1;
</pre><p>

            This query uses a full table scan and the condition is
            evaluated in the cluster's data nodes. Thus, it is not
            necessary to send the records across the network for
            evaluation. (That is, function transport is used, rather
            than data transport.) Please note that this feature is
            currently disabled by default (pending more thorough
            testing), but it should work in most cases. This feature can
            be enabled through the use of the <code class="literal">SET
            engine_condition_pushdown = On</code> statement.
            Alternatively, you can run <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> with
            the this feature enabled by starting the MySQL server with
            the <code class="option">--engine-condition-pushdown</code> option.
          </p><p>
          A major benefit of this change is that queries can be executed
          in parallel. This means that queries against nonindexed
          columns can run faster than previously by a factor of as much
          as 5 to 10 times, <span class="emphasis"><em>times the number of data
          nodes</em></span>, because multiple CPUs can work on the query
          in parallel.
        </p><p>
          You can use <a href="sql-syntax.html#explain" title="12.3.2. EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to
          determine when condition pushdown is being used. See
          <a href="sql-syntax.html#explain" title="12.3.2. EXPLAIN Syntax">Section 12.3.2, “<code class="literal">EXPLAIN</code> Syntax”</a>.
        </p></li><li><p>
          <span class="bold"><strong>Decreased <code class="literal">IndexMemory</code>
          Usage</strong></span>: In MySQL 5.0, each record
          consumes approximately 25 bytes of index memory, and every
          unique index uses 25 bytes per record of index memory (in
          addition to some data memory because these are stored in a
          separate table). This is because the primary key is not stored
          in the index memory anymore.
        </p></li><li><p>
          <span class="bold"><strong>Query Cache Enabled for MySQL
          Cluster</strong></span>: See <a href="optimization.html#query-cache" title="7.5.5. The MySQL Query Cache">Section 7.5.5, “The MySQL Query Cache”</a>, for
          information on configuring and using the query cache.
        </p></li><li><p><b>New optimizations. </b>
            One optimization that merits particular attention is that a
            batched read interface is now used in some queries. For
            example, consider the following query:

</p><pre class="programlisting">SELECT * FROM t1 WHERE <em class="replaceable"><code>primary_key</code></em> IN (1,2,3,4,5,6,7,8,9,10);
</pre><p>

            This query will be executed 2 to 3 times more quickly than
            in previous MySQL Cluster versions due to the fact that all
            10 key lookups are sent in a single batch rather than one at
            a time.
          </p></li><li><p>
          <span class="bold"><strong>Limit On Number of Metadata
          Objects</strong></span>: Beginning with MySQL 5.0.6, each Cluster
          database may contain a maximum of 20320 metadata objects
          — this includes database tables, system tables, indexes
          and <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> values. (Previously,
          this number was 1600.)
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-5-1-roadmap"></a>17.11.2. MySQL 5.1 Development Roadmap for MySQL Cluster</h3></div></div></div><p>
      What is said here is a status report based on recent commits to
      the MySQL 5.1 source tree. It should be noted all 5.1 development
      is subject to change.
    </p><p>
      There are currently 4 major new features being developed for MySQL
      5.1:
    </p><div class="orderedlist"><ol type="1"><li><p>
          <span class="bold"><strong>Integration of MySQL Cluster into MySQL
          replication</strong></span>: This will make it possible to update
          from any MySQL Server in the cluster and still have the MySQL
          Replication handled by one of the MySQL Servers in the
          cluster, with the state of the slave side remaining consistent
          with the cluster acting as the master.
        </p></li><li><p>
          <span class="bold"><strong>Support for disk-based
          records</strong></span>: Records on disk will be supported. Indexed
          fields including the primary key hash index must still be
          stored in RAM but all other fields can be on disk.
        </p></li><li><p><b>Variable-sized records. </b>
            A column defined as <code class="literal">VARCHAR(255)</code>
            currently uses 260 bytes of storage independent of what is
            stored in any particular record. In MySQL 5.1 Cluster
            tables, only the portion of the column actually taken up by
            the record will be stored. This will make possible a
            reduction in space requirements for such columns by a factor
            of 5 in many cases.
          </p></li><li><p><b>User-defined partitioning. </b>
            Users will be able to define partitions based on columns
            that are part of the primary key. The MySQL Server will be
            able to discover whether it is possible to prune away some
            of the partitions from the <code class="literal">WHERE</code> clause.
            Partitioning based on <code class="literal">KEY</code>,
            <code class="literal">HASH</code>, <code class="literal">RANGE</code>, and
            <code class="literal">LIST</code> handlers will be possible, as well
            as subpartitioning. This feature should also be available
            for many other handlers, and not only <code class="literal">NDB
            Cluster</code>.
          </p></li></ol></div><p>
      In addition, we are working to increase the 8KB size limit for
      rows containing columns of types other than
      <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> or
      <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">TEXT</code></a> in Cluster tables. This is due
      to the fact that rows are currently fixed in size and the page
      size is 32,768 bytes (minus 128 bytes for the row header).
      Currently, this means that if we allowed more than 8KB per record,
      any remaining space (up to approximately 14,000 bytes) would be
      left empty. In MySQL 5.1, we plan to fix this limitation so that
      using more than 8KB in a given row does not result in the
      remainder of the page being wasted.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-glossary"></a>17.12. MySQL Cluster Glossary</h2></div></div></div><a class="indexterm" name="id2313901"></a><a class="indexterm" name="id2313914"></a><p>
    The following terms are useful to an understanding of MySQL Cluster
    or have specialized meanings when used in relation to it.
  </p><div class="itemizedlist"><ul type="disc"><li><p><b>Cluster. </b>
          In its generic sense, a cluster is a set of computers
          functioning as a unit and working together to accomplish a
          single task.
        </p><p><b><code class="literal">NDBCLUSTER</code>. </b>
          This is the storage engine used in MySQL to implement data
          storage, retrieval, and management distributed among several
          computers.
        </p><p><b>MySQL Cluster. </b>
          This refers to a group of computers working together using the
          <code class="literal">NDB</code> storage engine to support a
          distributed MySQL database in a <span class="emphasis"><em>shared-nothing
          architecture</em></span> using <span class="emphasis"><em>in-memory
          storage</em></span>.
        </p></li><li><p><b>Configuration files. </b>
          Text files containing directives and information regarding the
          cluster, its hosts, and its nodes. These are read by the
          cluster's management nodes when the cluster is started. See
          <a href="mysql-cluster.html#mysql-cluster-config-file" title="17.3.4. MySQL Cluster Configuration Files">Section 17.3.4, “MySQL Cluster Configuration Files”</a>, for details.
        </p></li><li><p><b>Backup. </b>
          A complete copy of all cluster data, transactions and logs,
          saved to disk or other long-term storage.
        </p></li><li><p><b>Restore. </b>
          Returning the cluster to a previous state, as stored in a
          backup.
        </p></li><li><p><b>Checkpoint. </b>
          Generally speaking, when data is saved to disk, it is said
          that a checkpoint has been reached. More specific to Cluster,
          it is a point in time where all committed transactions are
          stored on disk. With regard to the
          <code class="literal">NDB</code> storage engine, there are two
          types of checkpoints which work together to ensure that a
          consistent view of the cluster's data is maintained:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Local Checkpoint (LCP). </b>
              This is a checkpoint that is specific to a single node;
              however, LCP's take place for all nodes in the cluster
              more or less concurrently. An LCP involves saving all of a
              node's data to disk, and so usually occurs every few
              minutes. The precise interval varies, and depends upon the
              amount of data stored by the node, the level of cluster
              activity, and other factors.
            </p></li><li><p><b>Global Checkpoint (GCP). </b>
              A GCP occurs every few seconds, when transactions for all
              nodes are synchronized and the redo-log is flushed to
              disk.
            </p></li></ul></div></li><li><p><b>Cluster host. </b>
          A computer making up part of a MySQL Cluster. A cluster has
          both a <span class="emphasis"><em>physical</em></span> structure and a
          <span class="emphasis"><em>logical</em></span> structure. Physically, the
          cluster consists of a number of computers, known as
          <em class="firstterm">cluster hosts</em> (or more simply as
          <em class="firstterm">hosts</em>. See also
          <span class="bold"><strong>Node</strong></span> and
          <span class="bold"><strong>Node group</strong></span> below.
        </p></li><li><p><b>Node. </b>
          This refers to a logical or functional unit of MySQL Cluster,
          and is sometimes also referred to as a <em class="firstterm">cluster
          node</em>. In the context of MySQL Cluster, we use the
          term “<span class="quote">node</span>” to indicate a
          <span class="emphasis"><em>process</em></span> rather than a physical component
          of the cluster. There are three node types required to
          implement a working MySQL Cluster:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Management nodes. </b>
              Manages the other nodes within the MySQL Cluster. It
              provides configuration data to the other nodes; starts and
              stops nodes; handles network partitioning; creates backups
              and restores from them, and so forth.
            </p></li><li><p><b>SQL nodes. </b>
              Instances of MySQL Server which serve as front ends to
              data kept in the cluster's <span class="bold"><strong>data
              nodes</strong></span>. Clients desiring to store, retrieve, or
              update data can access an SQL node just as they would any
              other MySQL Server, employing the usual MySQL
              authentication methods and APIs; the underlying
              distribution of data between node groups is transparent to
              users and applications. SQL nodes access the cluster's
              databases as a whole without regard to the data's
              distribution across different data nodes or cluster hosts.
            </p></li><li><p><b>Data nodes. </b>
              These nodes store the actual data. Table data fragments
              are stored in a set of node groups; each node group stores
              a different subset of the table data. Each of the nodes
              making up a node group stores a replica of the fragment
              for which that node group is responsible. Currently, a
              single cluster can support up to 48 data nodes total.
            </p></li></ul></div><p>
        It is possible for more than one node to co-exist on a single
        machine. (In fact, it is even possible to set up a complete
        cluster on one machine, although one would almost certainly
        <span class="emphasis"><em>not</em></span> want to do this in a production
        environment.) It may be helpful to remember that, when working
        with MySQL Cluster, the term <span class="emphasis"><em>host</em></span> refers to
        a physical component of the cluster whereas a
        <span class="emphasis"><em>node</em></span> is a logical or functional component
        (that is, a process).
      </p><p><b>Note Regarding Terms. </b>
          In older versions of the MySQL Cluster documentation, data
          nodes were sometimes referred to as “<span class="quote">database
          nodes</span>”. The term “<span class="quote">storage nodes</span>” has also
          been used. In addition, SQL nodes were sometimes known as
          “<span class="quote">client nodes</span>”. This older terminology has been
          deprecated to minimize confusion, and for this reason should
          be avoided. They are also often referred to as “<span class="quote">API
          nodes</span>” — an SQL node is actually an API node that
          provides an SQL interface to the cluster.
        </p></li><li><p><b>Node group. </b>
          A set of data nodes. All data nodes in a node group contain
          the same data (fragments), and all nodes in a single group
          should reside on different hosts. It is possible to control
          which nodes belong to which node groups.
        </p><p>
        For more information, see
        <a href="mysql-cluster.html#mysql-cluster-nodes-groups" title="17.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions">Section 17.1.2, “MySQL Cluster Nodes, Node Groups, Replicas, and Partitions”</a>.
      </p></li><li><p><b>Node failure. </b>
          MySQL Cluster is not solely dependent upon the functioning of
          any single node making up the cluster; the cluster can
          continue to run if one or more nodes fail. The precise number
          of node failures that a given cluster can tolerate depends
          upon the number of nodes and the cluster's configuration.
        </p></li><li><p><b>Node restart. </b>
          The process of restarting a failed cluster node.
        </p></li><li><p><b>Initial node restart. </b>
          The process of starting a cluster node with its file system
          removed. This is sometimes used in the course of software
          upgrades and in other special circumstances.
        </p></li><li><p><b>System crash (or system failure). </b>
          This can occur when so many cluster nodes have failed that the
          cluster's state can no longer be guaranteed.
        </p></li><li><p><b>System restart. </b>
          The process of restarting the cluster and reinitializing its
          state from disk logs and checkpoints. This is required after
          either a planned or an unplanned shutdown of the cluster.
        </p></li><li><p><b>Fragment. </b>
          A portion of a database table; in the
          <code class="literal">NDB</code> storage engine, a table is
          broken up into and stored as a number of fragments. A fragment
          is sometimes also called a “<span class="quote">partition</span>”; however,
          “<span class="quote">fragment</span>” is the preferred term. Tables are
          fragmented in MySQL Cluster in order to facilitate load
          balancing between machines and nodes.
        </p></li><li><p><b>Replica. </b>
          Under the <code class="literal">NDB</code> storage engine,
          each table fragment has number of replicas stored on other
          data nodes in order to provide redundancy. Currently, there
          may be up four replicas per fragment.
        </p></li><li><p><b>Transporter. </b>
          A protocol providing data transfer between nodes. MySQL
          Cluster currently supports four different types of transporter
          connections:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>TCP/IP. </b>
              This is, of course, the familiar network protocol that
              underlies HTTP, FTP (and so on) on the Internet. TCP/IP
              can be used for both local and remote connections.
            </p></li><li><p><b>SCI. </b>
              <span class="bold"><strong>S</strong></span>calable
              <span class="bold"><strong>C</strong></span>oherent
              <span class="bold"><strong>I</strong></span>nterface is a high-speed
              protocol used in building multiprocessor systems and
              parallel-processing applications. Use of SCI with MySQL
              Cluster requires specialized hardware, as discussed in
              <a href="mysql-cluster.html#mysql-cluster-sci-sockets" title="17.9.1. Configuring MySQL Cluster to use SCI Sockets">Section 17.9.1, “Configuring MySQL Cluster to use SCI Sockets”</a>. For a basic
              introduction to SCI, see
              <a href="http://www.dolphinics.com/corporate/scitech.html" target="_top">this
              essay at dolphinics.com</a>.
            </p></li><li><p><b>SHM. </b>
              Unix-style <span class="bold"><strong>sh</strong></span>ared
              <span class="bold"><strong>m</strong></span>emory segments. Where
              supported, SHM is used automatically to connect nodes
              running on the same host. The
              <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/shmat.2.html" target="_top">Unix
              man page for <code class="literal">shmop(2)</code></a> is a good
              place to begin obtaining additional information about this
              topic.
            </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The cluster transporter is internal to the cluster.
          Applications using MySQL Cluster communicate with SQL nodes
          just as they do with any other version of MySQL Server (via
          TCP/IP, or through the use of Unix socket files or Windows
          named pipes). Queries can be sent and results retrieved using
          the standard MySQL client APIs.
        </p></div></li><li><p><b><code class="literal">NDB</code>. </b>
          This stands for <span class="bold"><strong>N</strong></span>etwork
          <span class="bold"><strong>D</strong></span>ata<span class="bold"><strong>b</strong></span>ase,
          and refers to the storage engine used to enable MySQL Cluster.
          The <code class="literal">NDB</code> storage engine supports
          all the usual MySQL data types and SQL statements, and is
          ACID-compliant. This engine also provides full support for
          transactions (commits and rollbacks).
        </p></li><li><p><b>Shared-nothing architecture. </b>
          The ideal architecture for a MySQL Cluster. In a true
          shared-nothing setup, each node runs on a separate host. The
          advantage such an arrangement is that there no single host or
          node can act as single point of failure or as a performance
          bottle neck for the system as a whole.
        </p></li><li><p><b>In-memory storage. </b>
          All data stored in each data node is kept in memory on the
          node's host computer. For each data node in the cluster, you
          must have available an amount of RAM equal to the size of the
          database times the number of replicas, divided by the number
          of data nodes. Thus, if the database takes up 1GB of memory,
          and you want to set up the cluster with four replicas and
          eight data nodes, a minimum of 500MB memory will be required
          per node. Note that this is in addition to any requirements
          for the operating system and any other applications that might
          be running on the host.
        </p><p>
        In MySQL 5.1 and MySQL Cluster NDB 6.x, it is also possible to
        create <em class="firstterm">Disk Data</em> tables where nonindexed
        columns are stored on disk, thus reducing the memory footprint
        required by the cluster. Note that indexes and indexed column
        data are still stored in RAM. See
        <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-disk-data.html" target="_top">MySQL Cluster Disk Data Tables</a>.
      </p></li><li><p><b>Table. </b>
          As is usual in the context of a relational database, the term
          “<span class="quote">table</span>” denotes a set of identically structured
          records. In MySQL Cluster, a database table is stored in a
          data node as a set of fragments, each of which is replicated
          on additional data nodes. The set of data nodes replicating
          the same fragment or set of fragments is referred to as a
          <span class="emphasis"><em>node group</em></span>.
        </p></li><li><p><b>Cluster programs. </b>
          These are command-line programs used in running, configuring,
          and administering MySQL Cluster. They include both server
          daemons:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
            <span><strong class="command">ndbd</strong></span>:
          </p><p>
            The data node daemon (runs a data node process)
          </p></li><li><p>
            <span><strong class="command">ndb_mgmd</strong></span>:
          </p><p>
            The management server daemon (runs a management server
            process)
          </p></li></ul></div><p>
        and client programs:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <span><strong class="command">ndb_mgm</strong></span>:
          </p><p>
            The management client (provides an interface for executing
            management commands)
          </p></li><li><p>
            <span><strong class="command">ndb_waiter</strong></span>:
          </p><p>
            Used to verify status of all nodes in a cluster
          </p></li><li><p>
            <span><strong class="command">ndb_restore</strong></span>:
          </p><p>
            Restores cluster data from backup
          </p></li></ul></div><p>
        For more about these programs and their uses, see
        <a href="mysql-cluster.html#mysql-cluster-programs" title="17.6. MySQL Cluster Programs">Section 17.6, “MySQL Cluster Programs”</a>.
      </p></li><li><p><b>Event log. </b>
          MySQL Cluster logs events by category (startup, shutdown,
          errors, checkpoints, and so on), priority, and severity. A
          complete listing of all reportable events may be found in
          <a href="mysql-cluster.html#mysql-cluster-event-reports" title="17.7.4. Event Reports Generated in MySQL Cluster">Section 17.7.4, “Event Reports Generated in MySQL Cluster”</a>. Event logs are
          of two types:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Cluster log. </b>
              Keeps a record of all desired reportable events for the
              cluster as a whole.
            </p></li><li><p><b>Node log. </b>
              A separate log which is also kept for each individual
              node.
            </p></li></ul></div><p>
        Under normal circumstances, it is necessary and sufficient to
        keep and examine only the cluster log. The node logs need be
        consulted only for application development and debugging
        purposes.
      </p></li><li><p><b>Angel process. </b>
          When a data node is started, <span><strong class="command">ndbd</strong></span> actually
          starts two processes. One of these is known as the
          “<span class="quote">angel</span>” process; its purpose is to check to make
          sure that the main <span><strong class="command">ndbd</strong></span> process continues
          to run, and to restart the main process if it should stop for
          any reason.
        </p></li><li><p><b>Watchdog thread. </b>
          Each <span><strong class="command">ndbd</strong></span> process has an internal
          <em class="firstterm">watchdog thread</em> which monitors the main
          worker thread, ensuring forward progress and a timely response
          to cluster protocols such as the cluster heartbeat. If the
          <span><strong class="command">ndbd</strong></span> process is not being woken up promptly
          by the operating system when its sleep time expires,
          <code class="literal">INFO</code> and <code class="literal">WARNING</code> events,
          which are identifiable because they contain
          “<span class="quote">Watchdog:...</span>”, are written to the cluster log.
          Such messages are usually a symptom of an overloaded system;
          you should see what else is running on the system, and whether
          the ndbd <span><strong class="command">process</strong></span> is being swapped out to
          disk. If <span><strong class="command">ndbd</strong></span> cannot wake up regularly then
          it cannot respond to heartbeat messages on time, and other
          nodes eventually consider it “<span class="quote">dead</span>” due to the
          missed heartbeats, causing it to be excluded from the cluster.
        </p></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="replication.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="stored-programs-views.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 16. Replication </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 18. Stored Programs and Views</td></tr></table></div></body></html>
