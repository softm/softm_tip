Attribute VB_Name = "cal_saju"
Option Explicit

Global BIRTHDAY As Date '출생일자
Global PALJA(1 To 8) As Integer '출생일자에 따른 팔자
Global SAJU(1 To 4) As Integer

Type t_Insa
    Name As String * 17 '성명
    Sex As Integer '성별
    Birth0 As Date '음력생일
    B0y As Integer '음력 년수
    B0m As Integer '음력 월수
    B0d As Integer '음력 일수
    Birth1 As Date '양력생일
    B1y As Integer '양력 년수
    B1m As Integer '양력 월수
    B1d As Integer '양력 일수
    DaeUn_Under_date As Date '절입시 이후까지 시간
    DaeUn_Over_date As Date '다음 절입시까지 시간
    DaeUnSu As Integer '대운수
    DangLyung As Integer '천간 중 1개 숫자(월지당령)
    JulGi As Integer '해당절기
    Old As Integer '나이
    i_Day2 As String  '대운수 소수점 영역
    Title As String '추가사항
End Type
Global INSA As t_Insa
Enum e_SajuStr
    Number ' 한자 1 ~ 12
    Gan ' 천간
    Ji ' 지지
    SipSung ' 10성
    Div '24절기
    Div1 '24절기(첫자)
    Div2 '24절기(두번째자)
    g_YukChin '육친 : 기문
    yukeui '육의
    PalGwae1 '팔괘(첫자)
    PalGwae2 '팔괘(두번째자)
    PalMun1 '팔문(첫자)
    PalMun2 '팔문(두번째자)
    TaeEul1 '태을(첫자)
    TaeEul2 '태을(두번째자)
    jikbu1 '직부(첫자)
    jikbu2 '직부(두번째자)
    chunbong1 '천봉(첫자)
    chunbong2 '천봉(두번째자)
    SamWon_name '삼원명
    EumYang_name '음양명
    Han_sex '건곤구분
    Ohaeng '오행표시
End Enum


Function p_cal_Yun_Gan(in_date As Date) As Integer
    Dim i_ret As Integer
    '1900년은 경자년임
    i_ret = (Year(in_date) - 1900 + 7) Mod 10
    If i_ret <= 0 Then i_ret = i_ret + 10
    p_cal_Yun_Gan = i_ret
    Exit Function
End Function

Function f_cal_Yun_Ji(in_date As Date) As Integer
    Dim i_ret As Integer
    '1900년은 경자년임
    i_ret = (Year(in_date) - 1900 + 1) Mod 12
    If i_ret <= 0 Then i_ret = i_ret + 12
    f_cal_Yun_Ji = i_ret
    Exit Function
End Function

Function f_cal_Il_Gan(in_date As Date) As Integer
    Dim i_ret As Integer
    Dim d_ret As Date
'------------------------------------
' 일주(日柱)구하기 공식
'------------------------------------
    '1901년 1월 1일은 기묘일임
    d_ret = DateSerial(Year(in_date), Month(in_date), Day(in_date)) - DateSerial(1901, 1, 1)
    i_ret = (d_ret + 6) Mod 10
    If i_ret <= 0 Then i_ret = 10 + i_ret
    f_cal_Il_Gan = i_ret
    Exit Function
End Function

Function f_cal_Il_Ji(in_date As Date) As Integer
    Dim i_ret As Integer
    Dim d_ret As Date
    '1901년 1월 1일은 기묘일임
    d_ret = DateSerial(Year(in_date), Month(in_date), Day(in_date)) - DateSerial(1901, 1, 1)
    i_ret = (d_ret + 4) Mod 12
    If i_ret <= 0 Then i_ret = 12 + i_ret
    f_cal_Il_Ji = i_ret
    Exit Function
End Function
'Function MyFunc(MyStr As String, Optional MyArg1 As _
    Integer = 5, Optional MyArg2 = "Dolly")

Sub p_Cal_Palja(in_date As Date, _
    Optional s_TimeLongitude As Single = 135, _
    Optional s_EarthLongitude As Single = 127.5, _
    Optional b_YajaSi As Boolean = False, _
    Optional b_Summer As Boolean = False, _
    Optional b_KTime As Boolean = False)  '경도 : longitude
'On Error GoTo exit_cal_palja
    Dim d_CDate As Date '127도 기준 보정일자
    Dim i_year As Integer
    Dim yun_ju As Integer
    Dim wol_cnt As Integer
    Dim BTime As Date
    Dim TimeCor As Integer '분 단위로 보정
    Dim s_TL, s_EL As Single
    
    s_TL = s_TimeLongitude
    s_EL = s_EarthLongitude
    
    If b_KTime = True Then
        If (in_date >= DateSerial(1954, 3, 21) And in_date <= DateSerial(1961, 8, 9)) Then
            s_TL = s_EL
        End If
    End If
    TimeCor = (s_EL - s_TL) * 4
    If b_Summer = True Then
        If (in_date >= DateSerial(1948, 5, 31) And in_date <= DateSerial(1948, 9, 12)) _
        Or (in_date >= DateSerial(1949, 5, 31) And in_date <= DateSerial(1949, 9, 23)) _
        Or (in_date >= DateSerial(1950, 5, 31) And in_date <= DateSerial(1950, 9, 23)) _
        Or (in_date >= DateSerial(1951, 5, 31) And in_date <= DateSerial(1951, 9, 8)) _
        Or (in_date >= DateSerial(1955, 5, 31) And in_date <= DateSerial(1955, 9, 21)) _
        Or (in_date >= DateSerial(1956, 5, 31) And in_date <= DateSerial(1956, 9, 29)) _
        Or (in_date >= DateSerial(1957, 5, 31) And in_date <= DateSerial(1957, 9, 21)) _
        Or (in_date >= DateSerial(1958, 5, 31) And in_date <= DateSerial(1958, 9, 20)) _
        Or (in_date >= DateSerial(1959, 5, 31) And in_date <= DateSerial(1959, 9, 19)) _
        Or (in_date >= DateSerial(1960, 5, 31) And in_date <= DateSerial(1960, 9, 17)) _
        Or (in_date >= DateSerial(1987, 5, 31) And in_date <= DateSerial(1987, 10, 10)) _
        Or (in_date >= DateSerial(1988, 5, 31) And in_date <= DateSerial(1988, 10, 8)) _
        Then
            TimeCor = TimeCor - 60
        End If
    End If '위치, 섬머타임, 한국시간사용 등에 따른 시간 보정
    d_CDate = DateSerial(Year(in_date), Month(in_date), Day(in_date)) _
            + TimeSerial(Hour(in_date), Minute(in_date) + TimeCor, Second(in_date))
            
    i_year = Year(d_CDate)
    If d_CDate < gDIV(i_year, 3) Then
        yun_ju = i_year - 1
    Else: yun_ju = i_year
    End If
    '1900년 경자년 기준
    PALJA(1) = (yun_ju - 1900 + 7) Mod 10
    If PALJA(1) <= 0 Then PALJA(1) = PALJA(1) + 10
    PALJA(2) = (yun_ju - 1900 + 1) Mod 12
    If PALJA(2) <= 0 Then PALJA(2) = PALJA(2) + 12
    ' 월주 구하기
    wol_cnt = 1
    Do While wol_cnt < 25   ' Inner loop.
        If gDIV(i_year, wol_cnt) > in_date Then Exit Do '입력값 기준이면 in_dat로 check, 계산값 기준이면 d_CDATE 로 check
                                                    
        wol_cnt = wol_cnt + 1
    Loop 'max값 : 25
    
    PALJA(4) = ((wol_cnt \ 2) + 1) Mod 12
    If PALJA(4) <= 0 Then PALJA(4) = 12 + PALJA(4)
    
    If PALJA(4) <> 1 And PALJA(4) <> 2 Then
        PALJA(3) = (((PALJA(1) Mod 5) * 2 + 8) + PALJA(4)) Mod 10
    Else
        PALJA(3) = (((PALJA(1) Mod 5) * 2) + PALJA(4)) Mod 10
    End If
    If PALJA(3) <= 0 Then PALJA(3) = 10 + PALJA(3)
    '일주:1901년 1월 1일 기준(기묘일)
    PALJA(5) = (DateSerial(Year(d_CDate), Month(d_CDate), Day(d_CDate)) _
                - DateSerial(1901, 1, 1) + 6) Mod 10
    If PALJA(5) <= 0 Then PALJA(5) = 10 + PALJA(5)
    PALJA(6) = (DateSerial(Year(d_CDate), Month(d_CDate), Day(d_CDate)) _
                - DateSerial(1901, 1, 1) + 4) Mod 12
    If PALJA(6) <= 0 Then PALJA(6) = 12 + PALJA(6)
    'option에 따라 일주와 시주 조정
    'Optional s_TimeLongitude = 135 :입력시간 기준경도
    'Optional s_EarthLongitude = 127.5 :현재 위치의 경도
    'Optional b_DayChange = true :시지에 따라 일주에 영향을 줄 것인지 반영
    'Optional b_YajaSi = true:야자시 반영여부
    'Optional b_Summer = False:썸머타임 사용기간 반영여부,
    'Optional b_KTime = False:Korean time 사용기간 반영여부)
    BTime = DateSerial(Year(d_CDate), Month(d_CDate), Day(d_CDate))
    Select Case d_CDate
        'Case BTime - TimeSerial(1, 0, 0) To BTime - TimeSerial(0, 0, 1): palja(8) = 0
        Case BTime + TimeSerial(0, 0, 0) To BTime + TimeSerial(0, 59, 59): PALJA(8) = 1
        Case BTime + TimeSerial(1, 0, 0) To BTime + TimeSerial(2, 59, 59): PALJA(8) = 2
        Case BTime + TimeSerial(3, 0, 0) To BTime + TimeSerial(4, 59, 59): PALJA(8) = 3
        Case BTime + TimeSerial(5, 0, 0) To BTime + TimeSerial(6, 59, 59): PALJA(8) = 4
        Case BTime + TimeSerial(7, 0, 0) To BTime + TimeSerial(8, 59, 59): PALJA(8) = 5
        Case BTime + TimeSerial(9, 0, 0) To BTime + TimeSerial(10, 59, 59): PALJA(8) = 6
        Case BTime + TimeSerial(11, 0, 0) To BTime + TimeSerial(12, 59, 59): PALJA(8) = 7
        Case BTime + TimeSerial(13, 0, 0) To BTime + TimeSerial(14, 59, 59): PALJA(8) = 8
        Case BTime + TimeSerial(15, 0, 0) To BTime + TimeSerial(16, 59, 59): PALJA(8) = 9
        Case BTime + TimeSerial(17, 0, 0) To BTime + TimeSerial(18, 59, 59): PALJA(8) = 10
        Case BTime + TimeSerial(19, 0, 0) To BTime + TimeSerial(20, 59, 59): PALJA(8) = 11
        Case BTime + TimeSerial(21, 0, 0) To BTime + TimeSerial(22, 59, 59): PALJA(8) = 12
        '야자시 사용하는 경우 일진변경 없음, 시간변경,
        '야자시 미사용인 경우 일진변경, 시간은 자시
        Case BTime + TimeSerial(23, 0, 0) To BTime + TimeSerial(23, 59, 59)
            If b_YajaSi = True Then '야자시 사용인 경우 일진변경 없음, 시간변경
                PALJA(8) = 13
            Else '야자시 미사용인 경우 일진변경 , 시간은 다음 일진 기준으로 사용
                PALJA(5) = (PALJA(5) + 1) Mod 10
                If PALJA(5) <= 0 Then PALJA(5) = PALJA(5) + 10
                PALJA(6) = (PALJA(6) + 1) Mod 12
                If PALJA(6) <= 0 Then PALJA(6) = PALJA(6) + 12
                PALJA(8) = 1
            End If
    End Select
    PALJA(7) = (((PALJA(5) Mod 5) * 2 + 8) + PALJA(8)) Mod 10
    If PALJA(7) <= 0 Then PALJA(7) = PALJA(7) + 10
    PALJA(8) = PALJA(8) Mod 12
    If PALJA(8) <= 0 Then PALJA(8) = PALJA(8) + 12
    SAJU(1) = f_Cal_GapJa60(PALJA(1), PALJA(2))
    SAJU(2) = f_Cal_GapJa60(PALJA(3), PALJA(4))
    SAJU(3) = f_Cal_GapJa60(PALJA(5), PALJA(6))
    SAJU(4) = f_Cal_GapJa60(PALJA(7), PALJA(8))
    BIRTHDAY = in_date
    Exit Sub
'exit_cal_palja:
End Sub

Function f_Cal_GapJa60(in_Gan As Integer, in_Ji As Integer)
    Dim cal_gapja60 As Integer
    Dim cal_ji As Integer
    If in_Gan < 0 Or in_Ji < 0 Then
        f_Cal_GapJa60 = -1
        Exit Function
    End If
    If in_Gan = 0 And in_Ji = 0 Then
        f_Cal_GapJa60 = 0
        Exit Function
    End If
    cal_ji = in_Ji
    If in_Gan >= cal_ji Then cal_ji = cal_ji + 10

    cal_gapja60 = ((10 - (cal_ji - in_Gan)) Mod 10) * 6 + in_Ji
    f_Cal_GapJa60 = cal_gapja60
    Exit Function
End Function

Public Function f_Cal_SipSung(in_ilgan As Integer, in_Tagan As Integer) As Integer
    Dim EumYang As Integer
    Dim Ohaeng As Integer
    
    If in_Tagan < in_ilgan Then in_Tagan = in_Tagan + 10

    If in_ilgan Mod 2 = 1 Then '양간일 경우
        f_Cal_SipSung = in_Tagan - in_ilgan + 1
    Else '음간일 경우
        Select Case (in_Tagan - in_ilgan)
            Case 0: f_Cal_SipSung = 1
            Case 1: f_Cal_SipSung = 4
            Case 2: f_Cal_SipSung = 3
            Case 3: f_Cal_SipSung = 6
            Case 4: f_Cal_SipSung = 5
            Case 5: f_Cal_SipSung = 8
            Case 6: f_Cal_SipSung = 7
            Case 7: f_Cal_SipSung = 10
            Case 8: f_Cal_SipSung = 9
            Case 9: f_Cal_SipSung = 2
        End Select
    End If
    Exit Function
End Function

Public Function fSS(in_N As Integer, in_T As e_SajuStr) As String 'print할 때 용이하기 위해
    fSS = f_SajuStr(in_N, in_T)
    Exit Function
End Function

Public Function f_SajuStr(in_strNum As Integer, in_strtype As e_SajuStr) As String
    Select Case in_strtype
        Case Gan
            Select Case in_strNum
                Case 1: f_SajuStr = "甲"
                Case 2: f_SajuStr = "乙"
                Case 3: f_SajuStr = "丙"
                Case 4: f_SajuStr = "丁"
                Case 5: f_SajuStr = "戊"
                Case 6: f_SajuStr = "己"
                Case 7: f_SajuStr = "庚"
                Case 8: f_SajuStr = "辛"
                Case 9: f_SajuStr = "壬"
                Case 10: f_SajuStr = "癸"
                Case Else: f_SajuStr = "??"
            End Select
        Case Ji
            Select Case in_strNum
                Case 1: f_SajuStr = "子"
                Case 2: f_SajuStr = "丑"
                Case 3: f_SajuStr = "寅"
                Case 4: f_SajuStr = "卯"
                Case 5: f_SajuStr = "辰"
                Case 6: f_SajuStr = "巳"
                Case 7: f_SajuStr = "午"
                Case 8: f_SajuStr = "未"
                Case 9: f_SajuStr = "申"
                Case 10: f_SajuStr = "酉"
                Case 11: f_SajuStr = "戌"
                Case 12: f_SajuStr = "亥"
                Case Else: f_SajuStr = "??"
            End Select
        Case Number
            Select Case in_strNum '한자 숫자를 표현할 경우
                Case 0: f_SajuStr = "00"
                Case 1: f_SajuStr = "一"
                Case 2: f_SajuStr = "二"
                Case 3: f_SajuStr = "三"
                Case 4: f_SajuStr = "四"
                Case 5: f_SajuStr = "五"
                Case 6: f_SajuStr = "六"
                Case 7: f_SajuStr = "七"
                Case 8: f_SajuStr = "八"
                Case 9: f_SajuStr = "九"
                Case 10: f_SajuStr = "十"
                Case 100: f_SajuStr = "百"
                Case Else: f_SajuStr = "??"
            End Select
        Case SipSung '사주 십성을 표시할 경우
            Select Case in_strNum
                Case 1: f_SajuStr = "比肩"
                Case 2: f_SajuStr = "劫財"
                Case 3: f_SajuStr = "食身"
                Case 4: f_SajuStr = "傷官"
                Case 5: f_SajuStr = "扁財"
                Case 6: f_SajuStr = "正財"
                Case 7: f_SajuStr = "扁官"
                Case 8: f_SajuStr = "正官"
                Case 9: f_SajuStr = "扁印"
                Case 10: f_SajuStr = "正印"
                Case Else: f_SajuStr = "??"
            End Select
        Case g_YukChin '기문 육친인 경우
            Select Case in_strNum
                Case 0, 1: f_SajuStr = "世"
                Case 2: f_SajuStr = "兄"
                Case 3, 4: f_SajuStr = "孫"
                Case 5, 6: f_SajuStr = "財"
                Case 7: f_SajuStr = "鬼"
                Case 8: f_SajuStr = "官"
                Case 9, 10: f_SajuStr = "父"
                Case Else: f_SajuStr = "??"
            End Select
        Case Div1 ' 절기인 경우
            Select Case in_strNum
                Case 1: f_SajuStr = "小"
                Case 2: f_SajuStr = "大"
                Case 3: f_SajuStr = "立"
                Case 4: f_SajuStr = "雨"
                Case 5: f_SajuStr = "驚"
                Case 6: f_SajuStr = "春"
                Case 7: f_SajuStr = "淸"
                Case 8: f_SajuStr = "穀"
                Case 9: f_SajuStr = "立"
                Case 10: f_SajuStr = "小"
                Case 11: f_SajuStr = "芒"
                Case 12: f_SajuStr = "夏"
                Case 13: f_SajuStr = "小"
                Case 14: f_SajuStr = "大"
                Case 15: f_SajuStr = "立"
                Case 16: f_SajuStr = "處"
                Case 17: f_SajuStr = "白"
                Case 18: f_SajuStr = "秋"
                Case 19: f_SajuStr = "寒"
                Case 20: f_SajuStr = "霜"
                Case 21: f_SajuStr = "立"
                Case 22: f_SajuStr = "小"
                Case 23: f_SajuStr = "大"
                Case 24: f_SajuStr = "冬"
                Case Else: f_SajuStr = "??"
            End Select
        Case Div2 ' 절기인 경우
            Select Case in_strNum
                Case 1: f_SajuStr = "寒"
                Case 2: f_SajuStr = "寒"
                Case 3: f_SajuStr = "春"
                Case 4: f_SajuStr = "水"
                Case 5: f_SajuStr = "蟄"
                Case 6: f_SajuStr = "分"
                Case 7: f_SajuStr = "明"
                Case 8: f_SajuStr = "雨"
                Case 9: f_SajuStr = "夏"
                Case 10: f_SajuStr = "滿"
                Case 11: f_SajuStr = "種"
                Case 12: f_SajuStr = "至"
                Case 13: f_SajuStr = "署"
                Case 14: f_SajuStr = "署"
                Case 15: f_SajuStr = "秋"
                Case 16: f_SajuStr = "署"
                Case 17: f_SajuStr = "露"
                Case 18: f_SajuStr = "分"
                Case 19: f_SajuStr = "露"
                Case 20: f_SajuStr = "降"
                Case 21: f_SajuStr = "冬"
                Case 22: f_SajuStr = "雪"
                Case 23: f_SajuStr = "雪"
                Case 24: f_SajuStr = "至"
                Case Else: f_SajuStr = "??"
            End Select
        Case Div ' 절기인 경우
            Select Case in_strNum
                Case 1: f_SajuStr = "小寒"
                Case 2: f_SajuStr = "大寒"
                Case 3: f_SajuStr = "立春"
                Case 4: f_SajuStr = "雨水"
                Case 5: f_SajuStr = "驚蟄"
                Case 6: f_SajuStr = "春分"
                Case 7: f_SajuStr = "淸明"
                Case 8: f_SajuStr = "穀雨"
                Case 9: f_SajuStr = "立夏"
                Case 10: f_SajuStr = "小滿"
                Case 11: f_SajuStr = "芒種"
                Case 12: f_SajuStr = "夏至"
                Case 13: f_SajuStr = "小署"
                Case 14: f_SajuStr = "大署"
                Case 15: f_SajuStr = "立秋"
                Case 16: f_SajuStr = "處署"
                Case 17: f_SajuStr = "白露"
                Case 18: f_SajuStr = "秋分"
                Case 19: f_SajuStr = "寒露"
                Case 20: f_SajuStr = "霜降"
                Case 21: f_SajuStr = "立冬"
                Case 22: f_SajuStr = "小雪"
                Case 23: f_SajuStr = "大雪"
                Case 24: f_SajuStr = "冬至"
                Case Else: f_SajuStr = "??"
            End Select
        Case yukeui
            Select Case in_strNum
                Case 1: f_SajuStr = "戊"
                Case 2: f_SajuStr = "己"
                Case 3: f_SajuStr = "庚"
                Case 4: f_SajuStr = "辛"
                Case 5: f_SajuStr = "壬"
                Case 6: f_SajuStr = "癸"
                Case 7: f_SajuStr = "丁"
                Case 8: f_SajuStr = "丙"
                Case 9: f_SajuStr = "乙"
                Case Else: f_SajuStr = "??"
            End Select
        Case PalGwae1
            'Select Case in_strNum
            '    Case 1: f_SajuStr = "生氣"
            '    Case 2: f_SajuStr = "天宜"
            '    Case 3: f_SajuStr = "絶體"
            '    Case 4: f_SajuStr = "遊魂"
            '    Case 5: f_SajuStr = "禍害"
            '    Case 6: f_SajuStr = "福德"
            '    Case 7: f_SajuStr = "絶命"
            '    Case 8: f_SajuStr = "歸魂"
            'End Select
            Select Case in_strNum
                Case 1: f_SajuStr = "生"
                Case 2: f_SajuStr = "天"
                Case 3: f_SajuStr = "絶"
                Case 4: f_SajuStr = "遊"
                Case 5: f_SajuStr = "禍"
                Case 6: f_SajuStr = "福"
                Case 7: f_SajuStr = "絶"
                Case 8: f_SajuStr = "歸"
                Case Else: f_SajuStr = "??"
            End Select
        Case PalGwae2
            Select Case in_strNum
                Case 1: f_SajuStr = "氣"
                Case 2: f_SajuStr = "宜"
                Case 3: f_SajuStr = "體"
                Case 4: f_SajuStr = "魂"
                Case 5: f_SajuStr = "害"
                Case 6: f_SajuStr = "德"
                Case 7: f_SajuStr = "命"
                Case 8: f_SajuStr = "魂"
                Case Else: f_SajuStr = "??"
            End Select
        Case PalMun1
            'Select Case in_strNum
            '    Case 1: f_SajuStr = "生門"
            '    Case 2: f_SajuStr = "傷門"
            '    Case 3: f_SajuStr = "杜門"
            '    Case 4: f_SajuStr = "景門"
            '    Case 5: f_SajuStr = "死門"
            '    Case 6: f_SajuStr = "驚門"
            '    Case 7: f_SajuStr = "開門"
            '    Case 8: f_SajuStr = "休門"
            'End Select
            Select Case in_strNum
                Case 1: f_SajuStr = "生"
                Case 2: f_SajuStr = "傷"
                Case 3: f_SajuStr = "杜"
                Case 4: f_SajuStr = "景"
                Case 5: f_SajuStr = "死"
                Case 6: f_SajuStr = "驚"
                Case 7: f_SajuStr = "開"
                Case 8: f_SajuStr = "休"
                Case Else: f_SajuStr = "??"
            End Select
        Case PalMun2
            f_SajuStr = "門"
        Case TaeEul1
            'Select Case in_strNum
            '    Case 1: f_SajuStr = "太乙"
            '    Case 2: f_SajuStr = "攝提"
            '    Case 3: f_SajuStr = "軒轅"
            '    Case 4: f_SajuStr = "招搖"
            '    Case 5: f_SajuStr = "天符"
            '    Case 6: f_SajuStr = "靑龍"
            '    Case 7: f_SajuStr = "咸池"
            '    Case 8: f_SajuStr = "太陰"
            '    Case 9: f_SajuStr = "天乙"
            'End Select
            Select Case in_strNum
                Case 1: f_SajuStr = "太"
                Case 2: f_SajuStr = "攝"
                Case 3: f_SajuStr = "軒"
                Case 4: f_SajuStr = "招"
                Case 5: f_SajuStr = "天"
                Case 6: f_SajuStr = "靑"
                Case 7: f_SajuStr = "咸"
                Case 8: f_SajuStr = "太"
                Case 9: f_SajuStr = "天"
                Case Else: f_SajuStr = "??"
            End Select
        Case TaeEul2
            Select Case in_strNum
                Case 1: f_SajuStr = "乙"
                Case 2: f_SajuStr = "提"
                Case 3: f_SajuStr = "轅"
                Case 4: f_SajuStr = "搖"
                Case 5: f_SajuStr = "符"
                Case 6: f_SajuStr = "龍"
                Case 7: f_SajuStr = "池"
                Case 8: f_SajuStr = "陰"
                Case 9: f_SajuStr = "乙"
                Case Else: f_SajuStr = "??"
            End Select
        Case jikbu1
'            Select Case in_strNum
'                Case 1, -1: f_SajuStr = "直符"
'                Case 2, -2: f_SajuStr = "騰蛇"
'                Case 3, -3: f_SajuStr = "太陰"
'                Case 4, -4: f_SajuStr = "六合"
'                Case 5: f_SajuStr = "句陳"
'                Case -5: f_SajuStr = "白虎"
'                Case 6: f_SajuStr = "朱雀"
'                Case -6: f_SajuStr = "玄武"
'                Case 7, -7: f_SajuStr = "九地"
'                Case 8, -8: f_SajuStr = "九天"
'                Case Else: f_SajuStr = "??"
'            End Select
            Select Case in_strNum
                Case 1, -1: f_SajuStr = "直"
                Case 2, -2: f_SajuStr = "騰"
                Case 3, -3: f_SajuStr = "太"
                Case 4, -4: f_SajuStr = "六"
                Case 5: f_SajuStr = "句"
                Case -5: f_SajuStr = "白"
                Case 6: f_SajuStr = "朱"
                Case -6: f_SajuStr = "玄"
                Case 7, -7: f_SajuStr = "九"
                Case 8, -8: f_SajuStr = "九"
                Case Else: f_SajuStr = "??"
            End Select
        Case jikbu2
            Select Case in_strNum
                Case 1, -1: f_SajuStr = "符"
                Case 2, -2: f_SajuStr = "蛇"
                Case 3, -3: f_SajuStr = "陰"
                Case 4, -4: f_SajuStr = "合"
                Case 5: f_SajuStr = "陳"
                Case -5: f_SajuStr = "虎"
                Case 6: f_SajuStr = "雀"
                Case -6: f_SajuStr = "武"
                Case 7, -7: f_SajuStr = "地"
                Case 8, -8: f_SajuStr = "天"
                Case Else: f_SajuStr = "??"
            End Select
        Case chunbong1: f_SajuStr = "天"
        Case chunbong2
            Select Case in_strNum
                Case 1: f_SajuStr = "蓬"
                Case 2: f_SajuStr = "任"
                Case 3: f_SajuStr = "沖"
                Case 4: f_SajuStr = "輔"
                Case 5: f_SajuStr = "英"
                Case 6: f_SajuStr = "芮"
                Case 7: f_SajuStr = "柱"
                Case 8: f_SajuStr = "心"
                Case Else: f_SajuStr = "??"
            End Select
        Case SamWon_name
            Select Case in_strNum
                Case 0: f_SajuStr = "上"
                Case 1: f_SajuStr = "中"
                Case 2: f_SajuStr = "下"
                Case Else: f_SajuStr = "??"
            End Select
        Case EumYang_name
            Select Case ((in_strNum) Mod 2)
                Case 1: f_SajuStr = "陽" '홀수인 경우 양
                Case 0: f_SajuStr = "陰" '짝수인 경우 음
                Case Else: f_SajuStr = "??"
            End Select
        Case Han_sex
            Select Case ((in_strNum) Mod 2)
                Case 1: f_SajuStr = "乾" '홀수인 경우 양
                Case 0: f_SajuStr = "坤" '짝수인 경우 음
                Case Else: f_SajuStr = "??"
            End Select
        Case Ohaeng
            Select Case in_strNum
                Case 1, 2: f_SajuStr = "木" '홀수인 경우 양
                Case 3, 4: f_SajuStr = "火" '짝수인 경우 음
                Case 5, 6: f_SajuStr = "土" '짝수인 경우 음
                Case 7, 8: f_SajuStr = "金" '짝수인 경우 음
                Case 9, 10: f_SajuStr = "水" '짝수인 경우 음
                Case Else: f_SajuStr = "??"
            End Select
        Case Else: f_SajuStr = "ER"
    End Select
    Exit Function
End Function



